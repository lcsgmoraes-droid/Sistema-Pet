{
  "version": "1.0.0",
  "owner": "Lucas",
  "language": "pt-BR",
  "profile": {
    "programming_level": "iniciante_total",
    "communication_style": "simples_direta_sem_jargao"
  },
  "project_priorities": [
    "evitar divergencia dev x producao",
    "fluxo unico e repetivel",
    "seguranca de dados",
    "git limpo e organizado"
  ],
  "mandatory_flow": {
    "step_1": "Executar FLUXO_UNICO.bat check antes de qualquer acao relevante",
    "step_2": "Trabalhar no DEV usando FLUXO_UNICO.bat dev-up",
    "step_3": "Antes de subir producao, executar FLUXO_UNICO.bat release-check",
    "step_3b": "Se houver alteracoes em frontend/src, executar npm run build dentro da pasta frontend ANTES do prod-up",
    "step_4": "Subir producao apenas com FLUXO_UNICO.bat prod-up",
    "step_5": "Conferir com FLUXO_UNICO.bat status"
  },
  "hard_rules": {
    "never_push_dev_data_to_production": true,
    "never_version_local_artifacts": true,
    "never_bypass_release_check": true,
    "never_apply_manual_hotfix_in_production_without_registering_in_git": true,
    "always_use_small_scoped_changes": true,
    "always_explain_in_plain_portuguese": true
  },
  "forbidden_git_artifacts": [
    "backups/**",
    "limpeza/**",
    "simplesvet/**",
    "tmp_*",
    ".tmp_*",
    "*.dump",
    "*.sql.gz",
    "*.tar",
    "*.tar.gz",
    "*.zip",
    "nginx/ssl/*.pem"
  ],
  "protected_files_never_delete": [
    "docker-compose.local-dev.yml",
    "docker-compose.prod.yml",
    ".env.example",
    ".env.development",
    ".env.local-prod",
    ".env.production-local",
    ".env.production.example",
    ".env.production.template",
    ".env.staging",
    ".env.staging.example",
    "frontend/.env.dev",
    "frontend/.env.example",
    "frontend/.env.piloto",
    "scripts/fluxo_unico.ps1",
    "scripts/validar_fluxo.ps1",
    ".github/copilot-instructions.md",
    ".github/assistant-rules.json",
    "docs/FLUXO_UNICO_DEV_PROD.md"
  ],
  "commit_safety_rules": {
    "never_use_git_add_A_blindly": true,
    "before_commit_always_check": [
      "git status --short para ver delecoes (linhas com D)",
      "se houver delecao de arquivo em protected_files_never_delete: RESTAURAR antes de commitar",
      "nunca deletar arquivos de infraestrutura (docker-compose, .env templates, scripts)"
    ]
  },
  "assistant_behavior": {
    "before_editing": [
      "explicar em 1-2 frases o que vai fazer",
      "priorizar menor mudanca possivel",
      "confirmar que segue fluxo unico"
    ],
    "after_editing": [
      "mostrar resultado em linguagem simples",
      "dizer proximo passo operacional",
      "se houver risco, explicitar risco e mitigacao"
    ],
    "when_blocked": [
      "explicar bloqueio sem termos tecnicos",
      "propor caminho alternativo pratico"
    ]
  },
  "release_gate": {
    "must_be_true": [
      "git sem arquivos proibidos rastreados",
      "sem multiplas heads de migration",
      "mudancas organizadas por escopo",
      "comandos do fluxo unico executados",
      "se frontend/src foi alterado: npm run build executado e dist atualizado no commit"
    ]
  },
  "producao_deploy_rules": {
    "frontend_changes": "npm run build + commit do dist + docker restart petshop-prod-nginx",
    "backend_changes": "OBRIGATORIO reconstruir imagem: docker compose -f docker-compose.prod.yml build backend && docker compose -f docker-compose.prod.yml up -d backend",
    "reason": "O codigo do backend fica DENTRO da imagem Docker (nao em volume montado). Um simples docker restart nao aplica mudancas de codigo. So o frontend usa volume (pasta dist). Sempre reconstruir imagem ao alterar qualquer arquivo em backend/.",
    "never_do": "docker restart petshop-prod-backend como unico comando apos mudancas no codigo backend"
  }
}
