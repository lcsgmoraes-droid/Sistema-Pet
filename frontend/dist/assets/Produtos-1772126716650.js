import{r as i,j as e,z as j,S as ze,R as X}from"./vendor-react-1772126716650.js";import{g as Ve,a as Be,b as Te,d as re,f as We,c as ae}from"./produtos-17721267166502.js";import{a as T}from"./index-1772126716650.js";function He({isOpen:r,onClose:l,onSuccess:n}){const[p,_]=i.useState(null),[L,E]=i.useState(!1),[d,M]=i.useState(null),[x,N]=i.useState("upload"),W=c=>{const h=c.target.files[0];h&&(h.name.endsWith(".xlsx")||h.name.endsWith(".xls")?(_(h),M(null)):(j.error("Arquivo deve ser Excel (.xlsx ou .xls)"),c.target.value=""))},H=async()=>{try{const c=localStorage.getItem("access_token")||localStorage.getItem("token"),h=await T.get("/produtos/template-importacao",{headers:{Authorization:`Bearer ${c}`},responseType:"blob"}),k=window.URL.createObjectURL(new Blob([h.data])),f=document.createElement("a");f.href=k,f.setAttribute("download",`template_produtos_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(f),f.click(),f.remove(),window.URL.revokeObjectURL(k),j.success("Template baixado com sucesso!")}catch(c){console.error("Erro ao baixar template:",c),j.error("Erro ao baixar template")}},R=async()=>{var c,h;if(!p){j.error("Selecione um arquivo para importar");return}E(!0),N("processando");try{const k=new FormData;k.append("file",p);const f=await T.post("/produtos/importar",k);M(f.data),N("resultado"),f.data.total_sucesso>0&&(j.success(`${f.data.total_sucesso} produtos processados com sucesso!`),n&&n()),f.data.total_erros>0&&j.error(`${f.data.total_erros} produtos com erro`)}catch(k){console.error("Erro ao importar:",k),j.error(((h=(c=k.response)==null?void 0:c.data)==null?void 0:h.detail)||"Erro ao importar produtos"),N("upload")}finally{E(!1)}},S=()=>{_(null),M(null),N("upload")},A=()=>{S(),l()};return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-blue-600 to-blue-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"ImportaÃ§Ã£o de Produtos em Lote"})]}),e.jsx("button",{onClick:A,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[x==="upload"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Como funciona"]}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 ml-7",children:[e.jsx("li",{children:"1. Baixe o template Excel clicando no botÃ£o abaixo"}),e.jsx("li",{children:"2. Preencha os dados dos produtos na planilha"}),e.jsx("li",{children:"3. Salve o arquivo e faÃ§a o upload aqui"}),e.jsx("li",{children:"4. Produtos novos serÃ£o criados, existentes serÃ£o atualizados (baseado no SKU)"})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:H,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Baixar Template Excel"]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecione a Planilha Preenchida"}),e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-12 h-12 mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Clique para selecionar"})," ou arraste o arquivo"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Apenas arquivos Excel (.xlsx, .xls)"}),p&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-blue-600",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"font-medium",children:p.name})]})]}),e.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:W})]})})]})]}),x==="processando"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mb-4"}),e.jsx("p",{className:"text-lg text-gray-700",children:"Processando planilha..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Isso pode levar alguns segundos"})]}),x==="resultado"&&d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:d.total_processado}),e.jsx("div",{className:"text-sm text-blue-800 mt-1",children:"Total Processado"})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:d.total_criados}),e.jsx("div",{className:"text-sm text-green-800 mt-1",children:"Criados"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:d.total_atualizados}),e.jsx("div",{className:"text-sm text-yellow-800 mt-1",children:"Atualizados"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:d.total_erros}),e.jsx("div",{className:"text-sm text-red-800 mt-1",children:"Erros"})]})]}),d.detalhes.criados.length>0&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-green-900 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Produtos Criados (",d.detalhes.criados.length,")"]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"text-sm space-y-1",children:d.detalhes.criados.map((c,h)=>e.jsxs("li",{className:"text-green-800",children:["Linha ",c.linha,": ",e.jsx("span",{className:"font-medium",children:c.sku})," - ",c.nome]},h))})})]}),d.detalhes.atualizados.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-yellow-900 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Produtos Atualizados (",d.detalhes.atualizados.length,")"]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"text-sm space-y-1",children:d.detalhes.atualizados.map((c,h)=>e.jsxs("li",{className:"text-yellow-800",children:["Linha ",c.linha,": ",e.jsx("span",{className:"font-medium",children:c.sku})," - ",c.nome]},h))})})]}),d.detalhes.erros.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Erros (",d.detalhes.erros.length,")"]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"text-sm space-y-2",children:d.detalhes.erros.map((c,h)=>e.jsxs("li",{className:"text-red-800",children:[e.jsxs("strong",{children:["Linha ",c.linha]})," (",c.sku,"): ",c.erro]},h))})})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3 bg-gray-50",children:[x==="upload"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:A,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:R,disabled:!p||L,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:L?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Importando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Importar Produtos"]})})]}),x==="resultado"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:S,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Importar Novamente"}),e.jsx("button",{onClick:A,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Concluir"})]})]})]})}):null}const B=[{key:"checkbox",label:"",visible:!0,renderHeader:r=>e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:r.produtos.length>0&&r.selecionados.length===r.produtos.length,onChange:r.handleSelecionarTodos,className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})}),renderCell:(r,l)=>e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:l.selecionados.includes(r.id),onChange:n=>l.handleSelecionar(r.id,n.nativeEvent),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500 cursor-pointer"})})},{key:"imagem",label:"Imagem",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Imagem"}),renderCell:(r,l)=>{const n=r.tipo_produto==="VARIACAO";return e.jsx("td",{className:`px-4 py-3 ${n?"pl-12":""}`,children:e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden border border-gray-200 flex-shrink-0",children:r.imagem_principal?e.jsx("img",{src:r.imagem_principal.startsWith("http")?r.imagem_principal:`${window.location.origin}${r.imagem_principal}`,alt:r.nome,className:"w-full h-full object-cover object-center",onError:p=>{console.error("Erro ao carregar imagem:",r.imagem_principal),p.target.style.display="none",p.target.parentElement.innerHTML='<svg class="w-6 h-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>'}}):e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})})}},{key:"descricao",label:"Descrição",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descrição"}),renderCell:(r,l)=>{const n=r.tipo_produto==="VARIACAO",p=r.tipo_produto==="PAI",_=r.tipo_produto==="KIT",L=(l.kitsExpandidos||[]).includes(r.id),E=(l.paisExpandidos||[]).includes(r.id);return e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex-1 ${n?"pl-6":""}`,children:[e.jsxs("div",{className:"flex items-center",children:[n&&e.jsx("svg",{className:"w-4 h-4 text-blue-400 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),p&&e.jsx("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),l.togglePaiExpandido(r.id)},className:"flex items-center text-blue-600 hover:text-blue-700 transition-colors mr-1",title:E?"Ocultar variações":"Ver variações",children:e.jsx("svg",{className:`w-4 h-4 transition-transform ${E?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),_&&e.jsx("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),l.toggleKitExpandido(r.id)},className:`flex items-center transition-colors mr-1 ${r.tipo_kit==="VIRTUAL"?"text-indigo-600 hover:text-indigo-700":"text-green-600 hover:text-green-700"}`,title:L?"Ocultar composição":"Ver composição",children:e.jsx("svg",{className:`w-4 h-4 transition-transform ${L?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[r.nome,p&&e.jsxs("span",{className:"ml-2 text-xs text-blue-600",children:["(Pai ",r.total_variacoes||0,")"]}),_&&r.tipo_kit==="VIRTUAL"&&e.jsx("span",{className:"ml-2 text-xs text-indigo-600",children:"(Kit • Virtual)"}),_&&r.tipo_kit==="FISICO"&&e.jsx("span",{className:"ml-2 text-xs text-green-600",children:"(Kit • Físico)"}),r.data_descontinuacao&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800",children:"⚠️ Descontinuado"})]})]}),r.descricao&&e.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs mt-1",children:r.descricao})]}),e.jsx("button",{onClick:d=>{d.stopPropagation(),l.copiarTexto(r.nome,"Nome")},className:"text-gray-400 hover:text-gray-600",title:"Copiar nome",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})})}},{key:"codigo",label:"Código",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),renderCell:(r,l)=>e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-900 font-mono",children:r.codigo||r.sku}),r.codigo_barras&&e.jsx("div",{className:"text-xs text-gray-500 font-mono",children:r.codigo_barras})]}),e.jsx("button",{onClick:n=>{n.stopPropagation(),l.copiarTexto(r.codigo||r.sku,"SKU")},className:"text-gray-400 hover:text-gray-600",title:"Copiar SKU",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]})})},{key:"unidade",label:"Unidade",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unidade"}),renderCell:r=>e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:"text-sm text-gray-700",children:r.unidade||"UN"})})},{key:"custo",label:"Custo",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Custo"}),renderCell:(r,l)=>e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("span",{className:"text-sm text-gray-900",children:ae(r.preco_custo)})})},{key:"preco_venda",label:"PV",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PV"}),renderCell:(r,l)=>e.jsx("td",{className:"px-4 py-3 text-right",children:l.editandoPreco===r.id?e.jsxs("div",{className:"flex items-center gap-1 justify-end",onClick:n=>n.stopPropagation(),children:[e.jsx("input",{type:"number",step:"0.01",value:l.novoPreco,onChange:n=>l.setNovoPreco(n.target.value),className:"w-24 px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",autoFocus:!0}),e.jsx("button",{onClick:()=>l.handleSalvarPreco(r.id),className:"text-green-600 hover:text-green-800",title:"Salvar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("button",{onClick:l.handleCancelarEdicaoPreco,className:"text-red-600 hover:text-red-800",title:"Cancelar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsx("span",{className:"text-sm font-semibold text-green-600",children:ae(r.preco_venda)}),e.jsx("button",{onClick:n=>{n.stopPropagation(),l.handleEditarPreco(r.id,r.preco_venda)},className:"text-blue-600 hover:text-blue-800",title:"Editar preço",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})]})})},{key:"validade",label:"Validade",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Validade"}),renderCell:(r,l)=>e.jsx("td",{className:"px-4 py-3 text-center text-sm",children:l.getValidadeMaisProxima(r)})},{key:"estoque",label:"Estoque",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estoque"}),renderCell:(r,l)=>{const n=r.tipo_produto==="KIT"&&r.tipo_kit==="VIRTUAL",p=n?r.estoque_virtual??0:r.estoque_atual||0;return e.jsx("td",{className:"px-4 py-3 text-center",children:r.controlar_estoque?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`text-sm ${l.getCorEstoque(r)}`,children:p}),n&&e.jsx("span",{className:"text-xs text-gray-400 mt-0.5",children:"estoque virtual"})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})})}},{key:"acoes",label:"Ações",visible:!0,renderHeader:()=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"}),renderCell:(r,l)=>e.jsx("td",{className:"px-4 py-3 text-center",onClick:n=>n.stopPropagation(),children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),console.log("Produto:",r.nome,"Controla estoque:",r.controlar_estoque,"Estoque atual:",r.estoque_atual),l.navigate(`/produtos/${r.id}/movimentacoes`)},className:`rounded hover:opacity-80 transition-opacity ${r.controlar_estoque===!0&&(r.estoque_atual||0)>0?"text-green-600 hover:text-green-800":r.controlar_estoque===!0&&(r.estoque_atual||0)===0?"text-red-600 hover:text-red-800":"text-gray-400 hover:text-gray-600"}`,title:"Ver movimentações de estoque",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),l.navigate(`/produtos/${r.id}/editar`)},className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Editar",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),l.handleExcluir(r.id)},className:"text-red-600 hover:text-red-800 transition-colors",title:"Excluir",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})}];function Ke(){const r=ze(),[l,n]=i.useState([]),[p,_]=i.useState([]),[L,E]=i.useState([]),[d,M]=i.useState(!0),[x,N]=i.useState([]),[W,H]=i.useState(null),[R,S]=i.useState(null),[A,c]=i.useState(""),[h,k]=i.useState([]),[f,oe]=i.useState([]),[U,Y]=i.useState(()=>{const s=localStorage.getItem("produtos_colunas_visiveis");return s?JSON.parse(s):null}),[le,$]=i.useState(!1),[F,J]=i.useState([]),[ne,D]=i.useState(!1),[v,O]=i.useState({marca_id:"",categoria_id:"",departamento_id:""}),[ie,de]=i.useState([]),[ce,G]=i.useState(!1),[g,xe]=i.useState({busca:"",categoria_id:"",marca_id:"",estoque_baixo:!1,em_promocao:!1}),[u,y]=i.useState(1),[w,Z]=i.useState(20),ee=i.useMemo(()=>{if(!l||l.length===0)return[];const s=[],t=l.filter(o=>o.tipo_produto==="PAI"),a=l.filter(o=>o.tipo_produto==="VARIACAO"),m=l.filter(o=>o.tipo_produto!=="PAI"&&o.tipo_produto!=="VARIACAO");return s.push(...m),t.forEach(o=>{if(s.push(o),f.includes(o.id)){const C=a.filter(V=>V.produto_pai_id===o.id);s.push(...C)}}),s},[l,f]),K=i.useMemo(()=>{let s=[...ee];if(g.busca.trim()){const t=g.busca.toLowerCase();s=s.filter(a=>a.nome&&a.nome.toLowerCase().includes(t)||a.codigo&&a.codigo.toLowerCase().includes(t))}return g.categoria_id&&(s=s.filter(t=>t.categoria_id==g.categoria_id)),g.marca_id&&(s=s.filter(t=>t.marca_id==g.marca_id)),g.estoque_baixo&&(s=s.filter(t=>{const a=t.tipo_produto==="KIT"&&t.tipo_kit==="VIRTUAL"?t.estoque_virtual??0:t.estoque_atual||0,m=t.estoque_minimo||0;return t.controlar_estoque&&a<=m})),g.em_promocao&&(s=s.filter(t=>t.promocao_ativa===!0)),s},[ee,g]),{produtosPaginados:ue,totalPaginas:b,totalItens:q}=i.useMemo(()=>{const s=Math.ceil(K.length/w),t=(u-1)*w,a=t+w;return{produtosPaginados:K.slice(t,a),totalPaginas:s,totalItens:K.length}},[K,u,w]),P=ue;i.useEffect(()=>{y(1)},[g]),i.useEffect(()=>{I(),me(),he(),ge()},[]);const I=async()=>{try{M(!0);const s={};Object.keys(g).forEach(m=>{const o=g[m];o!==""&&o!==null&&o!==void 0&&(s[m]=o)});const t=await Ve(s);let a;if(Array.isArray(t.data))a=t.data;else if(t.data.itens)a=t.data.itens;else if(t.data.produtos)a=t.data.produtos;else if(t.data.data)a=t.data.data;else{const m=Object.keys(t.data).filter(o=>Array.isArray(t.data[o]));m.length>0?a=t.data[m[0]]:a=[]}n(a)}catch(s){console.error("Erro ao carregar produtos:",s),alert("Erro ao carregar produtos")}finally{M(!1)}},me=async()=>{try{const s=await Be();_(s.data)}catch(s){console.error("Erro ao carregar categorias:",s)}},he=async()=>{try{const s=await Te();E(s.data)}catch(s){console.error("Erro ao carregar marcas:",s)}},ge=async()=>{try{const s=await T.get("/produtos/departamentos");de(s.data)}catch(s){console.error("Erro ao carregar departamentos:",s)}},z=(s,t)=>{xe(a=>({...a,[s]:t}))},pe=(s,t)=>{if(!s){console.error("Erro: ID do produto é undefined ou null");return}if(t!=null&&t.shiftKey&&W!==null){const a=P.findIndex(o=>o.id===W),m=P.findIndex(o=>o.id===s);if(a!==-1&&m!==-1){const o=Math.min(a,m),C=Math.max(a,m),V=P.slice(o,C+1).map(Q=>Q.id);N(Q=>{const te=new Set(Q);return V.forEach(Ie=>te.add(Ie)),Array.from(te)}),H(s);return}}N(a=>a.includes(s)?a.filter(m=>m!==s):[...a,s]),H(s)},be=()=>{x.length===P.length?N([]):N(P.map(s=>s.id))},je=async s=>{if(confirm("Deseja realmente excluir este produto?"))try{await re(s),alert("Produto excluído com sucesso!"),I()}catch(t){console.error("Erro ao excluir produto:",t),alert("Erro ao excluir produto")}},fe=async()=>{if(confirm(`Deseja realmente excluir ${x.length} produtos?`))try{await Promise.all(x.map(s=>re(s))),alert("Produtos excluídos com sucesso!"),N([]),I()}catch(s){console.error("Erro ao excluir produtos:",s),alert("Erro ao excluir produtos")}},ve=(s,t)=>{navigator.clipboard.writeText(s),j.success(`${t} copiado!`)},ye=(s,t)=>{S(s),c(t.toString())},Ne=async s=>{try{await T.patch(`/produtos/${s}?preco_venda=${A}`,{}),j.success("Preço atualizado!"),S(null),I()}catch(t){console.error("Erro ao atualizar preço:",t),j.error("Erro ao atualizar preço")}},ke=()=>{S(null)},we=()=>{if(x.length===0){j.error("Selecione pelo menos um produto");return}O({marca_id:"",categoria_id:"",departamento_id:""}),D(!0)},Ce=async()=>{try{if(Object.values(v).filter(a=>a!=="").length===0){j.error("Preencha pelo menos um campo para atualizar");return}const t={};v.marca_id&&(t.marca_id=parseInt(v.marca_id)),v.categoria_id&&(t.categoria_id=parseInt(v.categoria_id)),v.departamento_id&&(t.departamento_id=parseInt(v.departamento_id)),await T.patch("/produtos/atualizar-lote",{produto_ids:x,...t}),j.success(`${x.length} produto(s) atualizado(s) com sucesso!`),D(!1),N([]),I()}catch(s){console.error("Erro ao atualizar produtos:",s),j.error("Erro ao atualizar produtos")}},_e=s=>{if(!s.controlar_estoque)return"text-gray-500";const t=s.tipo_produto==="KIT"&&s.tipo_kit==="VIRTUAL"?s.estoque_virtual??0:s.estoque_atual||0,a=s.estoque_minimo||0;return t<=0?"text-red-600 font-semibold":t<=a?"text-yellow-600 font-medium":"text-gray-700"},Le=s=>{if(!s.lotes||s.lotes.length===0)return"-";const t=s.lotes.filter(C=>C.data_validade).sort((C,V)=>new Date(C.data_validade)-new Date(V.data_validade));if(t.length===0)return"-";const a=t[0].data_validade,m=Math.floor((new Date(a)-new Date)/(1e3*60*60*24));let o="text-gray-700";return m<0?o="text-red-600 font-bold":m<=30?o="text-orange-600 font-semibold":m<=90&&(o="text-yellow-600"),e.jsx("span",{className:o,children:We(a)})},Pe=s=>{k(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},Ee=s=>{oe(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},Me=()=>{const s=U||B.map(t=>t.key);J(s),$(!0)},Se=s=>{J(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},Ae=()=>{localStorage.setItem("produtos_colunas_visiveis",JSON.stringify(F)),Y(F),$(!1),j.success("Preferências de colunas salvas!")},qe=()=>{localStorage.removeItem("produtos_colunas_visiveis"),Y(null),J(B.map(s=>s.key)),j.success("Colunas restauradas para o padrão!")},se=s=>U?U.includes(s.key):!0;return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Produtos"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie seu estoque de produtos"})]}),e.jsxs("div",{className:"flex gap-2",children:[x.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:we,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:["✏️ Editar em Lote (",x.length,")"]}),e.jsxs("button",{onClick:fe,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:["Excluir Selecionados (",x.length,")"]})]}),e.jsxs("button",{onClick:()=>G(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Importar Excel"]}),e.jsxs("button",{onClick:Me,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors font-medium flex items-center gap-2",title:"Configurar colunas visíveis",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Colunas"]}),e.jsx("button",{onClick:()=>r("/produtos/novo"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"+ Novo Produto"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{type:"text",placeholder:"Buscar por código, nome ou código de barras...",value:g.busca,onChange:s=>z("busca",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{children:e.jsxs("select",{value:g.categoria_id,onChange:s=>z("categoria_id",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as Categorias"}),p.map(s=>e.jsxs("option",{value:s.id,children:[s.categoria_pai_id?"  └─ ":"",s.nome]},s.id))]})}),e.jsx("div",{children:e.jsxs("select",{value:g.marca_id,onChange:s=>z("marca_id",s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as Marcas"}),L.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.estoque_baixo,onChange:s=>z("estoque_baixo",s.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Estoque Baixo"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.em_promocao,onChange:s=>z("em_promocao",s.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Em Promoção"})]})]})]})}),!d&&q>0&&e.jsxs("div",{className:"px-4 py-3 bg-gray-50 border border-gray-200 rounded-t-lg flex items-center justify-between mt-6 mb-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Mostrando ",(u-1)*w+1," a ",Math.min(u*w,q)," de ",q," produtos"]}),e.jsxs("select",{value:w,onChange:s=>{Z(Number(s.target.value)),y(1)},className:"px-3 py-1 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:10,children:"10 por página"}),e.jsx("option",{value:20,children:"20 por página"}),e.jsx("option",{value:30,children:"30 por página"}),e.jsx("option",{value:50,children:"50 por página"}),e.jsx("option",{value:100,children:"100 por página"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(1),disabled:u===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Primeira"}),e.jsx("button",{onClick:()=>y(s=>Math.max(s-1,1)),disabled:u===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(b,5)},(s,t)=>{let a;return b<=5||u<=3?a=t+1:u>=b-2?a=b-4+t:a=u-2+t,e.jsx("button",{onClick:()=>y(a),className:`px-3 py-1 text-sm font-medium rounded-lg transition-colors ${u===a?"bg-blue-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:a},a)})}),e.jsx("button",{onClick:()=>y(s=>Math.min(s+1,b)),disabled:u===b,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Próxima"}),e.jsx("button",{onClick:()=>y(b),disabled:u===b,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Última"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:B.filter(se).map(s=>e.jsx(X.Fragment,{children:s.renderHeader({produtos:P,selecionados:x,handleSelecionarTodos:be})},s.key))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-4 py-8 text-center text-gray-500",children:"Carregando produtos..."})}):P.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-4 py-8 text-center text-gray-500",children:"Nenhum produto encontrado"})}):P.map((s,t)=>{if(!s||!s.id)return console.error(`Produto inválido no índice ${t}:`,s),null;const a=s.tipo_produto==="KIT",m=h.includes(s.id);return e.jsxs(X.Fragment,{children:[e.jsx("tr",{className:`hover:bg-gray-50 transition-colors cursor-pointer ${s.tipo_produto==="VARIACAO"?"bg-blue-50/30":""} ${a?"bg-amber-50/30":""}`,onClick:o=>{o.target.closest("button, input, a, svg")||r(`/produtos/${s.id}/editar`)},children:B.filter(se).map(o=>e.jsx(X.Fragment,{children:o.renderCell(s,{selecionados:x,handleSelecionar:pe,kitsExpandidos:h,toggleKitExpandido:Pe,paisExpandidos:f,togglePaiExpandido:Ee,copiarTexto:ve,editandoPreco:R,novoPreco:A,setNovoPreco:c,handleSalvarPreco:Ne,handleCancelarEdicaoPreco:ke,handleEditarPreco:ye,getValidadeMaisProxima:Le,getCorEstoque:_e,navigate:r,handleExcluir:je})},o.key))}),a&&m&&s.composicao_kit&&s.composicao_kit.length>0&&e.jsx("tr",{className:"bg-amber-50/50 border-l-4 border-amber-400",children:e.jsx("td",{colSpan:"10",className:"px-4 py-3",children:e.jsxs("div",{className:"ml-12",children:[e.jsxs("div",{className:"text-xs font-semibold text-amber-800 mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"COMPOSIÇÃO DO KIT:"]}),e.jsx("div",{className:"grid gap-1",children:s.composicao_kit.map((o,C)=>e.jsxs("div",{className:"flex items-center gap-3 text-xs bg-white rounded px-3 py-2 border border-amber-200",children:[e.jsxs("span",{className:"font-mono font-semibold text-amber-700 min-w-[40px]",children:[o.quantidade,"x"]}),e.jsx("span",{className:"flex-1 text-gray-700",children:o.produto_nome||o.nome||`Produto #${o.produto_id||o.produto_componente_id}`}),o.produto_estoque!==void 0&&e.jsxs("span",{className:"text-gray-500",children:["Estoque: ",e.jsx("span",{className:o.produto_estoque>0?"text-green-600 font-semibold":"text-red-600 font-semibold",children:o.produto_estoque})]})]},C))})]})})},`kit-${s.id}`)]},s.id)})})]})}),!d&&q>0&&e.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Mostrando ",(u-1)*w+1," a ",Math.min(u*w,q)," de ",q," produtos"]}),e.jsxs("select",{value:w,onChange:s=>{Z(Number(s.target.value)),y(1)},className:"px-3 py-1 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:10,children:"10 por página"}),e.jsx("option",{value:20,children:"20 por página"}),e.jsx("option",{value:30,children:"30 por página"}),e.jsx("option",{value:50,children:"50 por página"}),e.jsx("option",{value:100,children:"100 por página"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(1),disabled:u===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Primeira"}),e.jsx("button",{onClick:()=>y(s=>Math.max(s-1,1)),disabled:u===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(b,5)},(s,t)=>{let a;return b<=5||u<=3?a=t+1:u>=b-2?a=b-4+t:a=u-2+t,e.jsx("button",{onClick:()=>y(a),className:`px-3 py-1 text-sm font-medium rounded-lg transition-colors ${u===a?"bg-blue-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:a},a)})}),e.jsx("button",{onClick:()=>y(s=>Math.min(s+1,b)),disabled:u===b,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Próxima"}),e.jsx("button",{onClick:()=>y(b),disabled:u===b,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Última"})]})]}),!d&&x.length>0&&e.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200",children:e.jsx("div",{className:"flex justify-between items-center text-sm text-gray-600",children:e.jsxs("span",{children:[x.length," produto",x.length>1?"s":""," selecionado",x.length>1?"s":""]})})})]}),ne&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Editar em Lote"}),e.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Atualizar ",e.jsx("strong",{children:x.length})," produto(s) selecionado(s)"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marca"}),e.jsxs("select",{value:v.marca_id,onChange:s=>O({...v,marca_id:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Não alterar"}),L.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),e.jsxs("select",{value:v.categoria_id,onChange:s=>O({...v,categoria_id:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Não alterar"}),p.map(s=>e.jsxs("option",{value:s.id,children:[s.categoria_pai_id?"  └─ ":"",s.nome]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),e.jsxs("select",{value:v.departamento_id,onChange:s=>O({...v,departamento_id:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Não alterar"}),ie.map(s=>e.jsx("option",{value:s.id,children:s.nome},s.id))]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:Ce,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Salvar Alterações"})]})]})}),le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Configurar Colunas"}),e.jsx("button",{onClick:()=>$(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"px-6 py-4 max-h-96 overflow-y-auto",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Selecione quais colunas deseja visualizar na tabela:"}),e.jsx("div",{className:"space-y-2",children:B.map(s=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:F.includes(s.key),onChange:()=>Se(s.key),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.label||s.key})]},s.key))})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between gap-3",children:[e.jsx("button",{onClick:qe,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Restaurar Padrão"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>$(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:Ae,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:"Salvar"})]})]})]})}),e.jsx(He,{isOpen:ce,onClose:()=>G(!1),onSuccess:()=>{I(),G(!1)}})]})}export{Ke as default};
