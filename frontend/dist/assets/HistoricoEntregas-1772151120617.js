import{r as t,j as e}from"./vendor-react-1772151120617.js";import{a as p}from"./index-1772151120617.js";function v(){const[l,x]=t.useState([]),[f,o]=t.useState(!0),[r,m]=t.useState(null);t.useEffect(()=>{d()},[]);async function d(){try{o(!0);const s=await p.get("/rotas-entrega/?status=concluida");x(s.data)}catch(s){console.error("Erro ao carregar histÃ³rico:",s),alert("Erro ao carregar histÃ³rico de entregas")}finally{o(!1)}}function h(s){m(r===s?null:s)}return f?e.jsxs("div",{className:"page",children:[e.jsx("h1",{children:"ğŸ“œ HistÃ³rico de Entregas"}),e.jsx("p",{children:"Carregando histÃ³rico..."})]}):e.jsxs("div",{className:"page",children:[e.jsx("h1",{children:"ğŸ“œ HistÃ³rico de Entregas"}),e.jsx("p",{style:{color:"#666",marginBottom:20},children:"Rotas finalizadas e conferidas"}),e.jsx("div",{style:{marginBottom:20,display:"flex",gap:10,alignItems:"center"},children:e.jsx("button",{onClick:d,className:"btn-secondary",style:{marginLeft:"auto"},children:"ğŸ”„ Atualizar"})}),!Array.isArray(l)||l.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"Nenhuma rota finalizada encontrada"})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:15},children:l.map(s=>{var a,c;return e.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:8,padding:15,backgroundColor:"#fff"},children:[e.jsx("div",{style:{cursor:"pointer"},onClick:()=>h(s.id),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("h3",{style:{margin:0,marginBottom:10},children:["ğŸšš ",s.numero||`Rota #${s.id}`,r===s.id?" ğŸ”½":" â–¶ï¸"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,color:"#555",fontSize:14},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Entregador:"})," ",((a=s.entregador)==null?void 0:a.nome)||"NÃ£o informado"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Paradas:"})," ",((c=s.paradas)==null?void 0:c.length)||0," entrega(s)"]}),s.distancia_prevista&&e.jsxs("div",{children:[e.jsx("strong",{children:"ğŸ“ Previsto:"})," ",parseFloat(s.distancia_prevista).toFixed(1)," km"]}),s.km_inicial&&e.jsxs("div",{children:[e.jsx("strong",{children:"ğŸ KM Inicial:"})," ",parseFloat(s.km_inicial).toFixed(1)]}),s.km_final&&e.jsxs("div",{children:[e.jsx("strong",{children:"ğŸ KM Final:"})," ",parseFloat(s.km_final).toFixed(1)]}),s.km_inicial&&s.km_final&&e.jsxs("div",{style:{color:"#007BFF",fontWeight:"600"},children:[e.jsx("strong",{children:"ğŸ“ Total:"})," ",(parseFloat(s.km_final)-parseFloat(s.km_inicial)).toFixed(1)," km",s.distancia_prevista&&(()=>{const i=parseFloat(s.km_final)-parseFloat(s.km_inicial),g=parseFloat(s.distancia_prevista),n=i-g,u=(n/g*100).toFixed(1);return e.jsxs("div",{style:{fontSize:12,color:n>0?"#DC3545":"#28A745",marginTop:2},children:[n>0?"â†‘":"â†“"," ",Math.abs(n).toFixed(1)," km (",n>0?"+":"",u,"%)"]})})()]}),s.distancia_real&&!(s.km_inicial&&s.km_final)&&e.jsxs("div",{children:[e.jsx("strong",{children:"DistÃ¢ncia:"})," ",parseFloat(s.distancia_real).toFixed(1)," km"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ConcluÃ­da em:"})," ",new Date(s.data_conclusao).toLocaleString("pt-BR")]}),s.custo_real&&e.jsxs("div",{children:[e.jsx("strong",{children:"Custo:"})," R$ ",parseFloat(s.custo_real).toFixed(2)]})]}),s.observacoes&&e.jsxs("div",{style:{marginTop:10,padding:10,backgroundColor:"#f8f9fa",borderRadius:5,fontSize:14,color:"#666"},children:[e.jsx("strong",{children:"ObservaÃ§Ãµes:"})," ",s.observacoes]})]}),e.jsx("div",{style:{padding:"5px 15px",borderRadius:20,backgroundColor:"#28A745",color:"#fff",fontWeight:"bold",fontSize:14,whiteSpace:"nowrap"},children:"âœ… ConcluÃ­da"})]})}),r===s.id&&s.paradas&&s.paradas.length>0&&e.jsxs("div",{style:{marginTop:20,borderTop:"2px solid #eee",paddingTop:15},children:[e.jsx("h4",{style:{marginBottom:15},children:"ğŸ“ Entregas da Rota"}),s.paradas.map(i=>e.jsx("div",{style:{padding:12,marginBottom:10,border:"1px solid #ddd",borderRadius:6,backgroundColor:i.status==="entregue"?"#f0fff4":"#fafafa"},children:e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:5},children:[e.jsxs("span",{style:{fontWeight:"bold",marginRight:10,fontSize:18,color:"#007BFF"},children:[i.ordem,"Âº"]}),e.jsxs("span",{style:{color:"#666",fontSize:14},children:["Venda #",i.venda_id]}),e.jsx("span",{style:{marginLeft:10,padding:"2px 8px",borderRadius:12,fontSize:12,backgroundColor:i.status==="entregue"?"#d4edda":"#e2e3e5",color:i.status==="entregue"?"#155724":"#383d41"},children:i.status==="entregue"?"âœ“ Entregue":i.status})]}),e.jsxs("div",{style:{fontSize:13,color:"#333",lineHeight:1.6},children:[i.cliente_nome&&e.jsxs("div",{style:{marginBottom:4},children:[e.jsxs("strong",{style:{color:"#1565C0"},children:["ğŸ‘¤ ",i.cliente_nome]}),i.cliente_telefone&&e.jsxs("span",{style:{marginLeft:12,color:"#555"},children:["ğŸ“ ",i.cliente_telefone]}),i.cliente_celular&&e.jsxs("span",{style:{marginLeft:12,color:"#555"},children:["ğŸ“± ",i.cliente_celular]})]}),e.jsxs("div",{style:{color:"#555"},children:["ğŸ“ ",i.endereco,i.distancia_acumulada&&e.jsxs("span",{style:{marginLeft:12,color:"#777"},children:["â€¢ Dist: ",i.distancia_acumulada," km"]}),i.km_entrega&&e.jsxs("span",{style:{marginLeft:12,color:"#777"},children:["â€¢ KM: ",i.km_entrega]})]})]}),i.data_entrega&&e.jsxs("div",{style:{color:"#28a745",fontSize:12,marginTop:3},children:["âœ“ Entregue em: ",new Date(i.data_entrega).toLocaleString("pt-BR")]}),i.observacoes&&e.jsxs("div",{style:{marginTop:6,padding:6,backgroundColor:"#fff3cd",borderRadius:4,fontSize:12,color:"#856404",border:"1px solid #ffc107"},children:["ğŸ“‹ ",i.observacoes]})]})})},i.id))]})]},s.id)})})]})}export{v as default};
