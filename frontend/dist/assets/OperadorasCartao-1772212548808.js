import{r as l,aP as o,j as e,aj as I,b1 as $,be as D,az as T,ax as M,X as z,aA as L,aM as q,aL as R,a$ as V,aJ as B}from"./vendor-react-1772212548808.js";import{a as p}from"./index-1772212548808.js";const F=["üí≥","üè¶","üí∞","üíµ","üí∏","üèß","üíº","üéØ","‚ö°","üîí","‚ú®","üåü","üìä","üíé","üéÅ","üîë","‚≠ê","üöÄ"];function G(){const[u,C]=l.useState([]),[O,h]=l.useState(!0),[E,d]=l.useState(!1),[m,f]=l.useState(null),[j,y]=l.useState(""),[g,v]=l.useState(!1),[s,r]=l.useState({nome:"",codigo:"",max_parcelas:12,padrao:!1,ativo:!0,api_enabled:!1,api_endpoint:"",api_token_encrypted:"",cor:"#00A868",icone:"üí≥"});l.useEffect(()=>{b()},[]);const b=async()=>{try{h(!0);const a=await p.get("/operadoras-cartao");C(a.data)}catch(a){console.error("Erro ao carregar operadoras:",a),o.error("Erro ao carregar operadoras de cart√£o")}finally{h(!1)}},N=(a=null)=>{a?(r({nome:a.nome,codigo:a.codigo||"",max_parcelas:a.max_parcelas,padrao:a.padrao,ativo:a.ativo,api_enabled:a.api_enabled,api_endpoint:a.api_endpoint||"",api_token_encrypted:a.api_token_encrypted||"",cor:a.cor||"#00A868",icone:a.icone||"üí≥"}),f(a)):(r({nome:"",codigo:"",max_parcelas:12,padrao:!1,ativo:!0,api_enabled:!1,api_endpoint:"",api_token_encrypted:"",cor:"#00A868",icone:"üí≥"}),f(null)),d(!0),y(""),v(!1)},A=async a=>{var t,n,c,x,w,_;if(a.preventDefault(),!s.nome.trim()){o.error("Nome da operadora √© obrigat√≥rio");return}if(s.max_parcelas<1||s.max_parcelas>24){o.error("Parcelas devem estar entre 1 e 24");return}try{const i={...s,nome:s.nome.trim(),codigo:((n=(t=s.codigo)==null?void 0:t.trim())==null?void 0:n.toUpperCase())||null,api_endpoint:((c=s.api_endpoint)==null?void 0:c.trim())||null,api_token_encrypted:((x=s.api_token_encrypted)==null?void 0:x.trim())||null};m?(await p.put(`/operadoras-cartao/${m.id}`,i),o.success("Operadora atualizada com sucesso!")):(await p.post("/operadoras-cartao",i),o.success("Operadora criada com sucesso!")),d(!1),b()}catch(i){console.error("Erro ao salvar:",i);const k=((_=(w=i.response)==null?void 0:w.data)==null?void 0:_.detail)||"Erro ao salvar operadora";o.error(k),y(k)}},P=async a=>{var t,n;if(window.confirm("Deseja realmente excluir esta operadora? Ela ser√° desativada se houver vendas vinculadas."))try{await p.delete(`/operadoras-cartao/${a}`),o.success("Operadora removida com sucesso!"),b()}catch(c){console.error("Erro ao excluir:",c);const x=((n=(t=c.response)==null?void 0:t.data)==null?void 0:n.detail)||"Erro ao excluir operadora";o.error(x)}},S=()=>{const a=u.find(t=>t.padrao&&t.ativo);return a?e.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(B,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-emerald-900",children:"Operadora Padr√£o"}),e.jsxs("p",{className:"text-sm text-emerald-700",children:[e.jsx("span",{className:"font-medium",children:a.nome})," ser√° pr√©-selecionada no PDV"]})]})]})}):null};return O?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Operadoras de Cart√£o"}),e.jsx("p",{className:"text-gray-600",children:"Configure as operadoras de cart√£o dispon√≠veis (Stone, Cielo, Rede, Getnet, etc)"})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(I,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-amber-900 mb-1",children:"Importante"}),e.jsxs("ul",{className:"text-sm text-amber-700 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Pelo menos uma operadora deve estar marcada como padr√£o e ativa"}),e.jsx("li",{children:"‚Ä¢ O PDV usar√° a operadora padr√£o automaticamente para vendas com cart√£o"}),e.jsx("li",{children:"‚Ä¢ Operadoras com vendas vinculadas n√£o podem ser exclu√≠das (apenas desativadas)"})]})]})]})}),S(),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>N(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"Nova Operadora"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(a=>{const t=a.icone&&!a.icone.startsWith("Fi")&&!a.icone.startsWith("Bi")?a.icone:"üí≥";return e.jsxs("div",{className:`border rounded-lg p-4 hover:shadow-md transition-shadow ${a.ativo?"bg-white border-gray-200":"bg-gray-50 border-gray-300"} ${a.padrao?"ring-2 ring-emerald-500":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-2xl",style:{backgroundColor:`${a.cor}20`},children:t}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[a.nome,a.padrao&&e.jsx("span",{className:"text-xs bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full",children:"Padr√£o"})]}),a.codigo&&e.jsx("p",{className:"text-xs text-gray-500 font-mono",children:a.codigo})]})]}),e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${a.ativo?"bg-green-100 text-green-700":"bg-gray-200 text-gray-600"}`,children:a.ativo?"Ativo":"Inativo"})]}),e.jsxs("div",{className:"space-y-2 mb-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Parcelas m√°ximas:"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[a.max_parcelas,"x"]})]}),a.api_enabled&&e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:e.jsxs("span",{className:"text-xs text-blue-600 flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full"}),"API Integrada"]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N(a),className:"flex-1 bg-blue-50 text-blue-600 px-3 py-2 rounded hover:bg-blue-100 flex items-center justify-center gap-2 transition-colors text-sm",children:[e.jsx(D,{className:"w-4 h-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>P(a.id),className:"flex-1 bg-red-50 text-red-600 px-3 py-2 rounded hover:bg-red-100 flex items-center justify-center gap-2 transition-colors text-sm",children:[e.jsx(T,{className:"w-4 h-4"}),"Excluir"]})]})]},a.id)})}),u.length===0&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx(M,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Nenhuma operadora cadastrada"}),e.jsx("p",{className:"text-sm text-gray-500",children:'Clique em "Nova Operadora" para come√ßar'})]}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:m?"Editar Operadora":"Nova Operadora"}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(z,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:A,className:"p-6",children:[j&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-red-600 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-red-700",children:j})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informa√ß√µes B√°sicas"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Operadora *"}),e.jsx("input",{type:"text",value:s.nome,onChange:a=>r({...s,nome:a.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ex: Stone, Cielo, Rede",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C√≥digo (sigla)"}),e.jsx("input",{type:"text",value:s.codigo,onChange:a=>r({...s,codigo:a.target.value.toUpperCase()}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono",placeholder:"Ex: STONE, CIELO",maxLength:50})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M√°ximo de Parcelas *"}),e.jsx("input",{type:"number",value:s.max_parcelas,onChange:a=>r({...s,max_parcelas:parseInt(a.target.value)||1}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"24",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Entre 1 e 24 parcelas"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.padrao,onChange:a=>r({...s,padrao:a.target.checked}),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Operadora Padr√£o"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.ativo,onChange:a=>r({...s,ativo:a.target.checked}),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Ativo"})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Interface"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:s.cor,onChange:a=>r({...s,cor:a.target.value}),className:"w-16 h-10 border border-gray-300 rounded cursor-pointer"}),e.jsx("input",{type:"text",value:s.cor,onChange:a=>r({...s,cor:a.target.value}),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono",placeholder:"#00A868"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"√çcone"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(a=>e.jsx("button",{type:"button",onClick:()=>r({...s,icone:a}),className:`w-10 h-10 rounded flex items-center justify-center text-xl transition-colors ${s.icone===a?"bg-blue-100 ring-2 ring-blue-500":"bg-gray-100 hover:bg-gray-200"}`,children:a},a))})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Integra√ß√£o API (Opcional)"}),e.jsxs("label",{className:"flex items-center gap-2 mb-4 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.api_enabled,onChange:a=>r({...s,api_enabled:a.target.checked}),className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Habilitar integra√ß√£o via API"})]}),s.api_enabled&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-blue-200",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Endpoint da API"}),e.jsx("input",{type:"url",value:s.api_endpoint,onChange:a=>r({...s,api_endpoint:a.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"https://api.operadora.com/v1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Token de Acesso"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:g?"text":"password",value:s.api_token_encrypted,onChange:a=>r({...s,api_token_encrypted:a.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-sm",placeholder:"Token ser√° criptografado ao salvar"}),e.jsx("button",{type:"button",onClick:()=>v(!g),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:g?e.jsx(q,{className:"w-4 h-4"}):e.jsx(R,{className:"w-4 h-4"})})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 transition-colors",children:[e.jsx(V,{className:"w-4 h-4"}),m?"Salvar Altera√ß√µes":"Criar Operadora"]})]})]})]})})]})}export{G as default};
