import{u as Ye,p as Ve,r as d,j as e}from"./vendor-react-1771891349838.js";import{a as Qe}from"./vendor-utils-1771891349838.js";const Xe="/api",Ze=Xe,f=Qe.create({baseURL:Ze,timeout:15e3,headers:{"Content-Type":"application/json"}});f.interceptors.request.use(s=>{const u=String(s.baseURL||""),m=String(s.url||"");return u.endsWith("/api")&&m.startsWith("/api/")&&(s.url=m.replace(/^\/api/,"")),s});const F="ecommerce_customer_token",ze="ecommerce_customer_orders",te="ecommerce_customer_address",ne="ecommerce_guest_cart",N={pedido_id:null,itens:[],subtotal:0,total:0},K={cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""};function j(s){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(s||0))}function oe(s){return Number((s==null?void 0:s.preco_venda)??(s==null?void 0:s.preco)??(s==null?void 0:s.preco_promocional)??0)}function He(){var s;return(s=window==null?void 0:window.crypto)!=null&&s.randomUUID?window.crypto.randomUUID():`checkout-${Date.now()}-${Math.random().toString(16).slice(2)}`}function ea(s){return Array.isArray(s)?s:Array.isArray(s==null?void 0:s.items)?s.items:Array.isArray(s==null?void 0:s.itens)?s.itens:Array.isArray(s==null?void 0:s.produtos)?s.produtos:[]}function se(){try{const s=localStorage.getItem(ne);if(!s)return{...N};const u=JSON.parse(s);if(!Array.isArray(u==null?void 0:u.itens))return{...N};const m=Number((u==null?void 0:u.subtotal)||0),h=Number((u==null?void 0:u.total)||0);return{pedido_id:null,itens:u.itens,subtotal:m,total:h}}catch{return{...N}}}function ie(s){const u=s.reduce((m,h)=>m+Number(h.preco_unitario||0)*Number(h.quantidade||0),0);return{pedido_id:null,itens:s,subtotal:u,total:u}}function aa(){try{const s=localStorage.getItem(te);if(!s)return{...K};const u=JSON.parse(s);return typeof u=="object"&&u!==null?{...K,...u}:{...K,endereco:String(s||"")}}catch{const s=localStorage.getItem(te)||"";return{...K,endereco:s}}}function ra(s){const u=[s.endereco,s.numero].filter(Boolean).join(", "),m=s.bairro?`Bairro: ${s.bairro}`:"",h=[s.cidade,s.estado].filter(Boolean).join("/"),L=s.cep?`CEP: ${s.cep}`:"",B=s.complemento?`Compl.: ${s.complemento}`:"";return[u,m,h,L,B].filter(Boolean).join(" | ")}function ia(){var Ae,Ee,Te,Ne,Le;const s=Ye(),u=Ve(),[m,h]=d.useState("loja"),[L,B]=d.useState(!1),[U,Y]=d.useState([]),[D,Ie]=d.useState(""),[P,Fe]=d.useState("todas"),[y,de]=d.useState(null),[le,M]=d.useState(!1),[ce,ue]=d.useState(!1),[Be,ge]=d.useState(!1),[p,O]=d.useState(localStorage.getItem(F)||""),[q,V]=d.useState(null),[$,G]=d.useState({email:"",password:"",nome:""}),[Q,X]=d.useState({email:"",password:""}),[g,S]=d.useState(()=>se()),[Z,he]=d.useState(""),[k,H]=d.useState(null),[E,pe]=d.useState(""),[T,me]=d.useState("entrega"),[b,w]=d.useState(()=>aa()),[v,W]=d.useState(null),[J,ee]=d.useState(null),[z,Ue]=d.useState(()=>{try{return JSON.parse(localStorage.getItem(ze)||"[]")}catch{return[]}}),[fe,ye]=d.useState({}),[je,l]=d.useState(""),[be,x]=d.useState(""),[o,ae]=d.useState(null),C=d.useMemo(()=>new URLSearchParams(s.search).get("tenant")||u.tenantId||"",[s.search,u.tenantId]),xe=d.useMemo(()=>o!=null&&o.id?{"X-Tenant-ID":o.id}:{},[o==null?void 0:o.id]),_=d.useMemo(()=>p?{Authorization:`Bearer ${p}`}:{},[p]),De=d.useMemo(()=>{const a=U.map(r=>(r==null?void 0:r.categoria_nome)||(r==null?void 0:r.categoria)||"Sem categoria").filter(Boolean);return["todas",...Array.from(new Set(a))]},[U]),ve=d.useMemo(()=>{const a=D.trim().toLowerCase();return U.filter(r=>{const i=String((r==null?void 0:r.nome)||"").toLowerCase(),n=(r==null?void 0:r.categoria_nome)||(r==null?void 0:r.categoria)||"Sem categoria";return(!a||i.includes(a))&&(P==="todas"||n===P)})},[U,D,P]);d.useEffect(()=>{if(!C){Y([]),ae(null),l("Loja não informada na URL. Use /slug-da-loja.");return}Pe(),Se()},[C]),d.useEffect(()=>{p&&(Me(),ke())},[p]),d.useEffect(()=>{o!=null&&o.cidade&&!E&&pe(o.cidade)},[o==null?void 0:o.cidade,E]),d.useEffect(()=>{p||localStorage.setItem(ne,JSON.stringify(g||N))},[g,p]);async function Pe(){var a,r;try{const i=await f.get("/api/ecommerce/tenant-context",{params:{tenant:C}});ae((i==null?void 0:i.data)||null)}catch(i){ae(null),l(((r=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:r.detail)||"Loja inválida para e-commerce")}}async function Se(){var a,r;if(C){B(!0),l("");try{const i=await f.get("/api/ecommerce/produtos",{params:{tenant:C,limit:100,busca:D||void 0}});Y(ea(i==null?void 0:i.data))}catch(i){Y([]),l(((r=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao carregar produtos vendáveis")}finally{B(!1)}}}async function Me(){if(p)try{const a=await f.get("/api/ecommerce/auth/me",{headers:_});V(a.data)}catch{V(null),O(""),localStorage.removeItem(F),S(se())}}async function ke(a=_){var r,i;if(a!=null&&a.Authorization){ge(!0);try{const n=await f.get("/api/carrinho",{headers:a});S(n.data||{...N})}catch(n){l(((i=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:i.detail)||"Erro ao carregar carrinho")}finally{ge(!1)}}}async function _e(a){var n;const r=se();if(!((n=r==null?void 0:r.itens)!=null&&n.length))return;const i={Authorization:`Bearer ${a}`};for(const t of r.itens)await f.post("/api/carrinho/adicionar",{produto_id:t.produto_id,quantidade:t.quantidade},{headers:i});await ke(i),localStorage.removeItem(ne)}async function Oe(a){var r,i,n;if(a.preventDefault(),!(o!=null&&o.id)){l("Loja não identificada na URL.");return}M(!0),l(""),x("");try{const t=await f.post("/api/ecommerce/auth/registrar",$,{headers:xe}),c=(r=t==null?void 0:t.data)==null?void 0:r.access_token;if(!c)throw new Error("Token não retornado");localStorage.setItem(F,c),O(c),await _e(c),G({email:"",password:"",nome:""}),x("Cadastro realizado com sucesso."),h("loja")}catch(t){l(((n=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:n.detail)||"Erro ao cadastrar cliente")}finally{M(!1)}}async function qe(a){var r,i,n;if(a.preventDefault(),!(o!=null&&o.id)){l("Loja não identificada na URL.");return}M(!0),l(""),x("");try{const t=await f.post("/api/ecommerce/auth/login",Q,{headers:xe}),c=(r=t==null?void 0:t.data)==null?void 0:r.access_token;if(!c)throw new Error("Token não retornado");localStorage.setItem(F,c),O(c),await _e(c),X({email:"",password:""}),x("Login realizado com sucesso."),h("loja")}catch(t){l(((n=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:n.detail)||"Erro ao realizar login")}finally{M(!1)}}function $e(){V(null),O(""),S({...N}),W(null),ee(null),localStorage.removeItem(F),x("Sessão encerrada.")}async function Re(a){var r,i;if(!p){l("");const n=oe(a);S(t=>{const c=Array.isArray(t==null?void 0:t.itens)?t.itens:[],A=c.find(R=>R.produto_id===a.id)?c.map(R=>R.produto_id===a.id?{...R,quantidade:Number(R.quantidade||0)+1}:R):[...c,{item_id:`guest-${a.id}`,produto_id:a.id,nome:a.nome,preco_unitario:n,quantidade:1}];return ie(A)}),x("Produto adicionado ao carrinho. Faça login no checkout para finalizar.");return}l("");try{const n=await f.post("/api/carrinho/adicionar",{produto_id:a.id,quantidade:1},{headers:_});S(n.data),x("Produto adicionado ao carrinho.")}catch(n){l(((i=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:i.detail)||"Erro ao adicionar no carrinho")}}async function re(a,r){var i,n;if(!p){S(t=>{const c=Array.isArray(t==null?void 0:t.itens)?t.itens:[];if(r<=0){const A=c.filter(R=>R.item_id!==a);return ie(A)}const I=c.map(A=>A.item_id===a?{...A,quantidade:r}:A);return ie(I)});return}l("");try{if(r<=0){const c=await f.delete(`/api/carrinho/remover/${a}`,{headers:_});S(c.data);return}const t=await f.put(`/api/carrinho/atualizar/${a}`,{quantidade:r},{headers:_});S(t.data)}catch(t){l(((n=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:n.detail)||"Erro ao atualizar carrinho")}}async function Ge(a){var r,i;if(a.preventDefault(),!p){l("Faça login para aplicar cupom."),h("conta");return}if(Z.trim()){l("");try{const n=await f.post("/api/carrinho/aplicar-cupom",{codigo:Z.trim()},{headers:_});H(n.data),x("Cupom validado.")}catch(n){H(null),l(((i=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:i.detail)||"Cupom inválido")}}}async function We(a){var i,n,t;if(a.preventDefault(),!p){l("Faça login para continuar no checkout."),h("conta");return}if(!((i=g==null?void 0:g.itens)!=null&&i.length)){l("Adicione itens no carrinho antes de calcular o checkout.");return}const r=((o==null?void 0:o.cidade)||E||b.cidade||"").trim();if(!r||r.length<2){l("Cidade da loja não configurada para checkout.");return}l(""),W(null);try{const c=await f.get("/api/checkout/resumo",{headers:_,params:{cidade_destino:r,cupom:(k==null?void 0:k.codigo)||void 0}});W(c.data),x("Resumo de checkout calculado.")}catch(c){l(((t=(n=c==null?void 0:c.response)==null?void 0:n.data)==null?void 0:t.detail)||"Erro ao calcular resumo do checkout")}}async function Je(){var i,n;if(!p){l("Faça login para finalizar o pedido."),h("conta");return}const a=((o==null?void 0:o.cidade)||E||b.cidade||"").trim();if(!a||a.length<2){l("Cidade da loja não configurada para checkout.");return}const r=T==="retirada"?"RETIRADA NA LOJA":ra(b);if(T==="entrega"&&!r){l("Informe o endereço de entrega.");return}ue(!0),l(""),x(""),ee(null);try{const c=(await f.post("/api/checkout/finalizar",{cidade_destino:a,endereco_entrega:r||null,cupom:(k==null?void 0:k.codigo)||null},{headers:{..._,"Idempotency-Key":He()}})).data;if(ee(c),S({pedido_id:null,itens:[],subtotal:0,total:0}),W(null),H(null),he(""),T==="entrega"&&localStorage.setItem(te,JSON.stringify(b)),c!=null&&c.pedido_id){const I=Array.from(new Set([c.pedido_id,...z]));Ue(I),localStorage.setItem(ze,JSON.stringify(I))}x("Pedido finalizado com sucesso."),h("pedidos")}catch(t){l(((n=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:n.detail)||"Erro ao finalizar checkout")}finally{ue(!1)}}async function we(a){if(!(!p||!a))try{const r=await f.get(`/api/checkout/pedido/${a}/status`,{headers:_});ye(i=>({...i,[a]:r.data}))}catch(r){ye(i=>{var n,t;return{...i,[a]:{status:"erro",detail:((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.detail)||"Erro ao consultar pedido"}}})}}d.useEffect(()=>{!p||m!=="pedidos"||z.slice(0,10).forEach(a=>{fe[a]||we(a)})},[m,p,z]);const Ce=Number((g==null?void 0:g.total)||0);function Ke(){var a;if(!((a=g==null?void 0:g.itens)!=null&&a.length)){l("Adicione itens no carrinho antes de finalizar.");return}if(!p){l("Faça login para finalizar o pedido."),h("conta");return}h("checkout")}return e.jsxs("div",{className:"page",children:[e.jsx("h1",{children:"E-commerce MVP"}),e.jsx("p",{style:{color:"#666",marginBottom:16},children:"Loja, carrinho, checkout e conta do cliente no fluxo do e-commerce."}),e.jsxs("div",{style:{marginBottom:12,color:o!=null&&o.id?"#0a7d32":"#b00020"},children:["Loja: ",(o==null?void 0:o.name)||"não identificada"," (",(o==null?void 0:o.ecommerce_slug)||C||"-",")"]}),(o==null?void 0:o.storefront_path)&&e.jsxs("div",{style:{marginBottom:12,color:"#4b5563"},children:["URL da loja: ",o.storefront_path]}),!C&&e.jsx("div",{style:{marginBottom:12,color:"#b00020"},children:"Use a URL no formato: /slug-da-loja"}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:16},children:[e.jsx("button",{className:"btn-secondary",onClick:()=>h("loja"),children:"Loja"}),e.jsx("button",{className:"btn-secondary",onClick:()=>h("carrinho"),children:"Carrinho"}),e.jsx("button",{className:"btn-secondary",onClick:()=>h("checkout"),children:"Checkout"}),e.jsx("button",{className:"btn-secondary",onClick:()=>h("pedidos"),children:"Meus pedidos"}),e.jsx("button",{className:"btn-secondary",onClick:()=>h("conta"),children:"Conta"})]}),je&&e.jsx("div",{style:{background:"#ffe8e8",color:"#8c0000",padding:10,borderRadius:6,marginBottom:12},children:je}),be&&e.jsx("div",{style:{background:"#e8fff0",color:"#0a7d32",padding:10,borderRadius:6,marginBottom:12},children:be}),m==="loja"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr) 300px",gap:16},children:[e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[e.jsx("input",{value:D,onChange:a=>Ie(a.target.value),placeholder:"Buscar produto...",style:{flex:1,padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("select",{value:P,onChange:a=>Fe(a.target.value),style:{padding:8,border:"1px solid #ddd",borderRadius:6},children:De.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx("button",{className:"btn-secondary",onClick:Se,disabled:L,children:L?"Carregando...":"Atualizar"})]}),e.jsxs("div",{style:{display:"grid",gap:8},children:[ve.map(a=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid #eee",borderRadius:6,padding:10},children:[e.jsxs("div",{children:[e.jsx("strong",{children:a.nome}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["Categoria: ",(a==null?void 0:a.categoria_nome)||(a==null?void 0:a.categoria)||"Sem categoria"]}),e.jsx("button",{className:"btn-secondary",onClick:()=>de(a),style:{marginTop:6},children:"Ver produto"})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{marginBottom:6},children:j(oe(a))}),e.jsx("button",{className:"btn-primary",onClick:()=>Re(a),children:"Adicionar"})]})]},a.id)),!L&&ve.length===0&&e.jsx("div",{style:{color:"#666",padding:12,display:"grid",gap:10},children:e.jsx("div",{children:"Nenhum produto encontrado para o filtro atual."})})]}),y&&e.jsxs("div",{style:{marginTop:14,border:"1px solid #e2e8f0",borderRadius:8,padding:12,background:"#f8fafc"},children:[e.jsx("h3",{style:{marginTop:0},children:y.nome}),e.jsxs("div",{children:["Preço: ",e.jsx("strong",{children:j(oe(y))})]}),e.jsxs("div",{children:["Categoria: ",(y==null?void 0:y.categoria_nome)||(y==null?void 0:y.categoria)||"Sem categoria"]}),e.jsxs("div",{children:["Estoque e-commerce: ",(y==null?void 0:y.estoque_ecommerce)??0]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("button",{className:"btn-primary",onClick:()=>Re(y),children:"Adicionar ao carrinho"}),e.jsx("button",{className:"btn-secondary",onClick:()=>de(null),style:{marginLeft:8},children:"Fechar"})]})]})]}),e.jsxs("aside",{style:{background:"#fff",padding:16,borderRadius:8,alignSelf:"start",position:"sticky",top:8},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:10},children:"Resumo do carrinho"}),(Ae=g==null?void 0:g.itens)!=null&&Ae.length?e.jsxs("div",{style:{display:"grid",gap:8},children:[g.itens.slice(0,6).map(a=>e.jsxs("div",{style:{borderBottom:"1px solid #f1f5f9",paddingBottom:6},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:a.nome}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:[a.quantidade," x ",j(a.preco_unitario)]})]},a.item_id)),g.itens.length>6&&e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["+ ",g.itens.length-6," item(ns)"]}),e.jsxs("div",{style:{marginTop:4,fontWeight:700},children:["Subtotal: ",j(Ce)]}),e.jsx("button",{className:"btn-primary",onClick:Ke,children:"Finalizar"}),!p&&e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Você fará login/cadastro ao finalizar."})]}):e.jsx("div",{style:{color:"#666"},children:"Seu carrinho está vazio."})]})]}),m==="carrinho"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Carrinho"}),Be?e.jsx("div",{children:"Carregando carrinho..."}):(Ee=g==null?void 0:g.itens)!=null&&Ee.length?e.jsxs("div",{style:{display:"grid",gap:8},children:[g.itens.map(a=>e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:6,padding:8},children:[e.jsx("div",{style:{fontWeight:600},children:a.nome}),e.jsx("div",{style:{fontSize:12,color:"#666"},children:j(a.preco_unitario)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:6},children:[e.jsx("button",{className:"btn-secondary",onClick:()=>re(a.item_id,a.quantidade-1),children:"-"}),e.jsx("span",{children:a.quantidade}),e.jsx("button",{className:"btn-secondary",onClick:()=>re(a.item_id,a.quantidade+1),children:"+"}),e.jsx("button",{className:"btn-secondary",onClick:()=>re(a.item_id,0),children:"Remover"})]})]},a.item_id)),e.jsxs("div",{style:{marginTop:8,fontWeight:700},children:["Total: ",j(Ce)]})]}):e.jsx("div",{style:{color:"#666"},children:"Carrinho vazio"}),e.jsxs("form",{onSubmit:Ge,style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("input",{value:Z,onChange:a=>he(a.target.value),placeholder:"Cupom",style:{flex:1,padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-secondary",type:"submit",children:"Aplicar"})]}),k&&e.jsxs("div",{style:{marginTop:8,color:"#0a7d32"},children:["Cupom ",k.codigo,": -",j(k.desconto)]})]}),m==="checkout"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"grid",gap:10},children:[e.jsx("h3",{style:{marginTop:0},children:"Checkout"}),e.jsxs("form",{onSubmit:We,style:{display:"grid",gap:8},children:[e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Forma de recebimento"}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"radio",name:"deliveryMode",value:"entrega",checked:T==="entrega",onChange:()=>me("entrega")}),"Entrega"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"radio",name:"deliveryMode",value:"retirada",checked:T==="retirada",onChange:()=>me("retirada")}),"Retirada na loja"]})]})]}),e.jsx("input",{value:(o==null?void 0:o.cidade)||E,onChange:a=>pe(a.target.value),placeholder:"Cidade da loja",disabled:!!(o!=null&&o.cidade),style:{padding:8,border:"1px solid #ddd",borderRadius:6,background:o!=null&&o.cidade?"#f8fafc":"#fff"}}),T==="entrega"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{value:b.cep,onChange:a=>w(r=>({...r,cep:a.target.value})),placeholder:"CEP",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:b.endereco,onChange:a=>w(r=>({...r,endereco:a.target.value})),placeholder:"Rua / Avenida",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsx("input",{value:b.numero,onChange:a=>w(r=>({...r,numero:a.target.value})),placeholder:"Número",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:b.complemento,onChange:a=>w(r=>({...r,complemento:a.target.value})),placeholder:"Complemento",style:{padding:8,border:"1px solid #ddd",borderRadius:6}})]}),e.jsx("input",{value:b.bairro,onChange:a=>w(r=>({...r,bairro:a.target.value})),placeholder:"Bairro",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px",gap:8},children:[e.jsx("input",{value:b.cidade||(o==null?void 0:o.cidade)||"",onChange:a=>w(r=>({...r,cidade:a.target.value})),placeholder:"Cidade",disabled:!!(o!=null&&o.cidade),style:{padding:8,border:"1px solid #ddd",borderRadius:6,background:o!=null&&o.cidade?"#f8fafc":"#fff"}}),e.jsx("input",{value:b.estado||(o==null?void 0:o.uf)||"",onChange:a=>w(r=>({...r,estado:a.target.value})),placeholder:"UF",style:{padding:8,border:"1px solid #ddd",borderRadius:6}})]})]}),e.jsx("button",{className:"btn-secondary",type:"submit",children:"Calcular resumo"})]}),v&&e.jsxs("div",{style:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:10},children:[e.jsxs("div",{children:["Itens: ",v.itens_count]}),e.jsxs("div",{children:["Subtotal: ",j(v.subtotal)]}),e.jsxs("div",{children:["Frete: ",j((Te=v==null?void 0:v.frete)==null?void 0:Te.valor_frete)]}),e.jsxs("div",{children:["Desconto: ",j((Ne=v==null?void 0:v.cupom)==null?void 0:Ne.desconto)]}),e.jsxs("div",{style:{fontWeight:700},children:["Total: ",j(v.total)]})]}),e.jsx("button",{className:"btn-primary",onClick:Je,disabled:ce||!(o!=null&&o.cidade||E)||!((Le=g==null?void 0:g.itens)!=null&&Le.length),children:ce?"Finalizando...":"Finalizar pedido"}),(J==null?void 0:J.pedido_id)&&e.jsxs("div",{style:{background:"#e8fff0",color:"#0a7d32",padding:10,borderRadius:6},children:["Pedido confirmado: ",e.jsx("strong",{children:J.pedido_id})]})]}),m==="pedidos"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Meus pedidos"}),z.length===0?e.jsx("div",{style:{color:"#666"},children:"Nenhum pedido registrado nesta sessão."}):e.jsx("div",{style:{display:"grid",gap:8},children:z.map(a=>{const r=fe[a];return e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:6,padding:10},children:[e.jsx("div",{children:e.jsx("strong",{children:a})}),e.jsxs("div",{children:["Status: ",(r==null?void 0:r.status)||"não consultado"]}),e.jsxs("div",{children:["Total: ",(r==null?void 0:r.total)!=null?j(r.total):"-"]}),e.jsx("button",{className:"btn-secondary",onClick:()=>we(a),style:{marginTop:6},children:"Atualizar status"})]},a)})})]}),m==="conta"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Cadastro"}),e.jsxs("form",{onSubmit:Oe,style:{display:"grid",gap:8},children:[e.jsx("input",{value:$.nome,onChange:a=>G(r=>({...r,nome:a.target.value})),placeholder:"Nome",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:$.email,onChange:a=>G(r=>({...r,email:a.target.value})),placeholder:"Email",type:"email",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:$.password,onChange:a=>G(r=>({...r,password:a.target.value})),placeholder:"Senha",type:"password",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-primary",type:"submit",disabled:le,children:"Cadastrar"})]})]}),e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Login"}),e.jsxs("form",{onSubmit:qe,style:{display:"grid",gap:8},children:[e.jsx("input",{value:Q.email,onChange:a=>X(r=>({...r,email:a.target.value})),placeholder:"Email",type:"email",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:Q.password,onChange:a=>X(r=>({...r,password:a.target.value})),placeholder:"Senha",type:"password",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-primary",type:"submit",disabled:le,children:"Entrar"})]}),e.jsx("hr",{style:{margin:"12px 0"}}),e.jsx("h4",{style:{marginBottom:6},children:"Perfil"}),q?e.jsxs("div",{style:{display:"grid",gap:4},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nome:"})," ",q.nome||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",q.email||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ID:"})," ",q.id]}),e.jsx("button",{className:"btn-secondary",onClick:$e,style:{marginTop:8},children:"Sair"})]}):e.jsx("div",{style:{color:"#666"},children:"Nenhum cliente autenticado."})]})]})]})}export{ia as default};
