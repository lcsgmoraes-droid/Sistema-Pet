import{r as d,j as e,T as Oa,ac as $a,a9 as Ba,ag as Ua,S as Ga,ah as Ha,ai as Wa}from"./vendor-react-1772218378171.js";import{e as _e,a as Qa,b as Ja,h as Xa,i as sa,j as ra,k as ee,l as ve,f as oa,c as ta,m as ia,d as Ya,n as Za,o as es,p as as,u as ss,q as rs,r as os,s as ts,t as is,v as ls,w as ds,x as cs,y as ns}from"./produtos-17722183781712.js";import{a as N}from"./index-1772218378171.js";const us=({value:f,onChange:u,pesoEmbalagem:E})=>{const[c,_]=d.useState("filhote_peso_adulto"),[C,s]=d.useState([]),[p,ae]=d.useState(!1),U=d.useRef(null),[O]=d.useState([{id:"2m",label:"2 meses"},{id:"3m",label:"3 meses"},{id:"4m",label:"4 meses"},{id:"6m",label:"6 meses"},{id:"8m",label:"8 meses"},{id:"10m",label:"10 meses"},{id:"12m",label:"12 meses"},{id:"15m",label:"15 meses"},{id:"18m",label:"18 meses"},{id:"adulto",label:"Adulto"}]);d.useEffect(()=>{if(f&&!p)try{const n=typeof f=="string"?JSON.parse(f):f;if(console.log("üì• Carregando tabela:",n),n.tipo&&_(n.tipo),n.dados){const g=Object.entries(n.dados).map(([j,k])=>({peso:j,consumos:k}));s(g)}ae(!0)}catch(n){console.error("Erro ao carregar tabela:",n),ae(!0)}},[f,p]);const se=()=>{switch(c){case"filhote_peso_adulto":return"Peso Adulto Esperado";case"adulto":return"Peso Atual";default:return"Peso"}},re=()=>{switch(c){case"filhote_peso_adulto":return"Ex: 5kg, 10kg, 15kg, 20kg";case"adulto":return"Ex: 5kg, 10kg, 15kg, 20kg";default:return""}},oe=()=>{const n={peso:"",consumos:{}},g=[...C,n];s(g)},te=n=>{const g=C.filter((j,k)=>k!==n);s(g),R(g)},ie=(n,g)=>{const j=[...C];j[n].peso=g,s(j)},G=(n,g,j)=>{const k=[...C];k[n].consumos||(k[n].consumos={});const P=parseFloat(j)||0;k[n].consumos[g]=P,s(k)},T=n=>{if(!E||!n)return"-";const g=E*1e3;return`${Math.floor(g/n)}d`},R=d.useCallback(n=>{if(!p){console.log("‚è∏Ô∏è Aguardando carregamento inicial...");return}const g=n||C,j={};g.forEach(A=>{A.peso&&(j[A.peso]=A.consumos)});const k={tipo:c,dados:j},P=JSON.stringify(k);if(U.current===P){console.log("‚è≠Ô∏è Ignorando - j√° est√° salvo");return}console.log("üíæ Salvando tabela:",k),U.current=P,u(P)},[C,c,u,p]),V=()=>{R(),alert("‚úÖ Tabela de consumo salva com sucesso!")};return e.jsxs("div",{className:"border border-gray-300 rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2",children:"üìä Tabela de Consumo da Embalagem"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Preencha a tabela com as informa√ß√µes da embalagem. A IA usar√° esses dados para calcular dura√ß√£o e custo-benef√≠cio."}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Tabela da Embalagem:"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"filhote_peso_adulto",checked:c==="filhote_peso_adulto",onChange:n=>_(n.target.value),className:"text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"üê∂ Filhote (Peso Adulto Esperado)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"adulto",checked:c==="adulto",onChange:n=>_(n.target.value),className:"text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"üêï Adulto (Peso Atual)"})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 px-3 py-2 text-left text-sm font-semibold text-gray-700 w-32",children:se()}),O.map(n=>e.jsxs("th",{className:"border border-gray-300 px-2 py-2 text-center text-xs font-semibold text-gray-700 min-w-[90px]",children:[n.label,e.jsx("div",{className:"text-[10px] text-gray-500 font-normal",children:"g/dia | dias"})]},n.id)),e.jsx("th",{className:"border border-gray-300 px-2 py-2 text-center text-sm font-semibold text-gray-700 w-16",children:"A√ß√µes"})]})}),e.jsx("tbody",{children:C.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:O.length+2,className:"border border-gray-300 px-4 py-8 text-center text-gray-500",children:[e.jsx(Oa,{className:"inline-block mr-2"}),'Nenhuma linha adicionada. Clique em "Adicionar Linha" para come√ßar.']})}):C.map((n,g)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border border-gray-300 px-2 py-2",children:e.jsx("input",{type:"text",value:n.peso,onChange:j=>ie(g,j.target.value),onBlur:()=>R(),placeholder:re(),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})}),O.map(j=>{var A;const k=((A=n.consumos)==null?void 0:A[j.id])||"",P=T(k);return e.jsxs("td",{className:"border border-gray-300 px-1 py-1",children:[e.jsx("input",{type:"number",value:k,onChange:le=>G(g,j.id,le.target.value),onBlur:()=>R(),placeholder:"0",className:"w-full px-2 py-1 text-sm text-center border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("div",{className:"text-[10px] text-center text-gray-500 mt-0.5",children:P})]},j.id)}),e.jsx("td",{className:"border border-gray-300 px-2 py-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>te(g),className:"text-red-600 hover:text-red-800 p-1",title:"Remover linha",children:e.jsx($a,{size:16})})})]},g))})]})}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs("button",{type:"button",onClick:oe,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[e.jsx(Ba,{size:16}),"Adicionar Linha"]}),e.jsxs("button",{type:"button",onClick:V,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[e.jsx(Ua,{size:16}),"Salvar Tabela"]})]}),E&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["üí° ",e.jsx("strong",{children:"Peso da embalagem:"})," ",E,"kg (",E*1e3,"g)",e.jsx("br",{}),"A dura√ß√£o (dias) √© calculada automaticamente: ",e.jsx("code",{children:"peso_embalagem √∑ consumo_di√°rio"})]})})]})},S=f=>{if(f===""||f===null||f===void 0)return 0;const E=f.toString().replace(/[^\d.,]/g,"").replace(",","."),c=parseFloat(E);return isNaN(c)?0:c};function gs(){var Te,ze,Oe,$e,Be,Ue,Ge,He,We,Qe,Je,Xe,Ye,Ze,ea;const f=Ga(),{id:u}=Ha(),[E]=Wa(),c=!!u,[_,C]=d.useState(1),[s,p]=d.useState({codigo:"",sku:"",nome:"",codigo_barras:"",categoria_id:"",marca_id:"",departamento_id:"",tipo:"produto",unidade:"UN",descricao:"",preco_custo:"",preco_venda:"",preco_promocional:"",data_inicio_promocao:"",data_fim_promocao:"",markup:"",tipo_produto:"SIMPLES",produto_pai_id:null,tipo_kit:null,e_kit_fisico:!1,composicao_kit:[],produto_predecessor_id:null,motivo_descontinuacao:"",controle_lote:!0,estoque_minimo:"",estoque_maximo:"",tributacao:{origem:null,herdado_da_empresa:!1,origem_mercadoria:"0",ncm:"",cest:"",cfop:"",cst_icms:"",icms_aliquota:"",icms_st:!1,pis_aliquota:"",cofins_aliquota:""},origem:"0",ncm:"",cest:"",cfop:"",aliquota_icms:"",aliquota_pis:"",aliquota_cofins:"",tem_recorrencia:!1,tipo_recorrencia:"monthly",intervalo_dias:"",numero_doses:"",observacoes_recorrencia:"",especie_compativel:"both",classificacao_racao:"",peso_embalagem:"",tabela_nutricional:"",tabela_consumo:"",categoria_racao:"",especies_indicadas:"both",linha_racao_id:"",porte_animal_id:"",fase_publico_id:"",tipo_tratamento_id:"",sabor_proteina_id:"",apresentacao_peso_id:""}),[ae,U]=d.useState([]),[O,se]=d.useState([]),[re,oe]=d.useState([]),[te,ie]=d.useState([]),[G,T]=d.useState([]),[R,V]=d.useState([]),[n,g]=d.useState([]),[j,k]=d.useState([]),[P,A]=d.useState([]),[le,la]=d.useState([]),[je,da]=d.useState([]),[ca,na]=d.useState([]),[ua,ma]=d.useState([]),[ye,pa]=d.useState([]),[Ne,de]=d.useState([]),[x,I]=d.useState({sku:"",nome:"",codigo_barras:"",preco_custo:"",preco_venda:"",estoque_minimo:0,e_kit:!1,e_kit_fisico:!1,composicao_kit:[]}),[ce,ne]=d.useState(!1),[ke,we]=d.useState([]),[H,Ce]=d.useState(""),[W,Se]=d.useState(""),[Q,Ee]=d.useState(0),[ue,xa]=d.useState(!1),[qe,me]=d.useState([]),[ga,Pe]=d.useState(""),[$,pe]=d.useState(null),[z,Ie]=d.useState(null),[D,Ae]=d.useState(null),[xe,Fe]=d.useState(!1),[Le,Me]=d.useState(!1),[Re,Ve]=d.useState(!1),[ba,ge]=d.useState(!1),[h,K]=d.useState({quantidade:"",nome_lote:"",data_fabricacao:"",data_validade:"",preco_custo:""}),[ha,be]=d.useState(!1),[J,F]=d.useState({preco_custo:!1,markup:!1,preco_venda:!1,preco_promocional:!1}),[y,L]=d.useState(null),[fa,X]=d.useState(!1),[Y,De]=d.useState(null),[v,M]=d.useState({fornecedor_id:"",codigo_fornecedor:"",preco_custo:"",prazo_entrega:"",estoque_fornecedor:"",e_principal:!1});d.useEffect(()=>{va(),c&&ya()},[u]),d.useEffect(()=>{if(!c&&s.nome){const a=s.nome.toLowerCase();(a.includes("racao")||a.includes("ra√ß√£o"))&&s.classificacao_racao!=="sim"&&p(o=>({...o,classificacao_racao:"sim"}))}},[s.nome,c,s.classificacao_racao]),d.useEffect(()=>{if(!xe&&c){const a=E.get("aba");a&&C(parseInt(a))}},[xe,E,c]),d.useEffect(()=>{c&&s.tipo_produto==="VARIACAO"&&_===8&&C(1)},[s.tipo_produto,_,c]),d.useEffect(()=>{c&&_===8&&s.tipo_produto==="PAI"&&_a()},[_,c,s.tipo_produto]);const _a=async()=>{try{const a=await _e(u);de(a.data)}catch(a){console.error("Erro ao carregar varia√ß√µes:",a)}},va=async()=>{try{const[a,r,o,i]=await Promise.all([Qa(),Ja(),Xa(),N.get("/clientes/",{params:{tipo_cadastro:"fornecedor",apenas_ativos:!0}})]);U(a.data);const t=Ke(a.data);se(t),oe(r.data),ie(o.data),k(i.data),ja()}catch(a){console.error("Erro ao carregar dados auxiliares:",a)}},ja=async()=>{try{const[a,r,o,i,t,m]=await Promise.all([N.get("/opcoes-racao/linhas",{params:{apenas_ativos:!0}}),N.get("/opcoes-racao/portes",{params:{apenas_ativos:!0}}),N.get("/opcoes-racao/fases",{params:{apenas_ativos:!0}}),N.get("/opcoes-racao/tratamentos",{params:{apenas_ativos:!0}}),N.get("/opcoes-racao/sabores",{params:{apenas_ativos:!0}}),N.get("/opcoes-racao/apresentacoes",{params:{apenas_ativos:!0}})]);A(a.data),la(r.data),da(o.data),na(i.data),ma(t.data),pa(m.data)}catch(a){console.error("Erro ao carregar op√ß√µes de ra√ß√£o:",a)}},Ke=(a,r=null,o=0)=>{let i=[];return a.filter(m=>m.categoria_pai_id===r).forEach(m=>{const q="¬†¬†¬†¬†".repeat(o),b=o>0?"‚Üí ":"";i.push({...m,nomeFormatado:q+b+m.nome,nivel:o});const w=Ke(a,m.id,o+1);i=i.concat(w)}),i},ya=async()=>{var a,r,o;try{Fe(!0),Ie(null),Ae(null);const t=(await sa(u)).data;let m="";if(t.preco_custo&&t.preco_venda&&t.preco_custo>0&&(m=ra(t.preco_custo,t.preco_venda).toFixed(2)),p({...t,sku:t.codigo||"",codigo:t.codigo||"",nome:t.nome||"",codigo_barras:t.codigo_barras||"",categoria_id:t.categoria_id||"",marca_id:t.marca_id||"",departamento_id:t.departamento_id||"",unidade:t.unidade||"UN",descricao:t.descricao_curta||"",tipo:t.tipo||"produto",preco_custo:t.preco_custo||"",preco_venda:t.preco_venda||"",preco_promocional:t.preco_promocional||"",data_inicio_promocao:t.promocao_inicio||"",data_fim_promocao:t.promocao_fim||"",estoque_minimo:t.estoque_minimo||"",estoque_maximo:t.estoque_maximo||"",controle_lote:t.controle_lote??!0,markup:m,tipo_produto:t.tipo_produto||"SIMPLES",produto_pai_id:t.produto_pai_id||null,tipo_kit:t.tipo_kit||null,e_kit_fisico:t.e_kit_fisico||!1,composicao_kit:t.composicao_kit||[],origem:t.origem||"0",ncm:t.ncm||"",cest:t.cest||"",cfop:t.cfop||"",aliquota_icms:t.aliquota_icms||"",aliquota_pis:t.aliquota_pis||"",aliquota_cofins:t.aliquota_cofins||"",tem_recorrencia:t.tem_recorrencia||!1,tipo_recorrencia:t.tipo_recorrencia||"monthly",intervalo_dias:t.intervalo_dias||"",numero_doses:t.numero_doses||"",especie_compativel:t.especie_compativel||"both",observacoes_recorrencia:t.observacoes_recorrencia||"",classificacao_racao:t.classificacao_racao||"",peso_embalagem:t.peso_embalagem||"",tabela_nutricional:t.tabela_nutricional||"",tabela_consumo:t.tabela_consumo||"",categoria_racao:t.categoria_racao||"",especies_indicadas:t.especies_indicadas||"both",linha_racao_id:t.linha_racao_id||"",porte_animal_id:t.porte_animal_id||"",fase_publico_id:t.fase_publico_id||"",tipo_tratamento_id:t.tipo_tratamento_id||"",sabor_proteina_id:t.sabor_proteina_id||"",apresentacao_peso_id:t.apresentacao_peso_id||""}),t.produto_predecessor_id)try{const b=await sa(t.produto_predecessor_id);Ie({id:b.data.id,codigo:b.data.codigo,nome:b.data.nome,motivo_descontinuacao:t.motivo_descontinuacao,data_descontinuacao:(a=t.predecessor)==null?void 0:a.data_descontinuacao})}catch(b){console.error("Erro ao carregar predecessor:",b)}if(t.data_descontinuacao)try{const b=await N.get("/produtos/",{params:{produto_predecessor_id:t.id,ativo:null}}),w=Array.isArray(b.data)?b.data:b.data.items||[];if(w&&w.length>0){const B=w[0];Ae({id:B.id,codigo:B.codigo,nome:B.nome,motivo_descontinuacao:t.motivo_descontinuacao,data_descontinuacao:t.data_descontinuacao})}}catch(b){console.error("‚ùå Erro ao carregar sucessor:",b)}try{const b=await N.get(`/produtos/${u}/imagens`);V(b.data||[])}catch(b){console.error("Erro ao carregar imagens:",b),V([])}if(t.controle_lote){const b=await ee(u);T(b.data)}const q=await ve(u);g(q.data),await Na(t)}catch(i){console.error("‚ùå Erro ao carregar produto:",i),alert("Erro ao carregar produto: "+(((o=(r=i.response)==null?void 0:r.data)==null?void 0:o.detail)||i.message))}finally{Fe(!1)}},Na=async a=>{try{const r=a.tipo_produto==="KIT",{data:o}=r?await N.get(`/produtos/${a.id}/kit/fiscal`):await N.get(`/produtos/${a.id}/fiscal`);p(i=>({...i,tributacao:{origem:o.origem,herdado_da_empresa:o.herdado_da_empresa,origem_mercadoria:o.origem_mercadoria??"0",ncm:o.ncm??"",cest:o.cest??"",cfop:o.cfop??"",cst_icms:o.cst_icms??"",icms_aliquota:o.icms_aliquota??"",icms_st:o.icms_st??!1,pis_aliquota:o.pis_aliquota??"",cofins_aliquota:o.cofins_aliquota??""}}))}catch(r){console.error("Erro ao carregar fiscal:",r)}},ka=async a=>{const r={origem_mercadoria:s.tributacao.origem_mercadoria,ncm:s.tributacao.ncm,cest:s.tributacao.cest,cfop:s.tributacao.cfop,cst_icms:s.tributacao.cst_icms,icms_aliquota:s.tributacao.icms_aliquota,icms_st:s.tributacao.icms_st,pis_aliquota:s.tributacao.pis_aliquota,cofins_aliquota:s.tributacao.cofins_aliquota};a.tipo_produto==="KIT"?await N.put(`/produtos/${a.id}/kit/fiscal`,r):await N.put(`/produtos/${a.id}/fiscal`,r)},l=(a,r)=>{p(o=>{const i={...o,[a]:r};if(a==="preco_custo"||a==="preco_venda"){const t=S(a==="preco_custo"?r:o.preco_custo),m=S(a==="preco_venda"?r:o.preco_venda);if(t&&m&&t>0){const q=ra(t,m);i.markup=q.toFixed(2)}}if(a==="markup"){const t=S(o.preco_custo),m=S(r);if(t&&t>0&&m>=0){const q=ns(t,m);i.preco_venda=q.toFixed(2)}}return i})},wa=async()=>{try{const a=await Za("PROD");p(r=>({...r,sku:a.data.sku})),alert("SKU gerado com sucesso!")}catch(a){console.error("Erro ao gerar SKU:",a),alert("Erro ao gerar SKU")}},Ca=async()=>{if(!s.sku){alert("Gere ou informe um SKU primeiro!");return}try{const a=await es(s.sku);p(r=>({...r,codigo_barras:a.data.codigo_barras})),alert("C√≥digo de barras gerado com sucesso!")}catch(a){console.error("Erro ao gerar c√É¬≥digo de barras:",a),alert("Erro ao gerar c√É¬≥digo de barras")}},Sa=async()=>{var a,r;if(!h.quantidade||!h.preco_custo){alert("Preencha quantidade e pre√É¬ßo de custo!");return}try{const o=h.nome_lote||`LOTE-${Date.now()}`,i=h.data_fabricacao?new Date(h.data_fabricacao+"T00:00:00").toISOString():null,t=h.data_validade?new Date(h.data_validade+"T23:59:59").toISOString():null;await as(u,{nome_lote:o,quantidade:parseFloat(h.quantidade),preco_custo:parseFloat(h.preco_custo),data_fabricacao:i,data_validade:t,observacoes:h.observacoes||null}),alert("Entrada de estoque realizada com sucesso!"),ge(!1),K({quantidade:"",nome_lote:"",data_fabricacao:"",data_validade:"",preco_custo:""});const m=await ee(u);T(m.data)}catch(o){console.error("Erro ao registrar entrada:",o),alert(((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao registrar entrada de estoque")}},Ea=a=>{var r,o;L({id:a.id,nome_lote:a.nome_lote,quantidade_inicial:a.quantidade_inicial,data_fabricacao:((r=a.data_fabricacao)==null?void 0:r.split("T")[0])||"",data_validade:((o=a.data_validade)==null?void 0:o.split("T")[0])||"",custo_unitario:a.custo_unitario}),be(!0)},qa=async()=>{var a,r;try{const o=y.data_fabricacao?new Date(y.data_fabricacao+"T00:00:00").toISOString():null,i=y.data_validade?new Date(y.data_validade+"T23:59:59").toISOString():null,t={nome_lote:y.nome_lote,quantidade_inicial:parseFloat(y.quantidade_inicial),data_fabricacao:o,data_validade:i,custo_unitario:parseFloat(y.custo_unitario)};await ss(u,y.id,t),alert("Lote atualizado com sucesso!"),be(!1),L(null);const m=await ee(u);T(m.data)}catch(o){console.error("Erro ao atualizar lote:",o),alert(((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao atualizar lote")}},Pa=async a=>{var r,o;if(window.confirm(`Deseja realmente excluir o lote ${a.nome_lote}?

Quantidade: ${a.quantidade_disponivel} unidades
Isso remover√° o registro de entrada do estoque.`))try{await rs(u,a.id),alert("Lote exclu√≠do com sucesso!");const i=await ee(u);T(i.data)}catch(i){console.error("Erro ao excluir lote:",i),alert(((o=(r=i.response)==null?void 0:r.data)==null?void 0:o.detail)||"Erro ao excluir lote")}},Ia=async a=>{var t,m,q,b;const r=Array.from(a.target.files);if(r.length===0)return;const o=["image/jpeg","image/png","image/webp"],i=5*1024*1024;for(const w of r){if(!o.includes(w.type)){alert(`${w.name}: Apenas JPG, PNG e WebP s√£o permitidos`);return}if(w.size>i){alert(`${w.name}: Imagem deve ter no m√°ximo 5MB`);return}}try{Ve(!0);const w=[];for(const fe of r){const aa=new FormData;aa.append("file",fe);try{const Z=await os(u,aa);w.push(Z.data)}catch(Z){console.error(`Erro ao enviar ${fe.name}:`,Z),alert(`Erro ao enviar ${fe.name}: ${((m=(t=Z.response)==null?void 0:t.data)==null?void 0:m.detail)||"Erro desconhecido"}`)}}const B=await N.get(`/produtos/${u}/imagens`);V(B.data||[]),alert(`${w.length} imagem(ns) enviada(s) com sucesso!`)}catch(w){console.error("Erro ao enviar imagens:",w),alert(((b=(q=w.response)==null?void 0:q.data)==null?void 0:b.detail)||"Erro ao enviar imagens")}finally{Ve(!1),a.target.value=""}},Aa=async a=>{if(confirm("Deseja realmente excluir esta imagem?"))try{await ts(a);const r=await N.get(`/produtos/${u}/imagens`);V(r.data||[]),alert("Imagem exclu√≠da com sucesso!")}catch(r){console.error("Erro ao excluir imagem:",r),alert("Erro ao excluir imagem")}},Fa=async a=>{try{await N.put(`/produtos/imagens/${a}`,{principal:!0});const r=await N.get(`/produtos/${u}/imagens`);V(r.data||[]),alert("Imagem principal atualizada!")}catch(r){console.error("Erro ao definir imagem principal:",r),alert("Erro ao definir imagem principal")}},La=()=>{De(null),M({fornecedor_id:"",codigo_fornecedor:"",preco_custo:"",prazo_entrega:"",estoque_fornecedor:"",e_principal:!1}),X(!0)},Ma=a=>{De(a),M({fornecedor_id:a.fornecedor_id,codigo_fornecedor:a.codigo_fornecedor||"",preco_custo:a.preco_custo||"",prazo_entrega:a.prazo_entrega||"",estoque_fornecedor:a.estoque_fornecedor||"",e_principal:a.e_principal||!1}),X(!0)},Ra=async()=>{var a,r;if(!v.fornecedor_id){alert("Selecione um fornecedor");return}try{const o={...v,preco_custo:v.preco_custo?parseFloat(v.preco_custo):null,prazo_entrega:v.prazo_entrega?parseInt(v.prazo_entrega):null,estoque_fornecedor:v.estoque_fornecedor?parseFloat(v.estoque_fornecedor):null};Y?(await is(Y.id,o),alert("Fornecedor atualizado!")):(await ls(u,o),alert("Fornecedor vinculado!"));const i=await ve(u);g(i.data),X(!1)}catch(o){console.error("Erro ao salvar fornecedor:",o),alert(((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao salvar fornecedor")}},Va=async a=>{if(confirm("Deseja realmente desvincular este fornecedor?"))try{await ds(a);const r=await ve(u);g(r.data),alert("Fornecedor desvinculado!")}catch(r){console.error("Erro ao desvincular fornecedor:",r),alert("Erro ao desvincular fornecedor")}},Da=async()=>{try{const a=await N.get("/produtos/",{params:{apenas_ativos:!0,tipo_produto:"SIMPLES"}});we(a.data.items||[])}catch(a){console.error("Erro ao carregar produtos:",a),we([])}},Ka=()=>{if(!H||!W||W<=0){alert("Selecione um produto e informe a quantidade!");return}if(s.composicao_kit.find(i=>i.produto_id===parseInt(H))){alert("Este produto j√° foi adicionado ao kit!");return}const r=ke.find(i=>i.id===parseInt(H)),o={produto_componente_id:r.id,produto_id:r.id,produto_nome:r.nome,produto_sku:r.codigo,quantidade:parseFloat(W),estoque_componente:r.estoque_atual||0};p(i=>({...i,composicao_kit:[...i.composicao_kit,o]})),Ce(""),Se(""),he([...s.composicao_kit,o])},Ta=a=>{const r=s.composicao_kit.filter(o=>o.produto_id!==a);p(o=>({...o,composicao_kit:r})),he(r)},he=a=>{if(!a||a.length===0){Ee(0);return}const r=a.map(i=>{const t=i.estoque_componente||0,m=i.quantidade||1;return Math.floor(t/m)}),o=Math.min(...r);Ee(o>=0?o:0)};d.useEffect(()=>{const a=s.tipo_produto==="KIT"||s.tipo_produto==="VARIACAO"&&s.tipo_kit;_===9&&a&&(Da(),s.composicao_kit&&s.composicao_kit.length>0&&he(s.composicao_kit))},[_,s.tipo_produto,s.tipo_kit]);const za=async a=>{var r,o;if(a.preventDefault(),!s.nome){alert("Preencha o campo Nome");return}if(s.tipo_produto!=="PAI"&&!s.preco_venda){alert("Preencha o Pre√ßo de Venda");return}if(!s.codigo&&!s.sku){alert("Preencha o campo SKU/C√≥digo");return}try{Me(!0);const i={codigo:s.codigo||s.sku,nome:s.nome,descricao_curta:s.descricao||null,codigo_barras:s.codigo_barras||null,unidade:s.unidade||"UN",preco_custo:s.preco_custo?parseFloat(s.preco_custo):0,preco_venda:parseFloat(s.preco_venda),preco_promocional:s.preco_promocional?parseFloat(s.preco_promocional):null,promocao_inicio:s.data_inicio_promocao||null,promocao_fim:s.data_fim_promocao||null,controle_lote:s.controle_lote||!1,estoque_minimo:s.estoque_minimo?parseInt(s.estoque_minimo):0,estoque_maximo:s.estoque_maximo?parseInt(s.estoque_maximo):null,categoria_id:s.categoria_id?parseInt(s.categoria_id):null,marca_id:s.marca_id?parseInt(s.marca_id):null,departamento_id:s.departamento_id?parseInt(s.departamento_id):null,tipo_produto:s.tipo_produto||"SIMPLES",produto_pai_id:s.produto_pai_id||null,tipo_kit:s.tipo_produto==="KIT"||s.tipo_produto==="VARIACAO"&&s.tipo_kit?s.e_kit_fisico?"FISICO":"VIRTUAL":null,e_kit_fisico:s.tipo_produto==="KIT"||s.tipo_produto==="VARIACAO"&&s.tipo_kit?s.e_kit_fisico:null,composicao_kit:s.tipo_produto==="KIT"||s.tipo_produto==="VARIACAO"&&s.tipo_kit?s.composicao_kit:null,produto_predecessor_id:s.produto_predecessor_id||null,motivo_descontinuacao:s.motivo_descontinuacao||null,tem_recorrencia:s.tem_recorrencia||!1,tipo_recorrencia:s.tem_recorrencia?s.tipo_recorrencia:null,intervalo_dias:s.tem_recorrencia&&s.intervalo_dias?parseInt(s.intervalo_dias):null,numero_doses:s.tem_recorrencia&&s.numero_doses?parseInt(s.numero_doses):null,especie_compativel:s.tem_recorrencia?s.especie_compativel:null,observacoes_recorrencia:s.tem_recorrencia?s.observacoes_recorrencia:null,classificacao_racao:s.classificacao_racao||null,peso_embalagem:s.peso_embalagem?parseFloat(s.peso_embalagem):null,tabela_nutricional:s.tabela_nutricional||null,tabela_consumo:s.tabela_consumo||null,categoria_racao:s.categoria_racao||null,especies_indicadas:s.especies_indicadas||null,linha_racao_id:s.linha_racao_id?parseInt(s.linha_racao_id):null,porte_animal_id:s.porte_animal_id?parseInt(s.porte_animal_id):null,fase_publico_id:s.fase_publico_id?parseInt(s.fase_publico_id):null,tipo_tratamento_id:s.tipo_tratamento_id?parseInt(s.tipo_tratamento_id):null,sabor_proteina_id:s.sabor_proteina_id?parseInt(s.sabor_proteina_id):null,apresentacao_peso_id:s.apresentacao_peso_id?parseInt(s.apresentacao_peso_id):null};if(console.log("√∞≈∏‚Äú¬§ Enviando dados para API:",i),c)await ka({id:u,tipo_produto:s.tipo_produto}),await cs(u,i),alert("Produto atualizado com sucesso!"),f("/produtos");else{const m=(await ia(i)).data.id;s.tipo_produto==="PAI"?(alert("Produto PAI criado com sucesso! Agora cadastre as varia√ß√µes."),f(`/produtos/${m}/editar?aba=variacoes`)):(alert("Produto cadastrado com sucesso!"),f("/produtos"))}}catch(i){console.error("Erro ao salvar produto:",i),alert(((o=(r=i.response)==null?void 0:r.data)==null?void 0:o.detail)||"Erro ao salvar produto")}finally{Me(!1)}};return xe?e.jsx("div",{className:"p-6 flex justify-center items-center h-96",children:e.jsx("div",{className:"text-gray-600",children:"Carregando produto..."})}):c&&!s.nome?e.jsx("div",{className:"p-6 flex justify-center items-center h-96",children:e.jsx("div",{className:"text-gray-600",children:"Carregando dados..."})}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>{s.tipo_produto==="VARIACAO"&&s.produto_pai_id?f(`/produtos/${s.produto_pai_id}/editar?aba=8`):f("/produtos")},className:"text-blue-600 hover:text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Voltar"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:c?"Editar Produto":"Novo Produto"}),c&&s.codigo&&e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"SKU:"}),e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-lg font-mono",children:s.codigo})]}),s.nome&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Descri√ß√£o:"}),e.jsx("span",{className:"text-gray-600",children:s.nome})]})]})]}),e.jsxs("a",{href:"/cadastros/categorias",target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 border border-blue-200 flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Gerenciar Categorias"]})]})}),e.jsx("div",{className:"mb-6 border-b border-gray-200",children:e.jsx("nav",{className:"flex gap-8",children:[{id:1,label:"Caracter√≠sticas"},{id:2,label:"Imagens"},{id:3,label:"Estoque/Lotes"},{id:4,label:"Fornecedores"},{id:5,label:"Tributa√ß√£o"},{id:6,label:"üîÑ Recorr√™ncia"},{id:7,label:"ü•´ Ra√ß√£o"},...s.tipo_produto==="PAI"?[{id:8,label:"üì¶ Varia√ß√µes"}]:[],...s.tipo_produto==="KIT"||s.tipo_produto==="VARIACAO"&&s.tipo_kit?[{id:9,label:"üß© Composi√ß√£o"}]:[]].map(a=>e.jsx("button",{onClick:()=>C(a.id),className:`pb-4 px-1 border-b-2 font-medium text-sm transition-colors ${_===a.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:a.label},a.id))})}),c&&z&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-500 p-5 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-7 h-7 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"üîó Este produto √© continua√ß√£o de outro"})}),e.jsxs("p",{className:"text-sm text-gray-700 mb-3",children:["Este produto substitui:"," ",e.jsxs("button",{type:"button",onClick:()=>f(`/produtos/${z.id}/editar`),className:"font-bold text-blue-700 hover:text-blue-900 hover:underline",children:[z.codigo," - ",z.nome]})]}),z.motivo_descontinuacao&&e.jsxs("div",{className:"bg-white/70 rounded-md px-3 py-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Motivo da substitui√ß√£o:"})," ",e.jsx("span",{className:"text-gray-900",children:z.motivo_descontinuacao})]})]})]})}),c&&D&&e.jsx("div",{className:"mb-6 bg-gradient-to-r from-red-50 to-orange-50 border-l-4 border-red-500 p-5 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-7 h-7 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"‚ö†Ô∏è Este produto foi descontinuado"})}),e.jsxs("p",{className:"text-sm text-gray-700 mb-3",children:["Descontinuado em"," ",e.jsx("span",{className:"font-semibold",children:new Date(D.data_descontinuacao).toLocaleDateString("pt-BR")})]}),e.jsxs("p",{className:"text-sm text-gray-700 mb-3",children:["Substitu√≠do por:"," ",e.jsxs("button",{type:"button",onClick:()=>f(`/produtos/${D.id}/editar`),className:"font-bold text-red-700 hover:text-red-900 hover:underline",children:[D.codigo," - ",D.nome]})]}),D.motivo_descontinuacao&&e.jsxs("div",{className:"bg-white/70 rounded-md px-3 py-2 text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Motivo:"})," ",e.jsx("span",{className:"text-gray-900",children:D.motivo_descontinuacao})]})]})]})}),e.jsxs("form",{onSubmit:za,children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[_===1&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:s.sku,onChange:a=>l("sku",a.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: PROD0001"}),e.jsx("button",{type:"button",onClick:wa,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm",children:"Gerar"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C√≥digo de Barras"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:s.codigo_barras,onChange:a=>l("codigo_barras",a.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"EAN-13"}),e.jsx("button",{type:"button",onClick:Ca,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm",children:"Gerar"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Produto *"}),e.jsx("input",{type:"text",value:s.nome,onChange:a=>l("nome",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Ra√ß√£o Golden para C√£es Adultos 15kg",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),e.jsxs("select",{value:s.categoria_id,onChange:a=>l("categoria_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),O.map(a=>e.jsx("option",{value:a.id,children:a.nomeFormatado},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Marca"}),e.jsxs("select",{value:s.marca_id,onChange:a=>l("marca_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),re.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento"}),e.jsxs("select",{value:s.departamento_id,onChange:a=>l("departamento_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),te.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsxs("select",{value:s.tipo,onChange:a=>l("tipo",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"produto",children:"Produto"}),e.jsx("option",{value:"servico",children:"Servi√ßo"}),e.jsx("option",{value:"ambos",children:"Produto e Servi√ßo"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unidade"}),e.jsxs("select",{value:s.unidade,onChange:a=>l("unidade",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"UN",children:"UN - Unidade"}),e.jsx("option",{value:"KG",children:"KG - Quilograma"}),e.jsx("option",{value:"G",children:"G - Grama"}),e.jsx("option",{value:"L",children:"L - Litro"}),e.jsx("option",{value:"ML",children:"ML - Mililitro"}),e.jsx("option",{value:"M",children:"M - Metro"}),e.jsx("option",{value:"CX",children:"CX - Caixa"}),e.jsx("option",{value:"PCT",children:"PCT - Pacote"})]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri√ß√£o"}),e.jsx("textarea",{value:s.descricao,onChange:a=>l("descricao",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"2",placeholder:"Descri√ß√£o detalhada do produto..."})]})]}),s.tipo_produto!=="PAI"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre√ßo de Custo"}),e.jsx("input",{type:"text",value:J.preco_custo?s.preco_custo||"":s.preco_custo?`R$ ${S(s.preco_custo).toFixed(2).replace(".",",")}`:"R$ 0,00",onChange:a=>{const r=a.target.value.replace(/[^\d.,]/g,"").replace(",",".");l("preco_custo",r)},onFocus:a=>{F(r=>({...r,preco_custo:!0})),a.target.select()},onBlur:a=>{F(o=>({...o,preco_custo:!1}));const r=S(a.target.value);l("preco_custo",r>0?r.toFixed(2):"")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"R$ 0,00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Markup"}),e.jsx("input",{type:"text",value:J.markup?s.markup||"":s.markup?`${S(s.markup).toFixed(2).replace(".",",")}%`:"0,00%",onChange:a=>{const r=a.target.value.replace(/[^\d.,]/g,"").replace(",",".");l("markup",r)},onFocus:a=>{F(r=>({...r,markup:!0})),a.target.select()},onBlur:a=>{F(o=>({...o,markup:!1}));const r=S(a.target.value);l("markup",r>=0?r.toFixed(2):"")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0,00%"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre√ßo de Venda *"}),e.jsx("input",{type:"text",value:J.preco_venda?s.preco_venda||"":s.preco_venda?`R$ ${S(s.preco_venda).toFixed(2).replace(".",",")}`:"R$ 0,00",onChange:a=>{const r=a.target.value.replace(/[^\d.,]/g,"").replace(",",".");l("preco_venda",r)},onFocus:a=>{F(r=>({...r,preco_venda:!0})),a.target.select()},onBlur:a=>{F(o=>({...o,preco_venda:!1}));const r=S(a.target.value);l("preco_venda",r>0?r.toFixed(2):"")},required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"R$ 0,00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre√ßo Promocional"}),e.jsx("input",{type:"text",value:J.preco_promocional?s.preco_promocional||"":s.preco_promocional?`R$ ${S(s.preco_promocional).toFixed(2).replace(".",",")}`:"R$ 0,00",onChange:a=>{const r=a.target.value.replace(/[^\d.,]/g,"").replace(",",".");l("preco_promocional",r)},onFocus:a=>{F(r=>({...r,preco_promocional:!0})),a.target.select()},onBlur:a=>{F(o=>({...o,preco_promocional:!1}));const r=S(a.target.value);l("preco_promocional",r>0?r.toFixed(2):"")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"R$ 0,00"})]})]}),s.preco_promocional&&s.tipo_produto!=="PAI"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"In√≠cio da Promo√ß√£o"}),e.jsx("input",{type:"date",value:s.data_inicio_promocao,onChange:a=>l("data_inicio_promocao",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fim da Promo√ß√£o"}),e.jsx("input",{type:"date",value:s.data_fim_promocao,onChange:a=>l("data_fim_promocao",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),!c&&e.jsx("div",{className:"border-t pt-6 mt-6",children:e.jsxs("div",{className:"p-6 bg-gradient-to-r from-amber-50 to-orange-50 rounded-lg border border-amber-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Evolu√ß√£o do Produto"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ue,onChange:a=>{xa(a.target.checked),a.target.checked||(pe(null),l("produto_predecessor_id",null),l("motivo_descontinuacao",""))},className:"h-4 w-4 text-amber-600 focus:ring-amber-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Este produto substitui outro"})]})]}),ue&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-white rounded-lg border-2 border-amber-300",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"üîç Buscar Produto Anterior"}),e.jsx("input",{type:"text",placeholder:"Digite o nome ou c√≥digo do produto...",value:ga,onChange:async a=>{if(Pe(a.target.value),a.target.value.length>=2)try{const r=await N.get("/produtos/",{params:{busca:a.target.value,page_size:10}});me(r.data.items||[])}catch(r){console.error("Erro ao buscar produtos:",r)}else me([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),qe.length>0&&e.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto border border-gray-300 rounded-lg",children:qe.map(a=>{var r;return e.jsxs("div",{onClick:()=>{pe(a),l("produto_predecessor_id",a.id),Pe(""),me([])},className:"p-3 hover:bg-amber-50 cursor-pointer border-b border-gray-200 last:border-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.nome}),e.jsxs("div",{className:"text-sm text-gray-600",children:["SKU: ",a.codigo," | Pre√ßo: R$ ",(r=a.preco_venda)==null?void 0:r.toFixed(2)]})]},a.id)})}),$&&e.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-300 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-green-800",children:"‚úÖ Produto Selecionado:"}),e.jsx("div",{className:"font-semibold text-gray-900 mt-1",children:$.nome}),e.jsxs("div",{className:"text-sm text-gray-600",children:["SKU: ",$.codigo]})]}),e.jsx("button",{type:"button",onClick:()=>{pe(null),l("produto_predecessor_id",null)},className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),$&&e.jsxs("div",{className:"p-4 bg-white rounded-lg border-2 border-amber-300",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"üìù Motivo da Substitui√ß√£o"}),e.jsxs("select",{value:s.motivo_descontinuacao,onChange:a=>l("motivo_descontinuacao",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent mb-2",children:[e.jsx("option",{value:"",children:"Selecione o motivo..."}),e.jsx("option",{value:"Mudan√ßa de embalagem",children:"Mudan√ßa de embalagem"}),e.jsx("option",{value:"Mudan√ßa de peso/gramatura",children:"Mudan√ßa de peso/gramatura"}),e.jsx("option",{value:"Reformula√ß√£o do produto",children:"Reformula√ß√£o do produto"}),e.jsx("option",{value:"Mudan√ßa de fornecedor",children:"Mudan√ßa de fornecedor"}),e.jsx("option",{value:"Upgrade de linha",children:"Upgrade de linha"}),e.jsx("option",{value:"Outro",children:"Outro (descrever abaixo)"})]}),s.motivo_descontinuacao==="Outro"&&e.jsx("textarea",{value:s.motivo_descontinuacao,onChange:a=>l("motivo_descontinuacao",a.target.value),placeholder:"Descreva o motivo...",rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent"}),e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded text-sm text-blue-800",children:[e.jsx("strong",{children:"‚ÑπÔ∏è O que acontecer√°:"}),e.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:['O produto "',e.jsx("strong",{children:$.nome}),'" ser√° marcado como ',e.jsx("strong",{children:"descontinuado"})]}),e.jsx("li",{children:"Todo o hist√≥rico de vendas ser√° mantido e poder√° ser consultado"}),e.jsx("li",{children:"Voc√™ poder√° gerar relat√≥rios consolidados somando ambos os produtos"})]})]})]})]}),!ue&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Marque esta op√ß√£o se este produto substitui outro j√° cadastrado (ex: mudan√ßa de embalagem de 350g para 300g). Isso permite manter o hist√≥rico consolidado de vendas."})]})}),!c&&e.jsx("div",{className:"border-t pt-6",children:e.jsxs("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),"Tipo do Produto"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Escolha o tipo de produto que est√° cadastrando:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-white rounded-lg border-2 hover:border-blue-400 transition-colors",style:{borderColor:s.tipo_produto==="SIMPLES"?"#3b82f6":"#e5e7eb"},children:[e.jsx("input",{type:"radio",id:"tipo_simples",name:"tipo_produto",value:"SIMPLES",checked:s.tipo_produto==="SIMPLES",onChange:a=>{l("tipo_produto","SIMPLES"),p(r=>({...r,composicao_kit:[],e_kit_fisico:!1}))},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"tipo_simples",className:"font-medium text-gray-900 cursor-pointer",children:"‚úÖ Produto Simples"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Produto √∫nico, vend√°vel, com controle de estoque pr√≥prio."})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-white rounded-lg border-2 hover:border-blue-400 transition-colors",style:{borderColor:s.tipo_produto==="PAI"?"#3b82f6":"#e5e7eb"},children:[e.jsx("input",{type:"radio",id:"tipo_variacoes",name:"tipo_produto",value:"PAI",checked:s.tipo_produto==="PAI",onChange:a=>{l("tipo_produto","PAI"),p(r=>({...r,preco_custo:"",preco_venda:"",preco_promocional:"",composicao_kit:[],e_kit_fisico:!1}))},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"tipo_variacoes",className:"font-medium text-gray-900 cursor-pointer",children:"üì¶ Produto com Varia√ß√µes"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Produto agrupador (n√£o vend√°vel). Ter√° varia√ß√µes com SKU, pre√ßo e estoque pr√≥prios.",e.jsx("br",{}),e.jsx("span",{className:"text-xs italic",children:"Exemplo: Camiseta (produto pai) ‚Üí P, M, G (varia√ß√µes)"})]}),s.tipo_produto==="PAI"&&!c&&e.jsxs("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800",children:["‚ö†Ô∏è ",e.jsx("strong",{children:"Salve o produto primeiro"}),' para depois cadastrar as varia√ß√µes na aba "Varia√ß√µes".']}),s.tipo_produto==="PAI"&&c&&e.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded text-sm text-green-800",children:'‚úÖ Produto salvo! V√° para a aba "üì¶ Varia√ß√µes" para cadastrar as varia√ß√µes.'})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-white rounded-lg border-2 hover:border-blue-400 transition-colors",style:{borderColor:s.tipo_produto==="KIT"?"#3b82f6":"#e5e7eb"},children:[e.jsx("input",{type:"radio",id:"tipo_kit",name:"tipo_produto",value:"KIT",checked:s.tipo_produto==="KIT",onChange:a=>{l("tipo_produto","KIT"),C(9)},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"tipo_kit",className:"font-medium text-gray-900 cursor-pointer",children:"üß© Produto com Composi√ß√£o (Kit)"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Kit composto por outros produtos existentes.",e.jsx("br",{}),e.jsx("span",{className:"text-xs italic",children:"Exemplo: Kit Banho (shampoo + condicionador + toalha)"})]}),s.tipo_produto==="KIT"&&e.jsxs("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded text-sm text-green-800",children:["‚úÖ ",e.jsx("strong",{children:'Aba "üß© Composi√ß√£o" aberta!'})," V√° para a aba Composi√ß√£o para definir se o kit ter√° estoque virtual ou f√≠sico e adicionar os produtos que o comp√µem."]})]})]})]})]})}),c&&s.tipo_produto==="VARIACAO"&&e.jsx("div",{className:"border-t pt-6",children:e.jsxs("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),"Composi√ß√£o (Kit)"]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-white rounded-lg border-2 border-gray-300",children:[e.jsx("input",{type:"checkbox",id:"variacao_e_kit",checked:!!s.tipo_kit,onChange:a=>{a.target.checked?(l("tipo_kit","VIRTUAL"),l("e_kit_fisico",!1),C(9)):(l("tipo_kit",null),l("composicao_kit",[]),l("e_kit_fisico",!1))},className:"mt-1 h-5 w-5 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"variacao_e_kit",className:"font-medium text-gray-900 cursor-pointer text-lg",children:"üß© Esta varia√ß√£o √© um KIT (possui composi√ß√£o)"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Marque esta op√ß√£o se esta varia√ß√£o √© composta por outros produtos.",e.jsx("br",{}),e.jsx("span",{className:"text-xs italic",children:"Exemplo: Camiseta P - Kit (camiseta + brinde)"})]}),s.tipo_kit&&e.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded text-sm text-green-800",children:["‚úÖ ",e.jsx("strong",{children:"Varia√ß√£o configurada como KIT!"}),' V√° para a aba "üß© Composi√ß√£o" para definir os produtos que comp√µem este kit.']})]})]})]})})]}),_===2&&e.jsx("div",{className:"space-y-6",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Imagens do Produto"}),e.jsxs("label",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer",children:[Re?"Enviando...":"+ Adicionar Imagens",e.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:Ia,disabled:Re,className:"hidden",multiple:!0})]})]}),R.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg mb-2",children:"üì∑ Nenhuma imagem cadastrada"}),e.jsx("p",{className:"text-sm",children:'Clique em "Adicionar Imagem" para enviar fotos do produto'})]}):e.jsx("div",{className:"grid grid-cols-4 gap-4",children:R.map(a=>e.jsxs("div",{className:"relative group border rounded-lg overflow-hidden",children:[e.jsx("img",{src:`/api${a.url}`,alt:"Imagem do produto",className:"w-full h-48 object-cover"}),a.e_principal&&e.jsx("div",{className:"absolute top-2 left-2 px-2 py-1 bg-blue-600 text-white text-xs rounded",children:"Principal"}),e.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition flex items-center justify-center gap-2 opacity-0 group-hover:opacity-100",children:[!a.e_principal&&e.jsx("button",{type:"button",onClick:()=>Fa(a.id),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",title:"Definir como principal",children:"‚≠ê Principal"}),e.jsx("button",{type:"button",onClick:()=>Aa(a.id),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",title:"Excluir",children:"üóëÔ∏è Excluir"})]})]},a.id))}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Dica:"}),' A primeira imagem marcada como "Principal" ser√° exibida na listagem de produtos. Formatos aceitos: JPG, PNG, WebP (m√°x. 5MB).']})})]}):e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Salve o produto primeiro para adicionar imagens"})]})}),_===3&&e.jsx("div",{className:"space-y-6",children:s.tipo_produto==="PAI"?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-blue-300 rounded-lg bg-blue-50",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsx("p",{className:"mt-4 text-lg font-medium text-blue-900",children:"Produto com Varia√ß√µes"}),e.jsxs("p",{className:"mt-2 text-sm text-blue-700",children:["Produtos PAI n√£o possuem estoque pr√≥prio.",e.jsx("br",{}),"O controle de estoque √© feito individualmente nas varia√ß√µes."]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.controle_lote,onChange:a=>l("controle_lote",a.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Controlar Estoque"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estoque M√≠nimo"}),e.jsx("input",{type:"number",step:"0.01",value:s.estoque_minimo,onChange:a=>l("estoque_minimo",a.target.value),disabled:!s.controle_lote,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estoque M√°ximo"}),e.jsx("input",{type:"number",step:"0.01",value:s.estoque_maximo,onChange:a=>l("estoque_maximo",a.target.value),disabled:!s.controle_lote,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",placeholder:"0"})]})]}),c&&s.controle_lote&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Lotes (FIFO)"}),e.jsx("button",{type:"button",onClick:()=>ge(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"+ Nova Entrada"})]}),G.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhum lote cadastrado"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lote"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Qtd Dispon√≠vel"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fabrica√ß√£o"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Validade"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Custo Unit."}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"A√ß√µes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:G.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:a.nome_lote||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold text-gray-900",children:a.quantidade_disponivel}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:oa(a.data_fabricacao)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:oa(a.data_validade)}),e.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:ta(a.custo_unitario)}),e.jsx("td",{className:"px-4 py-3 text-sm text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>Ea(a),className:"text-blue-600 hover:text-blue-800",title:"Editar lote",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{type:"button",onClick:()=>Pa(a),className:"text-red-600 hover:text-red-800",title:"Excluir lote",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},a.id))})]})})]}),!c&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Salve o produto primeiro para gerenciar lotes"})]})}),_===4&&e.jsx("div",{className:"space-y-6",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Fornecedores do Produto"}),e.jsx("button",{type:"button",onClick:La,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"+ Adicionar Fornecedor"})]}),n.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg mb-2",children:"üè≠ Nenhum fornecedor vinculado"}),e.jsx("p",{className:"text-sm",children:'Clique em "Adicionar Fornecedor" para vincular fornecedores a este produto'})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fornecedor"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"C√≥digo"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Pre√ßo Custo"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Prazo (dias)"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Estoque"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Principal"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"A√ß√µes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(a=>e.jsxs("tr",{className:a.ativo?"":"opacity-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.fornecedor_nome}),e.jsx("p",{className:"text-xs text-gray-500",children:a.fornecedor_cpf_cnpj})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:a.codigo_fornecedor||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 text-right",children:a.preco_custo?ta(a.preco_custo):"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 text-center",children:a.prazo_entrega||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 text-center",children:a.estoque_fornecedor||"-"}),e.jsx("td",{className:"px-4 py-3 text-center",children:a.e_principal&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Principal"})}),e.jsxs("td",{className:"px-4 py-3 text-right space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>Ma(a),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"}),e.jsx("button",{type:"button",onClick:()=>Va(a.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Excluir"})]})]},a.id))})]})})]}):e.jsx("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsx("p",{className:"text-gray-600",children:"Salve o produto primeiro para vincular fornecedores"})})}),_===5&&e.jsxs("div",{className:"space-y-6",children:[c&&s.tributacao&&e.jsxs("div",{className:"mb-4 flex gap-2",children:[s.tributacao.origem==="produto_legado"&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-200 text-gray-800",children:"‚ö™ Legado"}),(s.tributacao.origem==="produto_fiscal_v2"||s.tributacao.origem==="kit_fiscal_v2")&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-200 text-yellow-800",children:"üü° Personalizado"}),s.tributacao.herdado_da_empresa&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-200 text-blue-800",children:"üîµ Herdado da empresa"})]}),c&&((Te=s.tributacao)==null?void 0:Te.herdado_da_empresa)===!0&&e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("p",{className:"text-sm text-blue-700",children:"Esta configura√ß√£o fiscal est√° sendo herdada da empresa. Para editar, personalize o fiscal deste produto."}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-yellow-600 hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500",onClick:()=>p(a=>({...a,tributacao:{...a.tributacao,herdado_da_empresa:!1}})),children:"‚úèÔ∏è Personalizar fiscal deste produto"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Origem",e.jsx("span",{className:"tooltip-icon",title:"Define se o produto √© nacional ou importado. Impacta o c√°lculo do ICMS.",children:"üõà"})]}),e.jsxs("select",{value:((ze=s.tributacao)==null?void 0:ze.origem_mercadoria)||"0",onChange:a=>p(r=>({...r,tributacao:{...r.tributacao,origem_mercadoria:a.target.value}})),disabled:((Oe=s.tributacao)==null?void 0:Oe.herdado_da_empresa)===!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"0",children:"0 - Nacional"}),e.jsx("option",{value:"1",children:"1 - Estrangeira (Importa√ß√£o direta)"}),e.jsx("option",{value:"2",children:"2 - Estrangeira (Adquirida no mercado interno)"}),e.jsx("option",{value:"3",children:"3 - Nacional (> 40% conte√∫do importado)"}),e.jsx("option",{value:"4",children:"4 - Nacional (Conforme processo produtivo b√°sico)"}),e.jsx("option",{value:"5",children:"5 - Nacional (< 40% conte√∫do importado)"}),e.jsx("option",{value:"6",children:"6 - Estrangeira (Importa√ß√£o direta sem similar)"}),e.jsx("option",{value:"7",children:"7 - Estrangeira (Mercado interno sem similar)"}),e.jsx("option",{value:"8",children:"8 - Nacional (> 70% conte√∫do importado)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["NCM",e.jsx("span",{className:"tooltip-icon",title:"Nomenclatura Comum do Mercosul. Classifica√ß√£o fiscal do produto, base para impostos.",children:"üõà"})]}),e.jsx("input",{type:"text",value:(($e=s.tributacao)==null?void 0:$e.ncm)||"",onChange:a=>p(r=>({...r,tributacao:{...r.tributacao,ncm:a.target.value}})),disabled:((Be=s.tributacao)==null?void 0:Be.herdado_da_empresa)===!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"00000000"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["CEST",e.jsx("span",{className:"tooltip-icon",title:"C√≥digo Especificador da Substitui√ß√£o Tribut√°ria. Para produtos sujeitos a ICMS ST.",children:"üõà"})]}),e.jsx("input",{type:"text",value:((Ue=s.tributacao)==null?void 0:Ue.cest)||"",onChange:a=>p(r=>({...r,tributacao:{...r.tributacao,cest:a.target.value}})),disabled:((Ge=s.tributacao)==null?void 0:Ge.herdado_da_empresa)===!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"0000000"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["CFOP",e.jsx("span",{className:"tooltip-icon",title:"C√≥digo Fiscal de Opera√ß√µes e Presta√ß√µes. Define a natureza da opera√ß√£o de venda.",children:"üõà"})]}),e.jsx("input",{type:"text",value:((He=s.tributacao)==null?void 0:He.cfop)||"",onChange:a=>p(r=>({...r,tributacao:{...r.tributacao,cfop:a.target.value}})),disabled:((We=s.tributacao)==null?void 0:We.herdado_da_empresa)===!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"0000"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Al√≠quota ICMS (%)",e.jsx("span",{className:"tooltip-icon",title:"Imposto sobre Circula√ß√£o de Mercadorias. Al√≠quota estadual aplicada na venda. Impacta o pre√ßo final.",children:"üõà"})]}),e.jsx("input",{type:"number",step:"0.01",value:((Qe=s.tributacao)==null?void 0:Qe.icms_aliquota)||"",onChange:a=>p(r=>({...r,tributacao:{...r.tributacao,icms_aliquota:a.target.value}})),disabled:((Je=s.tributacao)==null?void 0:Je.herdado_da_empresa)===!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"0,00"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Al√≠quota PIS (%)",e.jsx("span",{className:"tooltip-icon",title:"Programa de Integra√ß√£o Social. Contribui√ß√£o federal sobre a venda. Geralmente 1,65%.",children:"üõà"})]}),e.jsx("input",{type:"number",step:"0.01",value:((Xe=s.tributacao)==null?void 0:Xe.pis_aliquota)||"",onChange:a=>p(r=>({...r,tributacao:{...r.tributacao,pis_aliquota:a.target.value}})),disabled:((Ye=s.tributacao)==null?void 0:Ye.herdado_da_empresa)===!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"0,00"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Al√≠quota COFINS (%)",e.jsx("span",{className:"tooltip-icon",title:"Contribui√ß√£o para Financiamento da Seguridade Social. Contribui√ß√£o federal sobre a venda. Geralmente 7,6%.",children:"üõà"})]}),e.jsx("input",{type:"number",step:"0.01",value:((Ze=s.tributacao)==null?void 0:Ze.cofins_aliquota)||"",onChange:a=>p(r=>({...r,tributacao:{...r.tributacao,cofins_aliquota:a.target.value}})),disabled:((ea=s.tributacao)==null?void 0:ea.herdado_da_empresa)===!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"0,00"})]})]})]}),_===6&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-purple-50 border-l-4 border-purple-500 p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-purple-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-purple-800",children:"Sistema de Recorr√™ncia (Fase 1)"}),e.jsxs("div",{className:"mt-2 text-sm text-purple-700",children:[e.jsx("p",{children:"Configure produtos que precisam ser recomprados periodicamente (vacinas, antipulgas, ra√ß√µes)."}),e.jsx("p",{className:"mt-1",children:"O sistema criar√° lembretes autom√°ticos para notificar clientes 7 dias antes."})]})]})]})}),e.jsxs("div",{className:"flex items-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"tem_recorrencia",checked:s.tem_recorrencia,onChange:a=>l("tem_recorrencia",a.target.checked),className:"h-5 w-5 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),e.jsxs("label",{htmlFor:"tem_recorrencia",className:"ml-3",children:[e.jsx("span",{className:"text-base font-medium text-gray-900",children:"Produto com Recorr√™ncia"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Ativar lembretes autom√°ticos para este produto"})]})]}),s.tem_recorrencia&&e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Recorr√™ncia *"}),e.jsxs("select",{value:s.tipo_recorrencia,onChange:a=>{l("tipo_recorrencia",a.target.value),a.target.value==="daily"?l("intervalo_dias","1"):a.target.value==="weekly"?l("intervalo_dias","7"):a.target.value==="monthly"?l("intervalo_dias","30"):a.target.value==="yearly"&&l("intervalo_dias","365")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"daily",children:"Di√°ria"}),e.jsx("option",{value:"weekly",children:"Semanal (7 dias)"}),e.jsx("option",{value:"monthly",children:"Mensal (30 dias)"}),e.jsx("option",{value:"yearly",children:"Anual (365 dias)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Intervalo (em dias) *"}),e.jsx("input",{type:"number",min:"1",value:s.intervalo_dias,onChange:a=>l("intervalo_dias",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ex: 30 (para Nexgard)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Exemplos: Nexgard = 30, Vacina Anual = 365"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"N√∫mero de Doses (opcional)"}),e.jsx("input",{type:"number",min:"1",value:s.numero_doses,onChange:a=>l("numero_doses",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ex: 3 (para vacina com 3 doses)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"üíâ Se vazio, ser√° recorrente indefinidamente. Se preenchido (ex: 3), o sistema finalizar√° ap√≥s a √∫ltima dose."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Compatibilidade por Esp√©cie"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"especie_compativel",value:"both",checked:s.especie_compativel==="both",onChange:a=>l("especie_compativel",a.target.value),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"üê∂üê± C√£es e Gatos"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"especie_compativel",value:"dog",checked:s.especie_compativel==="dog",onChange:a=>l("especie_compativel",a.target.value),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"üê∂ Apenas C√£es"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"especie_compativel",value:"cat",checked:s.especie_compativel==="cat",onChange:a=>l("especie_compativel",a.target.value),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"üê± Apenas Gatos"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observa√ß√µes / Instru√ß√µes"}),e.jsx("textarea",{value:s.observacoes_recorrencia,onChange:a=>l("observacoes_recorrencia",a.target.value),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ex: Aplicar mensalmente no mesmo dia. N√£o atrasar mais de 5 dias."})]}),s.intervalo_dias&&e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-purple-900 mb-2",children:"üìå Preview do Lembrete"}),e.jsxs("div",{className:"text-sm text-purple-700 space-y-1",children:[e.jsxs("p",{children:["‚úì Cliente ser√° notificado ",e.jsx("strong",{children:"7 dias antes"})," da pr√≥xima dose"]}),e.jsxs("p",{children:["‚úì Intervalo configurado: ",e.jsxs("strong",{children:[s.intervalo_dias," dias"]})]}),e.jsx("p",{children:"‚úì Ap√≥s a compra, um novo lembrete ser√° criado automaticamente"}),s.especie_compativel!=="both"&&e.jsx("p",{className:"mt-2 text-purple-800",children:"‚ö†Ô∏è Sistema validar√° se o pet √© compat√≠vel na hora da venda"})]})]})]})]}),_===7&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-orange-50 border-l-4 border-orange-500 p-4 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-orange-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-orange-800",children:"Calculadora de Ra√ß√£o (Fase 2)"}),e.jsxs("div",{className:"mt-2 text-sm text-orange-700",children:[e.jsx("p",{children:"Configure informa√ß√µes de ra√ß√£o para usar na calculadora de dura√ß√£o e custo."}),e.jsx("p",{className:"mt-1",children:"A IA usar√° esses dados para recomendar ra√ß√µes aos clientes."})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"√â ra√ß√£o?"}),e.jsxs("select",{value:s.classificacao_racao||"nao",onChange:a=>{const r=a.target.value;p(o=>({...o,classificacao_racao:r,linha_racao_id:r==="sim"?o.linha_racao_id:"",porte_animal_id:r==="sim"?o.porte_animal_id:"",fase_publico_id:r==="sim"?o.fase_publico_id:"",tipo_tratamento_id:r==="sim"?o.tipo_tratamento_id:"",sabor_proteina_id:r==="sim"?o.sabor_proteina_id:"",apresentacao_peso_id:r==="sim"?o.apresentacao_peso_id:"",peso_embalagem:r==="sim"?o.peso_embalagem:"",categoria_racao:r==="sim"?o.categoria_racao:""}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"nao",children:"N√£o"}),e.jsx("option",{value:"sim",children:"Sim"})]})]})}),s.classificacao_racao==="sim"&&e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-4",children:"üìã Informa√ß√µes Detalhadas da Ra√ß√£o"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Linha"}),e.jsxs("select",{value:s.linha_racao_id,onChange:a=>l("linha_racao_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),P.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porte do Animal"}),e.jsxs("select",{value:s.porte_animal_id,onChange:a=>l("porte_animal_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),le.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fase/P√∫blico"}),e.jsxs("select",{value:s.fase_publico_id,onChange:a=>{const r=a.target.value,o=je.find(i=>String(i.id)===String(r));p(i=>({...i,fase_publico_id:r,categoria_racao:o?o.nome:""}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),je.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tratamento ",e.jsx("span",{className:"text-gray-400",children:"(Opcional)"})]}),e.jsxs("select",{value:s.tipo_tratamento_id,onChange:a=>l("tipo_tratamento_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Nenhum"}),ca.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sabor/Prote√≠na"}),e.jsxs("select",{value:s.sabor_proteina_id,onChange:a=>l("sabor_proteina_id",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),ua.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apresenta√ß√£o (Peso)"}),e.jsxs("select",{value:s.apresentacao_peso_id,onChange:a=>{const r=a.target.value,o=ye.find(i=>String(i.id)===String(r));p(i=>({...i,apresentacao_peso_id:r,peso_embalagem:o?String(o.peso_kg):i.peso_embalagem}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),ye.map(a=>e.jsxs("option",{value:a.id,children:[a.peso_kg,"kg"]},a.id))]})]})]}),e.jsxs("p",{className:"text-xs text-blue-600 mt-3",children:["üí° ",e.jsx("strong",{children:"Dica:"})," Essas informa√ß√µes ajudam a IA a recomendar a ra√ß√£o ideal para cada pet no PDV. Voc√™ pode gerenciar as op√ß√µes dispon√≠veis em ",e.jsx("strong",{children:"Cadastros > Op√ß√µes de Ra√ß√£o"}),"."]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Esp√©cies Indicadas"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"especies_indicadas",value:"both",checked:s.especies_indicadas==="both",onChange:a=>l("especies_indicadas",a.target.value),className:"h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"üê∂üê± Ambos"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"especies_indicadas",value:"dog",checked:s.especies_indicadas==="dog",onChange:a=>l("especies_indicadas",a.target.value),className:"h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"üê∂ C√£es"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"especies_indicadas",value:"cat",checked:s.especies_indicadas==="cat",onChange:a=>l("especies_indicadas",a.target.value),className:"h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"üê± Gatos"})]})]})]})}),e.jsx("input",{type:"hidden",value:s.tabela_nutricional}),e.jsx("div",{children:e.jsx(us,{value:s.tabela_consumo,onChange:a=>l("tabela_consumo",a),pesoEmbalagem:parseFloat(s.peso_embalagem)||null})}),s.peso_embalagem&&s.classificacao_racao&&e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg border border-orange-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-orange-900 mb-2",children:"üìä Preview da Calculadora"}),e.jsxs("div",{className:"text-sm text-orange-700 space-y-1",children:[e.jsxs("p",{children:["‚úì Peso: ",e.jsxs("strong",{children:[s.peso_embalagem,"kg"]})]}),e.jsxs("p",{children:["‚úì Classifica√ß√£o: ",e.jsx("strong",{children:s.classificacao_racao.replace("_"," ")})]}),s.categoria_racao&&e.jsxs("p",{children:["‚úì Categoria: ",e.jsx("strong",{children:s.categoria_racao})]}),s.tabela_consumo&&e.jsx("p",{className:"text-green-600",children:"‚úì Tabela de consumo configurada"}),!s.tabela_consumo&&e.jsx("p",{className:"text-yellow-600",children:"‚ö†Ô∏è Sem tabela de consumo (usar√° c√°lculo gen√©rico)"}),e.jsx("p",{className:"mt-2 text-orange-800",children:"üí° Use a Calculadora de Ra√ß√£o para ver dura√ß√£o e custo/dia"})]})]})]}),_===8&&s.tipo_produto==="PAI"&&e.jsx("div",{className:"space-y-6",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:["Varia√ß√µes do Produto: ",s.nome]}),e.jsx("p",{className:"text-sm text-blue-700",children:"Cadastre as varia√ß√µes deste produto. Cada varia√ß√£o √© um produto vend√°vel independente com seu pr√≥prio SKU, pre√ßo e estoque."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"text-md font-semibold",children:"Varia√ß√µes Cadastradas"}),e.jsx("button",{type:"button",onClick:()=>ne(!ce),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:ce?"‚ùå Cancelar":"‚ûï Nova Varia√ß√£o"})]}),ce&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4",children:[e.jsx("h5",{className:"font-semibold mb-3",children:"Cadastrar Nova Varia√ß√£o"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU *"}),e.jsx("input",{type:"text",value:x.sku,onChange:a=>I({...x,sku:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Ex: PROD001-P"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Complementar *"}),e.jsx("input",{type:"text",value:x.nome,onChange:a=>I({...x,nome:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Ex: Tamanho P"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C√≥digo de Barras"}),e.jsx("input",{type:"text",value:x.codigo_barras,onChange:a=>I({...x,codigo_barras:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"EAN-13"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre√ßo de Custo"}),e.jsx("input",{type:"number",step:"0.01",value:x.preco_custo,onChange:a=>I({...x,preco_custo:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre√ßo de Venda *"}),e.jsx("input",{type:"number",step:"0.01",value:x.preco_venda,onChange:a=>I({...x,preco_venda:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estoque M√≠nimo"}),e.jsx("input",{type:"number",value:x.estoque_minimo,onChange:a=>I({...x,estoque_minimo:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"0"})]})]}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.e_kit,onChange:a=>I({...x,e_kit:a.target.checked}),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:"üß© Esta varia√ß√£o √© um KIT (possui composi√ß√£o)"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Se marcado, voc√™ poder√° definir a composi√ß√£o do kit ap√≥s salvar a varia√ß√£o."})]})]})}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{ne(!1),I({sku:"",nome:"",codigo_barras:"",preco_custo:"",preco_venda:"",estoque_minimo:0,e_kit:!1,e_kit_fisico:!1,composicao_kit:[]})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"button",onClick:async()=>{var a,r;if(!x.sku||!x.nome||!x.preco_venda){alert("Preencha SKU, Nome e Pre√ßo de Venda");return}try{const o={codigo:x.sku,nome:`${s.nome} - ${x.nome}`,codigo_barras:x.codigo_barras||null,preco_custo:parseFloat(x.preco_custo)||0,preco_venda:parseFloat(x.preco_venda),estoque_minimo:parseInt(x.estoque_minimo)||0,tipo_produto:"VARIACAO",produto_pai_id:parseInt(u),categoria_id:s.categoria_id||null,marca_id:s.marca_id||null,unidade:s.unidade||"UN"};x.e_kit&&(o.tipo_kit="VIRTUAL",o.e_kit_fisico=!1,o.composicao_kit=[]),await ia(o),alert("Varia√ß√£o cadastrada com sucesso!"),ne(!1),I({sku:"",nome:"",codigo_barras:"",preco_custo:"",preco_venda:"",estoque_minimo:0,e_kit:!1,e_kit_fisico:!1,composicao_kit:[]});const i=await _e(u);de(i.data)}catch(o){console.error("Erro ao cadastrar varia√ß√£o:",o),alert(((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao cadastrar varia√ß√£o")}},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Salvar Varia√ß√£o"})]})]}),Ne.length===0?e.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[e.jsx("p",{className:"text-gray-500",children:"Nenhuma varia√ß√£o cadastrada ainda."}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:'Clique em "Nova Varia√ß√£o" para come√ßar.'})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 border border-gray-200 rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SKU"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nome"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"C√≥digo de Barras"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Custo"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Venda"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Estoque"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"A√ß√µes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ne.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:a.codigo}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:a.nome}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:a.codigo_barras||"-"}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:["R$ ",(a.preco_custo||0).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900 font-semibold",children:["R$ ",a.preco_venda.toFixed(2)]}),e.jsx("td",{className:"px-4 py-3 text-sm text-right",children:e.jsx("span",{className:`font-semibold ${a.estoque_atual<=a.estoque_minimo?"text-red-600":"text-green-600"}`,children:a.estoque_atual||0})}),e.jsxs("td",{className:"px-4 py-3 text-center",children:[e.jsx("button",{type:"button",onClick:()=>f(`/produtos/${a.id}/editar`),className:"text-blue-600 hover:text-blue-800 mr-2",title:"Editar",children:"‚úèÔ∏è"}),e.jsx("button",{type:"button",onClick:async()=>{if(confirm(`Deseja excluir a varia√ß√£o ${a.nome}?`))try{await Ya(a.id),alert("Varia√ß√£o exclu√≠da com sucesso!");const r=await _e(u);de(r.data||[])}catch(r){console.error("Erro ao excluir varia√ß√£o:",r),alert("Erro ao excluir varia√ß√£o")}},className:"text-red-600 hover:text-red-800",title:"Excluir",children:"üóëÔ∏è"})]})]},a.id))})]})})]})]}):e.jsxs("div",{className:"text-center py-16 border-2 border-dashed border-yellow-300 rounded-lg bg-yellow-50",children:[e.jsx("svg",{className:"mx-auto h-16 w-16 text-yellow-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("p",{className:"mt-4 text-xl font-semibold text-yellow-900",children:"Aba Bloqueada"}),e.jsx("p",{className:"mt-2 text-sm text-yellow-800",children:"Salve o produto primeiro para habilitar o cadastro de varia√ß√µes."}),e.jsx("p",{className:"mt-4 text-xs text-yellow-700",children:"Ap√≥s salvar, voc√™ ser√° redirecionado automaticamente para cadastrar as varia√ß√µes."})]})}),_===9&&(s.tipo_produto==="KIT"||s.tipo_produto==="VARIACAO"&&s.tipo_kit)&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white border-2 border-gray-300 rounded-lg p-5",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Tipo de Estoque do Kit"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{onClick:()=>l("e_kit_fisico",!1),className:`cursor-pointer p-4 border-2 rounded-lg transition-all ${s.e_kit_fisico?"border-gray-300 bg-white hover:border-blue-300":"border-blue-500 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"radio",name:"tipo_estoque_kit",checked:!s.e_kit_fisico,onChange:()=>l("e_kit_fisico",!1),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üìä"}),e.jsx("h4",{className:"font-semibold text-gray-900",children:"Estoque Virtual"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["O estoque √© calculado ",e.jsx("strong",{children:"automaticamente"})," com base nos componentes dispon√≠veis."]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:[e.jsx("div",{children:"‚úì N√£o permite movimenta√ß√£o manual"}),e.jsx("div",{children:"‚úì Estoque = menor disponibilidade dos componentes"}),e.jsx("div",{children:"‚úì Ideal para kits montados sob demanda"})]})]})]})}),e.jsx("div",{onClick:()=>l("e_kit_fisico",!0),className:`cursor-pointer p-4 border-2 rounded-lg transition-all ${s.e_kit_fisico?"border-green-500 bg-green-50":"border-gray-300 bg-white hover:border-green-300"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"radio",name:"tipo_estoque_kit",checked:s.e_kit_fisico,onChange:()=>l("e_kit_fisico",!0),className:"mt-1 h-4 w-4 text-green-600 focus:ring-green-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"üì¶"}),e.jsx("h4",{className:"font-semibold text-gray-900",children:"Estoque F√≠sico"})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["O kit possui estoque ",e.jsx("strong",{children:"pr√≥prio e independente"})," dos componentes."]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 space-y-1",children:[e.jsx("div",{children:"‚úì Permite movimenta√ß√£o manual"}),e.jsx("div",{children:"‚úì Entrada: diminui componentes (montou kits)"}),e.jsx("div",{children:"‚úì Ideal para kits pr√©-montados"})]})]})]})})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-purple-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Composi√ß√£o do Kit"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Defina quais produtos comp√µem este kit e as quantidades necess√°rias de cada um."}),!s.e_kit_fisico&&e.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded text-sm text-blue-800",children:[e.jsx("strong",{children:"üìä Estoque Virtual Ativo"}),e.jsx("br",{}),"O estoque deste kit ser√° calculado automaticamente baseado nos componentes.",e.jsx("br",{}),e.jsx("span",{className:"text-xs italic",children:"Estoque do kit = menor disponibilidade entre os componentes (considerando as quantidades necess√°rias)"})]}),s.e_kit_fisico&&e.jsxs("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded text-sm text-green-800",children:[e.jsx("strong",{children:"üì¶ Estoque F√≠sico Ativo"}),e.jsx("br",{}),e.jsx("strong",{children:"Entrada no kit:"})," Os componentes ser√£o automaticamente DIMINU√çDOS (unit√°rios viraram kit).",e.jsx("br",{}),e.jsx("strong",{children:"Sa√≠da manual:"})," Voc√™ poder√° escolher se os componentes voltam ao estoque (desfez o kit) ou n√£o (perda/roubo)."]})]})]})}),!s.e_kit_fisico&&s.composicao_kit.length>0&&e.jsx("div",{className:"bg-white border-2 border-green-300 rounded-lg p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Estoque Virtual do Kit"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Calculado automaticamente"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold text-green-600",children:Q}),e.jsx("p",{className:"text-xs text-gray-500",children:"kits dispon√≠veis"})]})]})}),e.jsxs("div",{className:"border border-gray-300 rounded-lg p-5 bg-gray-50",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Adicionar Produto ao Kit"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Produto"}),e.jsxs("select",{value:H,onChange:a=>Ce(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione um produto..."}),ke.map(a=>e.jsxs("option",{value:a.id,children:["[",a.codigo,"] ",a.nome," - Estoque: ",a.estoque_atual||0]},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantidade"}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:W,onChange:a=>Se(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"1"})]})]}),e.jsxs("button",{type:"button",onClick:Ka,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Adicionar ao Kit"]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:["Produtos no Kit (",s.composicao_kit.length,")"]}),s.composicao_kit.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Nenhum produto adicionado ao kit ainda"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SKU"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Produto"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Quantidade"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Estoque"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Kits Poss√≠veis"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"A√ß√µes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.composicao_kit.map((a,r)=>{const o=Math.floor(a.estoque_componente/a.quantidade),i=o===Q&&Q>0;return e.jsxs("tr",{className:`hover:bg-gray-50 ${i?"bg-yellow-50":""}`,children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:a.produto_sku||"-"}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700",children:[a.produto_nome,i&&e.jsx("span",{className:"ml-2 text-xs bg-yellow-200 text-yellow-800 px-2 py-1 rounded",children:"‚ö†Ô∏è LIMITADOR"})]}),e.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-900 font-semibold",children:a.quantidade}),e.jsx("td",{className:"px-4 py-3 text-sm text-center text-gray-600",children:a.estoque_componente||0}),e.jsx("td",{className:"px-4 py-3 text-sm text-center",children:e.jsx("span",{className:`font-semibold ${o===0?"text-red-600":o<5?"text-yellow-600":"text-green-600"}`,children:o})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>Ta(a.produto_id),className:"text-red-600 hover:text-red-800",title:"Remover do kit",children:"üóëÔ∏è"})})]},a.produto_id)})})]})})]}),s.composicao_kit.length>0&&Q===0&&!s.e_kit_fisico&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("div",{className:"text-sm text-red-800",children:[e.jsx("strong",{children:"Kit sem estoque dispon√≠vel!"}),e.jsx("p",{className:"mt-1",children:"Pelo menos um dos componentes est√° sem estoque suficiente para montar o kit."})]})]})})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>f("/produtos"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:Le,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400",children:Le?"Salvando...":c?"Atualizar":"Cadastrar"})]})]}),ba&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Nova Entrada de Estoque"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantidade *"}),e.jsx("input",{type:"number",step:"0.01",value:h.quantidade,onChange:a=>K({...h,quantidade:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex justify-between items-center",children:[e.jsx("span",{children:"N√É¬∫mero do Lote"}),e.jsx("button",{type:"button",onClick:()=>{const a=`LOTE-${new Date().toISOString().split("T")[0].replace(/-/g,"")}-${Math.floor(Math.random()*1e3).toString().padStart(3,"0")}`;K({...h,nome_lote:a})},className:"text-xs text-blue-600 hover:text-blue-800",children:"Gerar Sugest√É¬£o"})]}),e.jsx("input",{type:"text",value:h.nome_lote,onChange:a=>K({...h,nome_lote:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: LOTE-20260105-001 (deixe vazio para gerar automaticamente)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Fabrica√ß√£o"}),e.jsx("input",{type:"date",value:h.data_fabricacao,onChange:a=>K({...h,data_fabricacao:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Validade"}),e.jsx("input",{type:"date",value:h.data_validade,onChange:a=>K({...h,data_validade:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre√ßo de Custo *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",value:h.preco_custo,onChange:a=>K({...h,preco_custo:a.target.value}),className:"w-full pl-12 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0,00"})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>ge(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"button",onClick:Sa,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Registrar Entrada"})]})]})}),ha&&y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Editar Lote"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Lote *"}),e.jsx("input",{type:"text",value:y.nome_lote,onChange:a=>L({...y,nome_lote:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nome do lote"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantidade *"}),e.jsx("input",{type:"number",step:"0.01",value:y.quantidade_inicial,onChange:a=>L({...y,quantidade_inicial:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Fabrica√ß√£o"}),e.jsx("input",{type:"date",value:y.data_fabricacao,onChange:a=>L({...y,data_fabricacao:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Validade"}),e.jsx("input",{type:"date",value:y.data_validade,onChange:a=>L({...y,data_validade:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custo Unit√°rio *"}),e.jsx("input",{type:"number",step:"0.01",value:y.custo_unitario,onChange:a=>L({...y,custo_unitario:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0,00"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{be(!1),L(null)},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"button",onClick:qa,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Salvar Altera√ß√µes"})]})]})}),fa&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:Y?"Editar Fornecedor":"Adicionar Fornecedor"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fornecedor *"}),e.jsxs("select",{value:v.fornecedor_id,onChange:a=>M({...v,fornecedor_id:a.target.value}),disabled:!!Y,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Selecione..."}),j.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"C√≥digo no Fornecedor"}),e.jsx("input",{type:"text",value:v.codigo_fornecedor,onChange:a=>M({...v,codigo_fornecedor:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"SKU-FORNECEDOR-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre√ßo de Custo"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",value:v.preco_custo,onChange:a=>M({...v,preco_custo:a.target.value}),className:"w-full pl-12 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0,00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Prazo de Entrega (dias)"}),e.jsx("input",{type:"number",value:v.prazo_entrega,onChange:a=>M({...v,prazo_entrega:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"7"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estoque no Fornecedor"}),e.jsx("input",{type:"number",step:"0.01",value:v.estoque_fornecedor,onChange:a=>M({...v,estoque_fornecedor:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"100"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:v.e_principal,onChange:a=>M({...v,e_principal:a.target.checked}),className:"w-4 h-4 text-blue-600 rounded"}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Fornecedor Principal"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>X(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"button",onClick:Ra,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Salvar"})]})]})})]})}export{gs as default};
