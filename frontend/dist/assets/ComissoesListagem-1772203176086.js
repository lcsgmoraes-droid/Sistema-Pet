import{r as o,j as e,S as Ye}from"./vendor-react-1772203176086.js";import{a as h}from"./index-1772203176086.js";const Ze=({comissaoId:y,onClose:x})=>{var m,g,C,P,R;const[s,L]=o.useState(null),[S,D]=o.useState(!0),[F,v]=o.useState(null);o.useEffect(()=>{y&&z()},[y]),o.useEffect(()=>{const n=u=>{u.key==="Escape"&&x()};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[x]);const z=async()=>{var n,u;try{D(!0),v(null);const c=await h.get(`/comissoes/comissao/${y}`);c.data.success?L(c.data.comissao):v("Erro ao carregar detalhes da comiss√£o")}catch(c){console.error("Erro ao carregar detalhe:",c),v(((u=(n=c.response)==null?void 0:n.data)==null?void 0:u.detail)||"Erro ao conectar com o servidor")}finally{D(!1)}},E=n=>n?new Date(n).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",l=n=>n==null?"R$ 0,00":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n),b=n=>n==null?"0%":`${n.toFixed(1)}%`,M=n=>{const c={pendente:"bg-yellow-100 text-yellow-800",pago:"bg-green-100 text-green-800",estornado:"bg-red-100 text-red-800"}[n]||"bg-gray-100 text-gray-800";return e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${c}`,children:n.toUpperCase()})},d=({label:n,valor:u,destaque:c=!1})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-1",children:n}),e.jsx("div",{className:`text-sm ${c?"text-lg font-bold text-gray-900":"text-gray-900"}`,children:u})]}),w=({titulo:n,children:u,cor:c="blue"})=>{const p={blue:"border-blue-500 bg-blue-50",green:"border-green-500 bg-green-50",purple:"border-purple-500 bg-purple-50",yellow:"border-yellow-500 bg-yellow-50",red:"border-red-500 bg-red-50"};return e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:`border-l-4 ${p[c]} px-4 py-2 mb-3`,children:e.jsx("h3",{className:"font-semibold text-gray-800",children:n})}),e.jsx("div",{className:"px-4",children:u})]})};return y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity",onClick:x}),e.jsxs("div",{className:"fixed inset-y-0 right-0 w-full md:w-2/3 lg:w-1/2 bg-white shadow-xl z-50 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Detalhes da Comiss√£o"}),e.jsxs("p",{className:"text-sm text-blue-100",children:["Snapshot Imut√°vel #",y]})]}),e.jsx("button",{onClick:x,className:"text-white hover:bg-blue-500 rounded-full p-2 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[S&&e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Carregando detalhes..."})]})}),F&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-red-800 font-semibold mb-2",children:"Erro ao carregar"}),e.jsx("p",{className:"text-red-600",children:F}),e.jsx("button",{onClick:z,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:"Tentar Novamente"})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx(w,{titulo:"üìã Identifica√ß√£o",cor:"blue",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{label:"ID da Comiss√£o",valor:`#${s.id}`}),e.jsx(d,{label:"Venda",valor:s.numero_venda||`#${s.venda_id}`}),e.jsx(d,{label:"ID do Produto",valor:`#${s.produto_id}`}),e.jsx(d,{label:"ID do Funcion√°rio",valor:`#${s.funcionario_id}`}),e.jsx(d,{label:"Data da Venda",valor:E(s.data_venda)}),e.jsx(d,{label:"N√∫mero da Parcela",valor:s.parcela_numero}),e.jsx(d,{label:"Quantidade",valor:s.quantidade})]})}),e.jsxs(w,{titulo:"üí∞ Valores Financeiros (Snapshot)",cor:"green",children:[e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-300 rounded-lg",children:[e.jsxs("h4",{className:"font-semibold text-blue-900 mb-3 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Contexto do Pagamento"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white p-3 rounded border border-blue-200",children:[e.jsx("span",{className:"text-xs text-gray-600 block mb-1",children:"Valor Total da Venda (Produtos)"}),e.jsx("span",{className:"text-lg font-bold text-blue-700",children:l(s.total_venda||0)})]}),e.jsxs("div",{className:"bg-white p-3 rounded border border-green-200",children:[e.jsxs("span",{className:"text-xs text-gray-600 block mb-1",children:["Valor Pago (Parcela ",s.parcela_numero,")"]}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:l(((m=s.pagamento)==null?void 0:m.valor_pago_referencia)||0)}),((g=s.pagamento)==null?void 0:g.forma_pagamento)&&e.jsxs("span",{className:"text-xs text-gray-500 block mt-1",children:["via ",s.pagamento.forma_pagamento]})]})]}),((C=s.pagamento)==null?void 0:C.percentual_pago)<100&&e.jsxs("div",{className:"mt-2 text-xs text-blue-700",children:["‚ÑπÔ∏è Comiss√£o calculada proporcionalmente (",b(s.pagamento.percentual_pago)," do total)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{label:"Valor de Venda",valor:l(s.valores_financeiros.valor_venda)}),e.jsx(d,{label:"Valor de Custo",valor:l(s.valores_financeiros.valor_custo)}),e.jsx(d,{label:"Base Original (Lucro)",valor:l(s.valores_financeiros.valor_base_original)}),e.jsx(d,{label:"Base Comissionada",valor:l(s.valores_financeiros.valor_base_comissionada)})]}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("h4",{className:"font-semibold text-blue-900 mb-3 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Como chegamos na Base de C√°lculo?"]}),e.jsxs("div",{className:"space-y-2 text-sm font-mono bg-white p-4 rounded border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between pb-2 border-b border-gray-200",children:[e.jsxs("span",{className:"text-gray-700 font-semibold",children:["Valor Pago (Parcela ",s.parcela_numero||1,"):"]}),e.jsx("span",{className:"font-bold text-blue-600",children:l(((P=s.pagamento)==null?void 0:P.valor_pago_referencia)||s.valores_financeiros.valor_venda)})]}),s.deducoes&&s.deducoes.receita_taxa_entrega>0&&e.jsxs("div",{className:"flex justify-between text-green-600 pl-4",children:[e.jsx("span",{children:"(+) Taxa de Entrega (Receita):"}),e.jsxs("span",{className:"font-medium",children:["+ ",l(s.deducoes.receita_taxa_entrega)]})]}),s.deducoes&&e.jsxs(e.Fragment,{children:[s.deducoes.taxa_cartao>0&&e.jsxs("div",{className:"flex justify-between text-red-600 pl-4",children:[e.jsxs("span",{children:["(-) ",(()=>{const n=s.deducoes.forma_pagamento||"Cart√£o",u=s.deducoes.numero_parcelas||1;let c=s.deducoes.taxa_percentual;if(u>1&&s.deducoes.taxas_por_parcela)try{c=JSON.parse(s.deducoes.taxas_por_parcela)[u.toString()]||c}catch{}let p="Taxa ";return n.includes("Cr√©dito")?u>1?p+=`Cart√£o Cr√©dito ${u}x`:p+="Cart√£o Cr√©dito √† Vista":n.includes("D√©bito")?p+="Cart√£o D√©bito":p+=n,c&&(p+=` (${c}%)`),p+":"})()]}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.taxa_cartao)]})]}),s.deducoes.imposto>0&&e.jsxs("div",{className:"flex justify-between text-red-600 pl-4",children:[e.jsxs("span",{children:["(-) Impostos (",s.deducoes.percentual_impostos?s.deducoes.percentual_impostos.toFixed(1)+"%":"","):"]}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.imposto)]})]}),s.deducoes.taxa_entregador>0&&e.jsxs("div",{className:"flex justify-between text-red-600 pl-4",children:[e.jsx("span",{children:"(-) Taxa paga ao Entregador:"}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.taxa_entregador)]})]}),s.deducoes.custo_operacional>0&&e.jsxs("div",{className:"flex justify-between text-red-600 pl-4",children:[e.jsx("span",{children:"(-) Custo Operacional de Entrega:"}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.custo_operacional)]})]}),s.deducoes.desconto>0&&e.jsxs("div",{className:"flex justify-between text-red-600 pl-4",children:[e.jsx("span",{children:"(-) Desconto:"}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.desconto)]})]})]}),e.jsxs("div",{className:"border-t-2 border-blue-400 pt-2 mt-2 flex justify-between font-bold",children:[e.jsx("span",{className:"text-blue-900",children:"(=) Base de C√°lculo:"}),e.jsx("span",{className:"text-blue-900 text-lg",children:l(s.calculo.valor_base_calculo)})]})]})]})]}),e.jsxs(w,{titulo:"üßÆ C√°lculo da Comiss√£o",cor:"purple",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{label:"Tipo de C√°lculo",valor:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.calculo.tipo_calculo==="percentual"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:s.calculo.tipo_calculo.toUpperCase()})}),e.jsx(d,{label:"Percentual da Comiss√£o",valor:b(s.calculo.percentual_comissao)}),e.jsx(d,{label:"Percentual Aplicado (Pago)",valor:b(s.calculo.percentual_aplicado)}),e.jsx(d,{label:"Valor Base de C√°lculo",valor:l(s.calculo.valor_base_calculo),destaque:!0}),e.jsx(d,{label:"Valor da Comiss√£o (Total)",valor:l(s.calculo.valor_comissao)}),e.jsx(d,{label:"Valor Efetivamente Gerado",valor:l(s.calculo.valor_comissao_gerada),destaque:!0})]}),e.jsxs("div",{className:"mt-4 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-purple-900 mb-3",children:"üìê F√≥rmula Aplicada:"}),e.jsxs("div",{className:"space-y-2 text-sm font-mono",children:[e.jsxs("div",{className:"bg-white p-3 rounded border border-purple-200",children:[e.jsx("div",{className:"text-gray-700 mb-2",children:"Base de C√°lculo √ó Percentual = Comiss√£o"}),e.jsxs("div",{className:"text-purple-900 font-bold",children:[l(s.calculo.valor_base_calculo)," √ó ",b(s.calculo.percentual_comissao)," = ",l(s.calculo.valor_comissao)]})]}),s.calculo.percentual_aplicado<100&&e.jsxs("div",{className:"bg-yellow-50 p-3 rounded border border-yellow-200",children:[e.jsx("div",{className:"text-gray-700 mb-2",children:"‚ö†Ô∏è Venda parcial - Comiss√£o proporcional ao valor pago:"}),e.jsxs("div",{className:"text-yellow-900 font-bold",children:[l(s.calculo.valor_comissao)," √ó ",b(s.calculo.percentual_aplicado)," = ",l(s.calculo.valor_comissao_gerada)]})]})]})]})]}),e.jsxs(w,{titulo:"üí≥ Controle de Pagamento",cor:"yellow",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{label:"Percentual Pago da Venda",valor:b(s.pagamento.percentual_pago)}),e.jsx(d,{label:"Valor Pago de Refer√™ncia",valor:l(s.pagamento.valor_pago_referencia)}),e.jsx(d,{label:"Valor Pago da Comiss√£o",valor:l(s.pagamento.valor_pago)}),e.jsx(d,{label:"Saldo Restante",valor:l(s.pagamento.saldo_restante)}),s.pagamento.data_pagamento&&e.jsxs(e.Fragment,{children:[e.jsx(d,{label:"Data do Pagamento",valor:E(s.pagamento.data_pagamento)}),e.jsx(d,{label:"Forma de Pagamento",valor:s.pagamento.forma_pagamento||"N√£o informado"})]})]}),s.pagamento.percentual_pago<100&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-yellow-800",children:["‚ö†Ô∏è Esta comiss√£o foi gerada proporcionalmente ao pagamento parcial da venda. Apenas ",b(s.pagamento.percentual_pago)," do valor total foi pago."]})})]}),e.jsxs(w,{titulo:"üìä Status e Controle",cor:s.status.status==="estornado"?"red":"blue",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 uppercase mb-2",children:"Status Atual"}),M(s.status.status)]}),s.status.status==="estornado"&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Informa√ß√µes do Estorno"}),e.jsx(d,{label:"Data do Estorno",valor:E(s.status.data_estorno)}),e.jsx(d,{label:"Motivo do Estorno",valor:s.status.motivo_estorno||"N√£o informado"})]}),s.status.observacao_pagamento&&e.jsxs("div",{className:"mt-4 bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Observa√ß√µes"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.status.observacao_pagamento})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-6 text-white shadow-lg",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[e.jsx("svg",{className:"w-6 h-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Resumo do C√°lculo Completo"]}),e.jsxs("div",{className:"space-y-3 font-mono text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center border-b border-white/20 pb-2",children:[e.jsxs("span",{className:"text-blue-100",children:["Valor Pago (Parcela ",s.parcela_numero||1,"):"]}),e.jsx("span",{className:"font-bold text-lg",children:l(((R=s.pagamento)==null?void 0:R.valor_pago_referencia)||s.valores_financeiros.valor_venda)})]}),s.deducoes&&e.jsxs(e.Fragment,{children:[s.deducoes.taxa_cartao>0&&e.jsxs("div",{className:"flex justify-between items-center pl-4 text-red-200",children:[e.jsxs("span",{children:["(-) ",(()=>{const n=s.deducoes.forma_pagamento||"Cart√£o",u=s.deducoes.numero_parcelas||1;let c=s.deducoes.taxa_percentual;if(u>1&&s.deducoes.taxas_por_parcela)try{c=JSON.parse(s.deducoes.taxas_por_parcela)[u.toString()]||c}catch{}let p="Taxa ";return n.includes("Cr√©dito")?u>1?p+=`Cart√£o Cr√©dito ${u}x`:p+="Cart√£o Cr√©dito √† Vista":n.includes("D√©bito")?p+="Cart√£o D√©bito":p+=n,c&&(p+=` (${c}%)`),p+":"})()]}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.taxa_cartao)]})]}),s.deducoes.imposto>0&&e.jsxs("div",{className:"flex justify-between items-center pl-4 text-red-200",children:[e.jsx("span",{children:"(-) Impostos:"}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.imposto)]})]}),s.deducoes.custo_entrega>0&&e.jsxs("div",{className:"flex justify-between items-center pl-4 text-red-200",children:[e.jsx("span",{children:"(-) Custo de Entrega:"}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.custo_entrega)]})]}),s.deducoes.desconto>0&&e.jsxs("div",{className:"flex justify-between items-center pl-4 text-red-200",children:[e.jsx("span",{children:"(-) Desconto:"}),e.jsxs("span",{className:"font-medium",children:["- ",l(s.deducoes.desconto)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center border-t-2 border-white/40 pt-2",children:[e.jsx("span",{className:"text-blue-100 font-semibold",children:"(=) Base de C√°lculo:"}),e.jsx("span",{className:"font-bold text-lg",children:l(s.calculo.valor_base_calculo)})]}),e.jsxs("div",{className:"flex justify-between items-center border-b border-white/20 pb-2",children:[e.jsx("span",{className:"text-blue-100",children:"(√ó) Percentual:"}),e.jsx("span",{className:"font-bold text-lg",children:b(s.calculo.percentual_comissao)})]}),e.jsxs("div",{className:"flex justify-between items-center bg-white/10 rounded-lg p-3 border-2 border-yellow-300",children:[e.jsx("span",{className:"text-xl font-bold",children:"Comiss√£o Gerada:"}),e.jsx("span",{className:"font-bold text-3xl text-yellow-300",children:l(s.calculo.valor_comissao_gerada)})]})]})]})]})]}),s&&e.jsx("div",{className:"bg-blue-50 border-t border-blue-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-blue-800 mb-1",children:"Snapshot Financeiro Imut√°vel"}),e.jsx("p",{className:"text-xs text-blue-700",children:"Este √© um snapshot financeiro imut√°vel. Os valores refletem exatamente o momento da venda e n√£o podem ser alterados. Qualquer discrep√¢ncia deve ser tratada atrav√©s de ajustes ou estornos, nunca por edi√ß√£o direta."})]})]})})]})]}):null},ta=()=>{const y=Ye(),[x,s]=o.useState([]),[L,S]=o.useState(!0),[D,F]=o.useState(null),[v,z]=o.useState(null),[E,l]=o.useState(!0),[b,M]=o.useState(null),[d,w]=o.useState(null),[m,g]=o.useState({funcionario_id:"",status:"",data_inicio:"",data_fim:"",venda_id:"",produto_id:"",grupo_id:""}),[C,P]=o.useState("ate_hoje"),[R,n]=o.useState([]),[u,c]=o.useState([]),[p,k]=o.useState(null),[G,q]=o.useState(null),[U,H]=o.useState(""),[J,Q]=o.useState(""),[ye,K]=o.useState(!1),[we,X]=o.useState(!1),[_e,ce]=o.useState([]),[Y,Z]=o.useState(null),[me,ue]=o.useState(!1),[ee,ae]=o.useState(""),[se,I]=o.useState(!1),[f,B]=o.useState([]),[Ce,xe]=o.useState(!1),[V,te]=o.useState(""),[A,re]=o.useState(""),[O,pe]=o.useState(!1),[j,oe]=o.useState("sem_pagar"),[le,ge]=o.useState(""),[T,he]=o.useState(""),[be,fe]=o.useState(0),[ea,ke]=o.useState([]),[Se,Fe]=o.useState([]),Pe=1;o.useEffect(()=>{console.log("[ComissoesListagem] Iniciando carregamento..."),(async()=>{try{await W(),await je(),await Le(),await De(),await Ee(),await Me(),await Be()}catch(t){console.error("[ComissoesListagem] Erro no carregamento inicial:",t)}})();const r=new Date().toISOString().split("T")[0];g(t=>({...t,data_fim:r}))},[]),o.useEffect(()=>{const a=r=>{se&&!r.target.closest(".autocomplete-container")&&I(!1)};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[se]);const W=async()=>{var a,r;console.log("[carregarComissoes] Iniciando...");try{S(!0),F(null);const t=new URLSearchParams;m.funcionario_id&&t.append("funcionario_id",m.funcionario_id),m.status&&t.append("status",m.status),m.data_inicio&&t.append("data_inicio",m.data_inicio),m.data_fim&&t.append("data_fim",m.data_fim),m.venda_id&&t.append("venda_id",m.venda_id);const i=t.toString(),$=i?`/comissoes?${i}`:"/comissoes",Ne=await h.get($);Ne.data.success?s(Ne.data.lista):F("Erro ao carregar comiss√µes")}catch(t){console.error("Erro ao carregar comiss√µes:",t),F(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao conectar com o servidor")}finally{S(!1),console.log("[carregarComissoes] Finalizado")}},je=async()=>{var a,r;try{l(!0),M(null);const t=await h.get(`/comissoes/resumo?funcionario_id=${Pe}`);t.data.success?z(t.data.resumo):M("Erro ao carregar resumo")}catch(t){console.error("Erro ao carregar resumo:",t),M(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao carregar resumo")}finally{l(!1)}},Le=async()=>{try{ue(!0);const a=await h.get("/comissoes/funcionarios");if(a.data.success){const r=Array.isArray(a.data.lista)?a.data.lista:Array.isArray(a.data.data)?a.data.data:[];ce(r)}}catch(a){console.error("Erro ao carregar funcion√°rios:",a),ce([])}finally{ue(!1)}},De=async()=>{try{const a=await h.get("/produtos/");a.data&&n(Array.isArray(a.data)?a.data:[])}catch(a){console.error("Erro ao carregar produtos:",a),n([])}},Ee=async()=>{try{const a=await h.get("/categorias-financeiras");a.data&&c(Array.isArray(a.data)?a.data:[])}catch(a){console.error("Erro ao carregar grupos:",a),c([])}},Me=async()=>{console.log("[carregarFormasPagamento] Iniciando...");try{const a=await h.get("/comissoes/formas-pagamento");a.data&&ke(Array.isArray(a.data)?a.data:[])}catch(a){console.error("[carregarFormasPagamento] Erro:",a)}finally{console.log("[carregarFormasPagamento] Finalizado")}},Be=async()=>{try{const a=await h.get("/contas-bancarias");a.data&&Fe(Array.isArray(a.data)?a.data.filter(r=>r.ativa):[])}catch(a){console.error("Erro ao carregar contas banc√°rias:",a)}},Ve=()=>x.filter(r=>r.status==="pendente").reduce((r,t)=>r+(t.valor_comissao_gerada||0),0),ne=()=>x.filter(r=>f.includes(r.id)).reduce((r,t)=>r+(t.valor_comissao_gerada||0),0),Te=a=>a?new Date(a).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",_=a=>a==null?"R$ 0,00":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a),$e=a=>a==null?"0%":`${a.toFixed(1)}%`,ze=a=>{const t={pendente:"bg-yellow-100 text-yellow-800",pago:"bg-green-100 text-green-800",estornado:"bg-red-100 text-red-800"}[a]||"bg-gray-100 text-gray-800";return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:a.toUpperCase()})},Re=a=>{const t={percentual:"bg-blue-100 text-blue-800",lucro:"bg-purple-100 text-purple-800"}[a]||"bg-gray-100 text-gray-800";return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t}`,children:a.toUpperCase()})},Ie=()=>{if(E)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[1,2,3,4].map(r=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-3"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-32"})]},r))});if(b)return e.jsx("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800",children:"‚ö†Ô∏è N√£o foi poss√≠vel carregar o resumo financeiro"})});if(!v)return null;const a=[{titulo:"Total Gerado",valor:v.total_gerado,cor:"blue",bgColor:"bg-blue-50",borderColor:"border-blue-200",textColor:"text-blue-600"},{titulo:"Total Pago",valor:v.total_pago,cor:"green",bgColor:"bg-green-50",borderColor:"border-green-200",textColor:"text-green-600"},{titulo:"Total Pendente",valor:v.total_pendente,cor:"yellow",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",textColor:"text-yellow-600"},{titulo:"Saldo a Pagar",valor:v.saldo_a_pagar,cor:"purple",bgColor:"bg-purple-50",borderColor:"border-purple-200",textColor:"text-purple-600"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:a.map((r,t)=>e.jsxs("div",{className:`${r.bgColor} border ${r.borderColor} rounded-lg shadow-sm p-6 transition hover:shadow-md`,children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:r.titulo}),e.jsx("p",{className:`text-2xl font-bold ${r.textColor}`,children:_(r.valor)})]},t))})},N=a=>{w(a)},Ae=()=>{w(null)},ie=(a,r)=>{g(t=>({...t,[a]:r}))},Oe=()=>{W()},We=()=>{g({funcionario_id:"",status:"",data_inicio:"",data_fim:"",venda_id:"",produto_id:"",grupo_id:""}),Z(null),k(null),q(null),ae(""),H(""),Q(""),P("ate_hoje");const r=new Date().toISOString().split("T")[0];setTimeout(()=>{(async()=>{try{S(!0);const i=await h.get(`/comissoes?data_fim=${r}`);i.data.success&&s(i.data.lista)}catch(i){console.error("Erro:",i)}finally{S(!1)}})()},100)},Ge=a=>{k(a),H(a.nome),K(!1),g(r=>({...r,produto_id:a.id}))},qe=a=>{q(a),Q(a.nome),X(!1),g(r=>({...r,grupo_id:a.id}))},Ue=a=>{Z(a),ae(a.nome),I(!1),g(r=>({...r,funcionario_id:a.id}))},ve=(_e||[]).filter(a=>{var r;return(r=a==null?void 0:a.nome)==null?void 0:r.toLowerCase().includes(ee.toLowerCase())}),He=(a,r)=>{r==="pendente"&&B(t=>t.includes(a)?t.filter(i=>i!==a):[...t,a])},Je=()=>{const a=x.filter(r=>r.status==="pendente");f.length===a.length?B([]):B(a.map(r=>r.id))},Qe=()=>{const a=new Date().toISOString().split("T")[0];te(a),re(""),oe("sem_pagar"),ge(""),he("");const r=ne();fe(r),xe(!0)},de=()=>{xe(!1),te(""),re("")},Ke=async()=>{var a,r;if(!V){alert("Por favor, informe a data de pagamento");return}if(j==="com_pagamento"&&!T){alert("Por favor, selecione a conta banc√°ria para o pagamento");return}try{pe(!0);let t;if(j==="sem_pagar")t=await h.post("/comissoes/fechar",{comissoes_ids:f,data_pagamento:V,observacao:A||null});else{const i=new URLSearchParams({valor_pago:be.toString(),forma_pagamento:le||"nao_informado",data_pagamento:V});T&&i.append("conta_bancaria_id",T),A&&i.append("observacoes",A),f.forEach($=>{i.append("comissoes_ids",$)}),t=await h.post(`/comissoes/fechar-com-pagamento?${i.toString()}`)}if(t.data.success){const i=j==="sem_pagar"?t.data.valor_total_fechamento:t.data.valor_total_pago;alert(`‚úÖ ${t.data.total_processadas} comiss√£o(√µes) fechada(s) com sucesso!

Valor total: ${_(i)}
Modo: ${j==="sem_pagar"?"Sem pagamento (para pagar depois)":"Com pagamento no ato"}`),await W(),await je(),B([]),de()}}catch(t){console.error("Erro ao fechar comiss√µes:",t),alert("‚ùå Erro ao fechar comiss√µes: "+(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.detail)||t.message))}finally{pe(!1)}},Xe=()=>{const a=(R||[]).filter(t=>{var i;return(i=t==null?void 0:t.nome)==null?void 0:i.toLowerCase().includes(U.toLowerCase())}),r=(u||[]).filter(t=>{var i;return(i=t==null?void 0:t.nome)==null?void 0:i.toLowerCase().includes(J.toLowerCase())});return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Filtros"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[x.length," registro",x.length!==1?"s":""," encontrado",x.length!==1?"s":""]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"üìÖ Per√≠odo"}),e.jsxs("div",{className:"flex gap-4 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"ate_hoje",checked:C==="ate_hoje",onChange:t=>{P(t.target.value);const i=new Date().toISOString().split("T")[0];g($=>({...$,data_inicio:"",data_fim:i}))},className:"text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"At√© hoje"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"personalizado",checked:C==="personalizado",onChange:t=>P(t.target.value),className:"text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Per√≠odo personalizado"})]})]}),C==="personalizado"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Data In√≠cio"}),e.jsx("input",{type:"date",value:m.data_inicio,onChange:t=>ie("data_inicio",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Data Fim"}),e.jsx("input",{type:"date",value:m.data_fim,onChange:t=>ie("data_fim",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"relative autocomplete-container",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Funcion√°rio"}),e.jsx("input",{type:"text",value:ee,onChange:t=>{ae(t.target.value),I(!0),t.target.value===""&&(Z(null),g(i=>({...i,funcionario_id:""})))},onFocus:()=>I(!0),disabled:me,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",placeholder:me?"Carregando...":"Digite o nome"}),se&&ee&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:ve.length>0?ve.map(t=>e.jsxs("div",{onClick:()=>Ue(t),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.nome}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",t.id]})]},t.id)):e.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"Nenhum funcion√°rio encontrado"})})]}),e.jsxs("div",{className:"relative autocomplete-container",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Produto"}),e.jsx("input",{type:"text",value:U,onChange:t=>{H(t.target.value),K(!0),t.target.value===""&&(k(null),g(i=>({...i,produto_id:""})))},onFocus:()=>K(!0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Digite o nome do produto"}),ye&&U&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:a.length>0?a.map(t=>e.jsxs("div",{onClick:()=>Ge(t),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.nome}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",t.id]})]},t.id)):e.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"Nenhum produto encontrado"})})]}),e.jsxs("div",{className:"relative autocomplete-container",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grupo/Categoria"}),e.jsx("input",{type:"text",value:J,onChange:t=>{Q(t.target.value),X(!0),t.target.value===""&&(q(null),g(i=>({...i,grupo_id:""})))},onFocus:()=>X(!0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Digite o nome do grupo"}),we&&J&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:r.length>0?r.map(t=>e.jsxs("div",{onClick:()=>qe(t),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.nome}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",t.id]})]},t.id)):e.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"Nenhum grupo encontrado"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:m.status,onChange:t=>ie("status",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"pago",children:"Pago"}),e.jsx("option",{value:"estornado",children:"Estornado"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:Oe,disabled:L,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filtrar"]}),e.jsxs("button",{onClick:We,disabled:L,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition disabled:opacity-50 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Limpar Filtros"]})]})]})};return L?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Carregando comiss√µes..."})]})}):D?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-red-800 font-semibold mb-2",children:"Erro ao carregar comiss√µes"}),e.jsx("p",{className:"text-red-600",children:D}),e.jsx("button",{onClick:W,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:"Tentar Novamente"})]})}):x.length===0?e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Demonstrativo de Comiss√µes"}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-8 text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-blue-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Nenhuma comiss√£o encontrada"}),e.jsx("p",{className:"text-gray-600",children:"Ainda n√£o h√° registros de comiss√µes no sistema."})]})]}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Demonstrativo de Comiss√µes"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Total de registros: ",x.length]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>y("/comissoes/relatorios"),className:"inline-flex items-center px-4 py-2 border border-purple-300 rounded-md shadow-sm text-sm font-medium text-purple-700 bg-purple-50 hover:bg-purple-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"üìä Relat√≥rios"]}),e.jsxs("button",{onClick:()=>y("/comissoes/fechamentos"),className:"inline-flex items-center px-4 py-2 border border-purple-300 rounded-md shadow-sm text-sm font-medium text-purple-700 bg-purple-50 hover:bg-purple-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Ver Hist√≥rico"]})]})]}),Ie(),Xe(),f.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"text-blue-800 font-medium",children:[f.length," comiss√£o(√µes) selecionada(s)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>B([]),className:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Limpar Sele√ß√£o"}),e.jsxs("button",{onClick:Qe,disabled:O,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Fechar Comiss√µes"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:f.length>0&&f.length===x.filter(a=>a.status==="pendente").length,onChange:Je,disabled:x.filter(a=>a.status==="pendente").length===0,className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 cursor-pointer",title:"Selecionar todas pendentes"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data da Venda"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"N√∫mero da Venda"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Parcela"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo de C√°lculo"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Base de C√°lculo"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"% Comiss√£o"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Comiss√£o"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(a=>e.jsxs("tr",{className:"hover:bg-blue-50 transition",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",onClick:r=>r.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:f.includes(a.id),onChange:()=>He(a.id,a.status),disabled:a.status!=="pendente",className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 cursor-pointer disabled:opacity-30 disabled:cursor-not-allowed",title:a.status!=="pendente"?`Comiss√£o ${a.status}`:"Selecionar para fechamento"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 cursor-pointer",onClick:()=>N(a.id),children:Te(a.data_venda)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600 font-medium cursor-pointer",onClick:()=>N(a.id),title:`ID interno: #${a.venda_id}`,children:a.numero_venda||`#${a.venda_id}`}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 cursor-pointer",onClick:()=>N(a.id),children:["#",a.produto_id]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 cursor-pointer",onClick:()=>N(a.id),children:a.parcela_numero}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm cursor-pointer",onClick:()=>N(a.id),children:Re(a.tipo_calculo)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right font-medium cursor-pointer",onClick:()=>N(a.id),children:_(a.valor_base_calculo)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right cursor-pointer",onClick:()=>N(a.id),children:$e(a.percentual_comissao)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right font-bold cursor-pointer",onClick:()=>N(a.id),children:_(a.valor_comissao_gerada)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm cursor-pointer",onClick:()=>N(a.id),children:ze(a.status)})]},a.id))})]})})}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"‚ÑπÔ∏è Informa√ß√£o:"})," Os valores exibidos s√£o snapshots imut√°veis do momento da venda. Eles n√£o s√£o recalculados e refletem exatamente como a comiss√£o foi gerada.",e.jsx("span",{className:"ml-2 text-blue-600 font-medium",children:"Clique em qualquer linha para ver mais detalhes."})]})}),x.length>0&&e.jsx("div",{className:"fixed bottom-0 left-64 right-0 bg-gradient-to-r from-indigo-600 via-blue-600 to-indigo-600 text-white shadow-lg z-40 border-t border-indigo-300/30",children:e.jsx("div",{className:"max-w-7xl mx-auto px-8 py-3.5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-semibold text-indigo-200 mb-0.5 tracking-wide uppercase",children:"üìÖ Per√≠odo"}),e.jsx("div",{className:"text-sm font-bold text-white",children:C==="ate_hoje"?"At√© hoje":e.jsxs(e.Fragment,{children:[m.data_inicio?new Date(m.data_inicio).toLocaleDateString("pt-BR"):"In√≠cio"," ‚Üí ",m.data_fim?new Date(m.data_fim).toLocaleDateString("pt-BR"):"Fim"]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-semibold text-indigo-200 mb-0.5 tracking-wide uppercase",children:"üîç Filtros"}),e.jsxs("div",{className:"text-sm font-bold text-white",children:[Y&&e.jsxs("span",{className:"mr-2 bg-white/10 px-2 py-0.5 rounded",children:["üë§ ",Y.nome]}),p&&e.jsxs("span",{className:"mr-2 bg-white/10 px-2 py-0.5 rounded",children:["üì¶ ",p.nome]}),G&&e.jsxs("span",{className:"mr-2 bg-white/10 px-2 py-0.5 rounded",children:["üìÇ ",G.nome]}),m.status&&e.jsxs("span",{className:"mr-2 bg-white/10 px-2 py-0.5 rounded",children:["‚ö° ",m.status]}),!Y&&!p&&!G&&!m.status&&e.jsx("span",{className:"text-indigo-200",children:"Sem filtros"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-[10px] font-semibold text-indigo-200 mb-0.5 tracking-wide uppercase",children:"üí∞ Total Pendente (Filtrado)"}),e.jsx("div",{className:"text-3xl font-bold text-white drop-shadow-sm",children:_(Ve())}),e.jsxs("div",{className:"text-[11px] text-indigo-100 mt-0.5 font-medium",children:[x.filter(a=>a.status==="pendente").length," comiss√£o(√µes) pendente(s)"]})]})]})})}),x.length>0&&e.jsx("div",{className:"h-24"}),d&&e.jsx(Ze,{comissaoId:d,onClose:Ae}),Ce&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Fechar Comiss√µes Selecionadas"}),e.jsx("button",{onClick:de,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700 font-medium",children:[f.length," comiss√£o(√µes) selecionada(s)"]})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Valor Total"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:_(ne())})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:"‚öôÔ∏è Tipo de Fechamento"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>oe("sem_pagar"),className:`p-4 border-2 rounded-lg transition-all ${j==="sem_pagar"?"border-blue-500 bg-blue-50 shadow-md":"border-gray-300 hover:border-blue-300"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"üìã"}),e.jsx("div",{className:"font-bold text-gray-800",children:"Fechar sem Pagar"}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Apenas registrar fechamento"})]})}),e.jsx("button",{type:"button",onClick:()=>oe("com_pagamento"),className:`p-4 border-2 rounded-lg transition-all ${j==="com_pagamento"?"border-green-500 bg-green-50 shadow-md":"border-gray-300 hover:border-green-300"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl mb-2",children:"üí∞"}),e.jsx("div",{className:"font-bold text-gray-800",children:"Fechar e Pagar"}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Com lan√ßamento financeiro"})]})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["üìÖ Data do Fechamento/Pagamento ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:V,onChange:a=>te(a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),j==="com_pagamento"&&e.jsxs("div",{className:"space-y-4 mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-bold text-green-800 mb-3",children:"üí≥ Dados do Pagamento"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"üíµ Valor a Pagar (edit√°vel)"}),e.jsx("input",{type:"number",step:"0.01",value:be,onChange:a=>fe(parseFloat(a.target.value)),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Valor original: ",_(ne())]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["üí≥ Forma de Pagamento ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:le,onChange:a=>ge(a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Selecione..."}),formasPagamento.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["üè¶ Conta Banc√°ria ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:T,onChange:a=>he(a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Selecione..."}),Se.map(a=>e.jsxs("option",{value:a.id,children:[a.nome," (",a.banco,") - Saldo: ",_(a.saldo||0)]},a.id))]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"üìù Observa√ß√µes"}),e.jsx("textarea",{value:A,onChange:a=>re(a.target.value),rows:3,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Observa√ß√µes sobre o fechamento..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:de,disabled:O,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:Ke,disabled:O||!V||j==="com_pagamento"&&(!le||!T),className:`flex-1 px-4 py-2 rounded-lg transition disabled:opacity-50 flex items-center justify-center gap-2 ${j==="com_pagamento"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"} text-white`,children:O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),j==="com_pagamento"?"üí∞ Fechar e Pagar":"üìã Fechar sem Pagar"]})})]})]})})]})};export{ta as default};
