import{u as ea,p as aa,r as d,j as e}from"./vendor-react-1771892120512.js";import{a as ra}from"./vendor-utils-1771892120512.js";const ia="/api",oa=ia,y=ra.create({baseURL:oa,timeout:15e3,headers:{"Content-Type":"application/json"}});y.interceptors.request.use(i=>{const l=String(i.baseURL||""),g=String(i.url||"");return l.endsWith("/api")&&g.startsWith("/api/")&&(i.url=g.replace(/^\/api/,"")),i});const F="ecommerce_customer_token",De="ecommerce_customer_orders",ce="ecommerce_customer_address",ue="ecommerce_guest_cart",z={pedido_id:null,itens:[],subtotal:0,total:0},Y={cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""};function x(i){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(i||0))}function ne(i){return Number((i==null?void 0:i.preco_venda)??(i==null?void 0:i.preco)??(i==null?void 0:i.preco_promocional)??0)}function sa(){var i;return(i=window==null?void 0:window.crypto)!=null&&i.randomUUID?window.crypto.randomUUID():`checkout-${Date.now()}-${Math.random().toString(16).slice(2)}`}function ta(i){return Array.isArray(i)?i:Array.isArray(i==null?void 0:i.items)?i.items:Array.isArray(i==null?void 0:i.itens)?i.itens:Array.isArray(i==null?void 0:i.produtos)?i.produtos:[]}function de(){try{const i=localStorage.getItem(ue);if(!i)return{...z};const l=JSON.parse(i);if(!Array.isArray(l==null?void 0:l.itens))return{...z};const g=Number((l==null?void 0:l.subtotal)||0),m=Number((l==null?void 0:l.total)||0);return{pedido_id:null,itens:l.itens,subtotal:g,total:m}}catch{return{...z}}}function le(i){const l=i.reduce((g,m)=>g+Number(m.preco_unitario||0)*Number(m.quantidade||0),0);return{pedido_id:null,itens:i,subtotal:l,total:l}}function na(){try{const i=localStorage.getItem(ce);if(!i)return{...Y};const l=JSON.parse(i);return typeof l=="object"&&l!==null?{...Y,...l}:{...Y,endereco:String(i||"")}}catch{const i=localStorage.getItem(ce)||"";return{...Y,endereco:i}}}function da(i){const l=[i.endereco,i.numero].filter(Boolean).join(", "),g=i.bairro?`Bairro: ${i.bairro}`:"",m=[i.cidade,i.estado].filter(Boolean).join("/"),N=i.cep?`CEP: ${i.cep}`:"",B=i.complemento?`Compl.: ${i.complemento}`:"";return[l,g,m,N,B].filter(Boolean).join(" | ")}function H(i){const l=[];return i!=null&&i.imagem_principal&&l.push(i.imagem_principal),Array.isArray(i==null?void 0:i.imagens)&&i.imagens.forEach(g=>{typeof g=="string"&&g.trim()?l.push(g.trim()):g!=null&&g.url&&typeof g.url=="string"&&l.push(g.url.trim())}),Array.from(new Set(l.filter(Boolean)))}function la(i){const l=String(i||"");return l?l.includes("??")||l.includes("�")||/\?{2,}/.test(l):!1}function ca(i){return String(i||"").split("-").filter(Boolean).map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")}function pa(){var Ne,Ie,Le,Fe,Be;const i=ea(),l=aa(),[g,m]=d.useState("loja"),[N,B]=d.useState(!1),[D,V]=d.useState([]),[U,Ue]=d.useState(""),[P,Pe]=d.useState("todas"),[h,Q]=d.useState(null),[ge,M]=d.useState(!1),[pe,he]=d.useState(!1),[Me,me]=d.useState(!1),[f,O]=d.useState(localStorage.getItem(F)||""),[q,X]=d.useState(null),[W,$]=d.useState({email:"",password:"",nome:""}),[Z,ee]=d.useState({email:"",password:""}),[p,S]=d.useState(()=>de()),[ae,fe]=d.useState(""),[_,re]=d.useState(null),[E,ye]=d.useState(""),[T,xe]=d.useState("entrega"),[b,R]=d.useState(()=>na()),[v,G]=d.useState(null),[J,ie]=d.useState(null),[oe,be]=d.useState(""),[I,Oe]=d.useState(()=>{try{return JSON.parse(localStorage.getItem(De)||"[]")}catch{return[]}}),[je,ve]=d.useState({}),[Se,c]=d.useState(""),[_e,j]=d.useState(""),[o,se]=d.useState(null),C=d.useMemo(()=>new URLSearchParams(i.search).get("tenant")||l.tenantId||"",[i.search,l.tenantId]),ke=d.useMemo(()=>o!=null&&o.id?{"X-Tenant-ID":o.id}:{},[o==null?void 0:o.id]),k=d.useMemo(()=>f?{Authorization:`Bearer ${f}`}:{},[f]),qe=d.useMemo(()=>{const a=D.map(r=>(r==null?void 0:r.categoria_nome)||(r==null?void 0:r.categoria)||"Sem categoria").filter(Boolean);return["todas",...Array.from(new Set(a))]},[D]),we=d.useMemo(()=>{const a=U.trim().toLowerCase();return D.filter(r=>{const s=String((r==null?void 0:r.nome)||"").toLowerCase(),n=(r==null?void 0:r.categoria_nome)||(r==null?void 0:r.categoria)||"Sem categoria";return(!a||s.includes(a))&&(P==="todas"||n===P)})},[D,U,P]),K=(o==null?void 0:o.ecommerce_slug)||C||"",We=d.useMemo(()=>{const a=(o==null?void 0:o.name)||"";return a&&!la(a)?a:K?ca(K):"Loja online"},[o==null?void 0:o.name,K]);d.useEffect(()=>{if(!C){V([]),se(null),c("Loja não informada na URL. Use /slug-da-loja.");return}$e(),Re()},[C]),d.useEffect(()=>{f&&(Ge(),Ce())},[f]),d.useEffect(()=>{o!=null&&o.cidade&&!E&&ye(o.cidade)},[o==null?void 0:o.cidade,E]),d.useEffect(()=>{f||localStorage.setItem(ue,JSON.stringify(p||z))},[p,f]);async function $e(){var a,r;try{const s=await y.get("/api/ecommerce/tenant-context",{params:{tenant:C}});se((s==null?void 0:s.data)||null)}catch(s){se(null),c(((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.detail)||"Loja inválida para e-commerce")}}async function Re(){var a,r;if(C){B(!0),c("");try{const s=await y.get("/api/ecommerce/produtos",{params:{tenant:C,limit:100,busca:U||void 0}});V(ta(s==null?void 0:s.data))}catch(s){V([]),c(((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao carregar produtos vendáveis")}finally{B(!1)}}}async function Ge(){if(f)try{const a=await y.get("/api/ecommerce/auth/me",{headers:k});X(a.data)}catch{X(null),O(""),localStorage.removeItem(F),S(de())}}async function Ce(a=k){var r,s;if(a!=null&&a.Authorization){me(!0);try{const n=await y.get("/api/carrinho",{headers:a});S(n.data||{...z})}catch(n){c(((s=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:s.detail)||"Erro ao carregar carrinho")}finally{me(!1)}}}async function Ae(a){var n;const r=de();if(!((n=r==null?void 0:r.itens)!=null&&n.length))return;const s={Authorization:`Bearer ${a}`};for(const t of r.itens)await y.post("/api/carrinho/adicionar",{produto_id:t.produto_id,quantidade:t.quantidade},{headers:s});await Ce(s),localStorage.removeItem(ue)}async function Je(a){var r,s,n;if(a.preventDefault(),!(o!=null&&o.id)){c("Loja não identificada na URL.");return}M(!0),c(""),j("");try{const t=await y.post("/api/ecommerce/auth/registrar",W,{headers:ke}),u=(r=t==null?void 0:t.data)==null?void 0:r.access_token;if(!u)throw new Error("Token não retornado");localStorage.setItem(F,u),O(u),await Ae(u),$({email:"",password:"",nome:""}),j("Cadastro realizado com sucesso."),m("loja")}catch(t){c(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.detail)||"Erro ao cadastrar cliente")}finally{M(!1)}}async function Ke(a){var r,s,n;if(a.preventDefault(),!(o!=null&&o.id)){c("Loja não identificada na URL.");return}M(!0),c(""),j("");try{const t=await y.post("/api/ecommerce/auth/login",Z,{headers:ke}),u=(r=t==null?void 0:t.data)==null?void 0:r.access_token;if(!u)throw new Error("Token não retornado");localStorage.setItem(F,u),O(u),await Ae(u),ee({email:"",password:""}),j("Login realizado com sucesso."),m("loja")}catch(t){c(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.detail)||"Erro ao realizar login")}finally{M(!1)}}function Ye(){X(null),O(""),S({...z}),G(null),ie(null),localStorage.removeItem(F),j("Sessão encerrada.")}async function Ee(a){var r,s;if(!f){c("");const n=ne(a);S(t=>{const u=Array.isArray(t==null?void 0:t.itens)?t.itens:[],A=u.find(w=>w.produto_id===a.id)?u.map(w=>w.produto_id===a.id?{...w,quantidade:Number(w.quantidade||0)+1}:w):[...u,{item_id:`guest-${a.id}`,produto_id:a.id,nome:a.nome,preco_unitario:n,quantidade:1}];return le(A)}),j("Produto adicionado ao carrinho. Faça login no checkout para finalizar.");return}c("");try{const n=await y.post("/api/carrinho/adicionar",{produto_id:a.id,quantidade:1},{headers:k});S(n.data),j("Produto adicionado ao carrinho.")}catch(n){c(((s=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:s.detail)||"Erro ao adicionar no carrinho")}}async function te(a,r){var s,n;if(!f){S(t=>{const u=Array.isArray(t==null?void 0:t.itens)?t.itens:[];if(r<=0){const A=u.filter(w=>w.item_id!==a);return le(A)}const L=u.map(A=>A.item_id===a?{...A,quantidade:r}:A);return le(L)});return}c("");try{if(r<=0){const u=await y.delete(`/api/carrinho/remover/${a}`,{headers:k});S(u.data);return}const t=await y.put(`/api/carrinho/atualizar/${a}`,{quantidade:r},{headers:k});S(t.data)}catch(t){c(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.detail)||"Erro ao atualizar carrinho")}}async function He(a){var r,s;if(a.preventDefault(),!f){c("Faça login para aplicar cupom."),m("conta");return}if(ae.trim()){c("");try{const n=await y.post("/api/carrinho/aplicar-cupom",{codigo:ae.trim()},{headers:k});re(n.data),j("Cupom validado.")}catch(n){re(null),c(((s=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:s.detail)||"Cupom inválido")}}}async function Ve(a){var s,n,t;if(a.preventDefault(),!f){c("Faça login para continuar no checkout."),m("conta");return}if(!((s=p==null?void 0:p.itens)!=null&&s.length)){c("Adicione itens no carrinho antes de calcular o checkout.");return}const r=((o==null?void 0:o.cidade)||E||b.cidade||"").trim();if(!r||r.length<2){c("Cidade da loja não configurada para checkout.");return}c(""),G(null);try{const u=await y.get("/api/checkout/resumo",{headers:k,params:{cidade_destino:r,cupom:(_==null?void 0:_.codigo)||void 0}});G(u.data),j("Resumo de checkout calculado.")}catch(u){c(((t=(n=u==null?void 0:u.response)==null?void 0:n.data)==null?void 0:t.detail)||"Erro ao calcular resumo do checkout")}}async function Qe(){var s,n;if(!f){c("Faça login para finalizar o pedido."),m("conta");return}const a=((o==null?void 0:o.cidade)||E||b.cidade||"").trim();if(!a||a.length<2){c("Cidade da loja não configurada para checkout.");return}const r=T==="retirada"?"RETIRADA NA LOJA":da(b);if(T==="entrega"&&!r){c("Informe o endereço de entrega.");return}he(!0),c(""),j(""),ie(null);try{const u=(await y.post("/api/checkout/finalizar",{cidade_destino:a,endereco_entrega:r||null,cupom:(_==null?void 0:_.codigo)||null},{headers:{...k,"Idempotency-Key":sa()}})).data;if(ie(u),S({pedido_id:null,itens:[],subtotal:0,total:0}),G(null),re(null),fe(""),T==="entrega"&&localStorage.setItem(ce,JSON.stringify(b)),u!=null&&u.pedido_id){const L=Array.from(new Set([u.pedido_id,...I]));Oe(L),localStorage.setItem(De,JSON.stringify(L))}j("Pedido finalizado com sucesso."),m("pedidos")}catch(t){c(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.detail)||"Erro ao finalizar checkout")}finally{he(!1)}}async function Te(a){if(!(!f||!a))try{const r=await y.get(`/api/checkout/pedido/${a}/status`,{headers:k});ve(s=>({...s,[a]:r.data}))}catch(r){ve(s=>{var n,t;return{...s,[a]:{status:"erro",detail:((t=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:t.detail)||"Erro ao consultar pedido"}}})}}d.useEffect(()=>{!f||g!=="pedidos"||I.slice(0,10).forEach(a=>{je[a]||Te(a)})},[g,f,I]);const ze=Number((p==null?void 0:p.total)||0);function Xe(){var a;if(!((a=p==null?void 0:p.itens)!=null&&a.length)){c("Adicione itens no carrinho antes de finalizar.");return}if(!f){c("Faça login para finalizar o pedido."),m("conta");return}m("checkout")}function Ze(a){const r=H(a);Q(a),be(r[0]||"")}return e.jsxs("div",{className:"page",children:[e.jsx("div",{style:{background:"linear-gradient(120deg, #1e293b 0%, #0f172a 100%)",color:"#fff",borderRadius:16,padding:18,marginBottom:16,border:"1px solid #1f2937"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,opacity:.8,letterSpacing:.4},children:"LOJA ONLINE"}),e.jsx("h1",{style:{margin:"4px 0 6px",fontSize:28,lineHeight:1.1},children:We}),e.jsxs("div",{style:{fontSize:13,opacity:.88},children:[(o==null?void 0:o.cidade)||"Cidade não informada",o!=null&&o.uf?` • ${o.uf}`:""]})]}),e.jsxs("div",{style:{display:"grid",gap:6,justifyItems:"end"},children:[e.jsx("div",{style:{fontSize:12,opacity:.78},children:"Identificador da loja"}),e.jsx("div",{style:{fontWeight:700,background:"rgba(148,163,184,0.2)",padding:"6px 10px",borderRadius:999},children:K||"-"})]})]})}),(o==null?void 0:o.storefront_path)&&e.jsxs("div",{style:{marginBottom:12,color:"#4b5563",fontSize:13},children:["URL da loja: ",o.storefront_path]}),!C&&e.jsx("div",{style:{marginBottom:12,color:"#b00020"},children:"Use a URL no formato: /slug-da-loja"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:16,background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:8},children:[["loja","Loja"],["carrinho","Carrinho"],["checkout","Checkout"],["pedidos","Meus pedidos"],["conta","Conta"]].map(([a,r])=>{const s=g===a;return e.jsx("button",{onClick:()=>m(a),style:{border:s?"1px solid #6366f1":"1px solid transparent",background:s?"#eef2ff":"transparent",color:s?"#4338ca":"#334155",borderRadius:10,padding:"9px 14px",fontWeight:s?700:600,cursor:"pointer"},children:r},a)})}),Se&&e.jsx("div",{style:{background:"#ffe8e8",color:"#8c0000",padding:10,borderRadius:6,marginBottom:12},children:Se}),_e&&e.jsx("div",{style:{background:"#e8fff0",color:"#0a7d32",padding:10,borderRadius:6,marginBottom:12},children:_e}),g==="loja"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr) 320px",gap:16},children:[e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:12,border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("h2",{style:{fontSize:20,marginBottom:4},children:"Catálogo da loja"}),e.jsx("div",{style:{color:"#64748b",fontSize:14},children:"Selecione produtos, confira detalhes e adicione ao carrinho."})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:14,flexWrap:"wrap"},children:[e.jsx("input",{value:U,onChange:a=>Ue(a.target.value),placeholder:"Buscar produto...",style:{flex:1,minWidth:240,padding:10,border:"1px solid #d1d5db",borderRadius:10}}),e.jsx("select",{value:P,onChange:a=>Pe(a.target.value),style:{padding:10,border:"1px solid #d1d5db",borderRadius:10},children:qe.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx("button",{className:"btn-secondary",onClick:Re,disabled:N,children:N?"Carregando...":"Atualizar"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:12},children:[we.map(a=>e.jsxs("button",{type:"button",onClick:()=>Ze(a),style:{border:"1px solid #e5e7eb",borderRadius:12,padding:10,background:"#fff",textAlign:"left",cursor:"pointer",display:"grid",gap:8},children:[e.jsx("div",{style:{borderRadius:10,background:"#f1f5f9",height:140,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:a!=null&&a.imagem_principal?e.jsx("img",{src:a.imagem_principal,alt:a.nome,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:"#64748b",fontSize:12},children:"Sem imagem"})}),e.jsxs("div",{style:{minHeight:42},children:[e.jsx("div",{style:{fontSize:14,fontWeight:700,lineHeight:1.25},children:a.nome}),e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:4},children:(a==null?void 0:a.categoria_nome)||(a==null?void 0:a.categoria)||"Sem categoria"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("strong",{style:{fontSize:16},children:x(ne(a))}),e.jsx("button",{className:"btn-primary",onClick:r=>{r.stopPropagation(),Ee(a)},children:"Adicionar"})]})]},a.id)),!N&&we.length===0&&e.jsx("div",{style:{color:"#666",padding:12,display:"grid",gap:10},children:e.jsx("div",{children:"Nenhum produto encontrado para o filtro atual."})})]})]}),e.jsxs("aside",{style:{background:"#fff",padding:16,borderRadius:12,border:"1px solid #e5e7eb",alignSelf:"start",position:"sticky",top:8},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:10},children:"Seu carrinho"}),(Ne=p==null?void 0:p.itens)!=null&&Ne.length?e.jsxs("div",{style:{display:"grid",gap:8},children:[p.itens.slice(0,6).map(a=>e.jsxs("div",{style:{borderBottom:"1px solid #f1f5f9",paddingBottom:6,marginBottom:4},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:a.nome}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:[a.quantidade," x ",x(a.preco_unitario)]})]},a.item_id)),p.itens.length>6&&e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["+ ",p.itens.length-6," item(ns)"]}),e.jsxs("div",{style:{marginTop:4,fontWeight:700,fontSize:16},children:["Subtotal: ",x(ze)]}),e.jsx("button",{className:"btn-primary",onClick:Xe,children:"Finalizar"}),e.jsx("button",{className:"btn-secondary",onClick:()=>m("carrinho"),children:"Editar carrinho"}),!f&&e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Login/cadastro só será solicitado no fechamento."})]}):e.jsx("div",{style:{color:"#666"},children:"Seu carrinho está vazio."})]})]}),h&&e.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:60},onClick:()=>Q(null),children:e.jsxs("div",{style:{background:"#fff",width:"min(980px, 100%)",maxHeight:"90vh",overflowY:"auto",borderRadius:14,border:"1px solid #e5e7eb",padding:16,display:"grid",gridTemplateColumns:"1.1fr 1fr",gap:16},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{children:[e.jsx("div",{style:{borderRadius:12,background:"#f1f5f9",minHeight:260,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:oe?e.jsx("img",{src:oe,alt:h.nome,style:{width:"100%",height:360,objectFit:"cover"}}):e.jsx("span",{style:{color:"#64748b"},children:"Sem imagem disponível"})}),H(h).length>1&&e.jsx("div",{style:{display:"flex",gap:8,marginTop:10,overflowX:"auto"},children:H(h).map(a=>e.jsx("button",{onClick:()=>be(a),style:{border:oe===a?"2px solid #6366f1":"1px solid #d1d5db",borderRadius:8,width:74,height:74,overflow:"hidden",padding:0,background:"#fff",cursor:"pointer"},children:e.jsx("img",{src:a,alt:"Miniatura do produto",style:{width:"100%",height:"100%",objectFit:"cover"}})},a))})]}),e.jsxs("div",{style:{display:"grid",alignContent:"start",gap:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:8},children:[e.jsx("h3",{style:{margin:0,fontSize:24,lineHeight:1.2},children:h.nome}),e.jsx("button",{className:"btn-secondary",onClick:()=>Q(null),children:"Fechar"})]}),e.jsx("div",{style:{fontSize:24,fontWeight:800,color:"#0f172a"},children:x(ne(h))}),e.jsxs("div",{style:{color:"#475569"},children:["Categoria: ",e.jsx("strong",{children:(h==null?void 0:h.categoria_nome)||(h==null?void 0:h.categoria)||"Sem categoria"})]}),e.jsxs("div",{style:{color:"#475569"},children:["Estoque disponível: ",e.jsx("strong",{children:(h==null?void 0:h.estoque_ecommerce)??0})]}),e.jsxs("div",{style:{color:"#475569"},children:["Código: ",e.jsx("strong",{children:(h==null?void 0:h.codigo)||"-"})]}),H(h).length<=1&&e.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Este produto ainda não possui galeria com múltiplas fotos cadastradas."}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn-primary",onClick:()=>Ee(h),children:"Adicionar ao carrinho"}),e.jsx("button",{className:"btn-secondary",onClick:()=>m("carrinho"),children:"Ver carrinho"})]})]})]})}),g==="carrinho"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Carrinho"}),Me?e.jsx("div",{children:"Carregando carrinho..."}):(Ie=p==null?void 0:p.itens)!=null&&Ie.length?e.jsxs("div",{style:{display:"grid",gap:8},children:[p.itens.map(a=>e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:6,padding:8},children:[e.jsx("div",{style:{fontWeight:600},children:a.nome}),e.jsx("div",{style:{fontSize:12,color:"#666"},children:x(a.preco_unitario)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:6},children:[e.jsx("button",{className:"btn-secondary",onClick:()=>te(a.item_id,a.quantidade-1),children:"-"}),e.jsx("span",{children:a.quantidade}),e.jsx("button",{className:"btn-secondary",onClick:()=>te(a.item_id,a.quantidade+1),children:"+"}),e.jsx("button",{className:"btn-secondary",onClick:()=>te(a.item_id,0),children:"Remover"})]})]},a.item_id)),e.jsxs("div",{style:{marginTop:8,fontWeight:700},children:["Total: ",x(ze)]})]}):e.jsx("div",{style:{color:"#666"},children:"Carrinho vazio"}),e.jsxs("form",{onSubmit:He,style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("input",{value:ae,onChange:a=>fe(a.target.value),placeholder:"Cupom",style:{flex:1,padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-secondary",type:"submit",children:"Aplicar"})]}),_&&e.jsxs("div",{style:{marginTop:8,color:"#0a7d32"},children:["Cupom ",_.codigo,": -",x(_.desconto)]})]}),g==="checkout"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"grid",gap:10},children:[e.jsx("h3",{style:{marginTop:0},children:"Checkout"}),e.jsxs("form",{onSubmit:Ve,style:{display:"grid",gap:8},children:[e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Forma de recebimento"}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"radio",name:"deliveryMode",value:"entrega",checked:T==="entrega",onChange:()=>xe("entrega")}),"Entrega"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"radio",name:"deliveryMode",value:"retirada",checked:T==="retirada",onChange:()=>xe("retirada")}),"Retirada na loja"]})]})]}),e.jsx("input",{value:(o==null?void 0:o.cidade)||E,onChange:a=>ye(a.target.value),placeholder:"Cidade da loja",disabled:!!(o!=null&&o.cidade),style:{padding:8,border:"1px solid #ddd",borderRadius:6,background:o!=null&&o.cidade?"#f8fafc":"#fff"}}),T==="entrega"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{value:b.cep,onChange:a=>R(r=>({...r,cep:a.target.value})),placeholder:"CEP",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:b.endereco,onChange:a=>R(r=>({...r,endereco:a.target.value})),placeholder:"Rua / Avenida",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsx("input",{value:b.numero,onChange:a=>R(r=>({...r,numero:a.target.value})),placeholder:"Número",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:b.complemento,onChange:a=>R(r=>({...r,complemento:a.target.value})),placeholder:"Complemento",style:{padding:8,border:"1px solid #ddd",borderRadius:6}})]}),e.jsx("input",{value:b.bairro,onChange:a=>R(r=>({...r,bairro:a.target.value})),placeholder:"Bairro",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px",gap:8},children:[e.jsx("input",{value:b.cidade||(o==null?void 0:o.cidade)||"",onChange:a=>R(r=>({...r,cidade:a.target.value})),placeholder:"Cidade",disabled:!!(o!=null&&o.cidade),style:{padding:8,border:"1px solid #ddd",borderRadius:6,background:o!=null&&o.cidade?"#f8fafc":"#fff"}}),e.jsx("input",{value:b.estado||(o==null?void 0:o.uf)||"",onChange:a=>R(r=>({...r,estado:a.target.value})),placeholder:"UF",style:{padding:8,border:"1px solid #ddd",borderRadius:6}})]})]}),e.jsx("button",{className:"btn-secondary",type:"submit",children:"Calcular resumo"})]}),v&&e.jsxs("div",{style:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:10},children:[e.jsxs("div",{children:["Itens: ",v.itens_count]}),e.jsxs("div",{children:["Subtotal: ",x(v.subtotal)]}),e.jsxs("div",{children:["Frete: ",x((Le=v==null?void 0:v.frete)==null?void 0:Le.valor_frete)]}),e.jsxs("div",{children:["Desconto: ",x((Fe=v==null?void 0:v.cupom)==null?void 0:Fe.desconto)]}),e.jsxs("div",{style:{fontWeight:700},children:["Total: ",x(v.total)]})]}),e.jsx("button",{className:"btn-primary",onClick:Qe,disabled:pe||!(o!=null&&o.cidade||E)||!((Be=p==null?void 0:p.itens)!=null&&Be.length),children:pe?"Finalizando...":"Finalizar pedido"}),(J==null?void 0:J.pedido_id)&&e.jsxs("div",{style:{background:"#e8fff0",color:"#0a7d32",padding:10,borderRadius:6},children:["Pedido confirmado: ",e.jsx("strong",{children:J.pedido_id})]})]}),g==="pedidos"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Meus pedidos"}),I.length===0?e.jsx("div",{style:{color:"#666"},children:"Nenhum pedido registrado nesta sessão."}):e.jsx("div",{style:{display:"grid",gap:8},children:I.map(a=>{const r=je[a];return e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:6,padding:10},children:[e.jsx("div",{children:e.jsx("strong",{children:a})}),e.jsxs("div",{children:["Status: ",(r==null?void 0:r.status)||"não consultado"]}),e.jsxs("div",{children:["Total: ",(r==null?void 0:r.total)!=null?x(r.total):"-"]}),e.jsx("button",{className:"btn-secondary",onClick:()=>Te(a),style:{marginTop:6},children:"Atualizar status"})]},a)})})]}),g==="conta"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Cadastro"}),e.jsxs("form",{onSubmit:Je,autoComplete:"off",style:{display:"grid",gap:8},children:[e.jsx("input",{name:"ecommerce_register_nome",autoComplete:"off",value:W.nome,onChange:a=>$(r=>({...r,nome:a.target.value})),placeholder:"Nome",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{name:"ecommerce_register_email",autoComplete:"off",value:W.email,onChange:a=>$(r=>({...r,email:a.target.value})),placeholder:"Email",type:"email",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{name:"ecommerce_register_password",autoComplete:"new-password",value:W.password,onChange:a=>$(r=>({...r,password:a.target.value})),placeholder:"Senha",type:"password",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-primary",type:"submit",disabled:ge,children:"Cadastrar"})]})]}),e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Login"}),e.jsxs("form",{onSubmit:Ke,autoComplete:"off",style:{display:"grid",gap:8},children:[e.jsx("input",{name:"ecommerce_login_email",autoComplete:"off",value:Z.email,onChange:a=>ee(r=>({...r,email:a.target.value})),placeholder:"Email",type:"email",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{name:"ecommerce_login_password",autoComplete:"new-password",value:Z.password,onChange:a=>ee(r=>({...r,password:a.target.value})),placeholder:"Senha",type:"password",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-primary",type:"submit",disabled:ge,children:"Entrar"})]}),e.jsx("hr",{style:{margin:"12px 0"}}),e.jsx("h4",{style:{marginBottom:6},children:"Perfil"}),q?e.jsxs("div",{style:{display:"grid",gap:4},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nome:"})," ",q.nome||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",q.email||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ID:"})," ",q.id]}),e.jsx("button",{className:"btn-secondary",onClick:Ye,style:{marginTop:8},children:"Sair"})]}):e.jsx("div",{style:{color:"#666"},children:"Nenhum cliente autenticado."})]})]})]})}export{pa as default};
