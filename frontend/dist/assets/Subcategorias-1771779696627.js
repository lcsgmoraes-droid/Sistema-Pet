import{r as c,j as e}from"./vendor-react-1771779696627.js";import{a as o}from"./index-1771779696627.js";import"./vendor-utils-1771779696627.js";import"./vendor-icons-1771779696627.js";function k(){const[d,m]=c.useState([]),[u,h]=c.useState([]),[b,x]=c.useState(!1),[p,l]=c.useState(!1),[t,i]=c.useState({id:null,categoria_id:"",nome:"",descricao:"",ativo:!0});c.useEffect(()=>{v(),n()},[]);const v=async()=>{try{const a=await o.get("/categorias-financeiras");m(a.data.filter(s=>s.ativo))}catch(a){console.error("Erro ao carregar categorias:",a),alert("Erro ao carregar categorias")}},n=async()=>{x(!0);try{const a=await o.get("/subcategorias");h(a.data)}catch(a){console.error("Erro ao carregar subcategorias:",a),alert("Erro ao carregar subcategorias")}finally{x(!1)}},j=async a=>{if(a.preventDefault(),!t.categoria_id||!t.nome){alert("Preencha categoria e nome");return}try{t.id?await o.put(`/subcategorias/${t.id}`,t):await o.post("/subcategorias",t),l(!1),i({id:null,categoria_id:"",nome:"",descricao:"",ativo:!0}),n()}catch(s){console.error("Erro ao salvar:",s),alert("Erro ao salvar subcategoria")}},f=a=>{i(a),l(!0)},y=async a=>{if(confirm("Deseja realmente excluir esta subcategoria?"))try{await o.delete(`/subcategorias/${a}`),n()}catch(s){console.error("Erro ao excluir:",s),alert("Erro ao excluir subcategoria")}},N=a=>{const s=d.find(r=>r.id===a);return s?s.nome:"-"},g=u.reduce((a,s)=>{const r=s.categoria_id;return a[r]||(a[r]={categoria:N(r),itens:[]}),a[r].itens.push(s),a},{});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Subcategorias"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Gerencie as subcategorias de produtos"})]}),e.jsxs("button",{onClick:()=>{i({id:null,categoria_id:"",nome:"",descricao:"",ativo:!0}),l(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx("span",{children:"+"}),"Nova Subcategoria"]})]}),b?e.jsx("div",{className:"text-center py-8",children:"Carregando..."}):e.jsxs("div",{className:"space-y-6",children:[Object.entries(g).map(([a,s])=>e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b",children:e.jsx("h2",{className:"font-semibold text-lg text-gray-800",children:s.categoria})}),e.jsx("div",{className:"divide-y",children:s.itens.map(r=>e.jsxs("div",{className:"px-4 py-3 flex justify-between items-center hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:r.nome}),r.descricao&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:r.descricao})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${r.ativo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.ativo?"Ativo":"Inativo"}),e.jsx("button",{onClick:()=>f(r),className:"text-blue-600 hover:text-blue-800 px-3 py-1",children:"Editar"}),e.jsx("button",{onClick:()=>y(r.id),className:"text-red-600 hover:text-red-800 px-3 py-1",children:"Excluir"})]})]},r.id))})]},a)),Object.keys(g).length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhuma subcategoria cadastrada"})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4",children:[t.id?"Editar":"Nova"," Subcategoria"]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria *"}),e.jsxs("select",{value:t.categoria_id,onChange:a=>i({...t,categoria_id:parseInt(a.target.value)}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Selecione..."}),d.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),e.jsx("input",{type:"text",value:t.nome,onChange:a=>i({...t,nome:a.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),e.jsx("textarea",{value:t.descricao,onChange:a=>i({...t,descricao:a.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:"3"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.ativo,onChange:a=>i({...t,ativo:a.target.checked}),className:"mr-2"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Ativo"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Salvar"})]})]})]})})]})}export{k as default};
