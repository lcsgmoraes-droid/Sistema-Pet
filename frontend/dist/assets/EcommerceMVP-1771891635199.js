import{u as Xe,p as Ze,r as d,j as e}from"./vendor-react-1771891635199.js";import{a as ea}from"./vendor-utils-1771891635199.js";const aa="/api",ra=aa,y=ea.create({baseURL:ra,timeout:15e3,headers:{"Content-Type":"application/json"}});y.interceptors.request.use(i=>{const u=String(i.baseURL||""),g=String(i.url||"");return u.endsWith("/api")&&g.startsWith("/api/")&&(i.url=g.replace(/^\/api/,"")),i});const F="ecommerce_customer_token",Be="ecommerce_customer_orders",le="ecommerce_customer_address",ce="ecommerce_guest_cart",N={pedido_id:null,itens:[],subtotal:0,total:0},K={cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""};function b(i){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(i||0))}function ne(i){return Number((i==null?void 0:i.preco_venda)??(i==null?void 0:i.preco)??(i==null?void 0:i.preco_promocional)??0)}function ia(){var i;return(i=window==null?void 0:window.crypto)!=null&&i.randomUUID?window.crypto.randomUUID():`checkout-${Date.now()}-${Math.random().toString(16).slice(2)}`}function oa(i){return Array.isArray(i)?i:Array.isArray(i==null?void 0:i.items)?i.items:Array.isArray(i==null?void 0:i.itens)?i.itens:Array.isArray(i==null?void 0:i.produtos)?i.produtos:[]}function te(){try{const i=localStorage.getItem(ce);if(!i)return{...N};const u=JSON.parse(i);if(!Array.isArray(u==null?void 0:u.itens))return{...N};const g=Number((u==null?void 0:u.subtotal)||0),p=Number((u==null?void 0:u.total)||0);return{pedido_id:null,itens:u.itens,subtotal:g,total:p}}catch{return{...N}}}function de(i){const u=i.reduce((g,p)=>g+Number(p.preco_unitario||0)*Number(p.quantidade||0),0);return{pedido_id:null,itens:i,subtotal:u,total:u}}function sa(){try{const i=localStorage.getItem(le);if(!i)return{...K};const u=JSON.parse(i);return typeof u=="object"&&u!==null?{...K,...u}:{...K,endereco:String(i||"")}}catch{const i=localStorage.getItem(le)||"";return{...K,endereco:i}}}function na(i){const u=[i.endereco,i.numero].filter(Boolean).join(", "),g=i.bairro?`Bairro: ${i.bairro}`:"",p=[i.cidade,i.estado].filter(Boolean).join("/"),z=i.cep?`CEP: ${i.cep}`:"",B=i.complemento?`Compl.: ${i.complemento}`:"";return[u,g,p,z,B].filter(Boolean).join(" | ")}function Y(i){const u=[];return i!=null&&i.imagem_principal&&u.push(i.imagem_principal),Array.isArray(i==null?void 0:i.imagens)&&i.imagens.forEach(g=>{typeof g=="string"&&g.trim()?u.push(g.trim()):g!=null&&g.url&&typeof g.url=="string"&&u.push(g.url.trim())}),Array.from(new Set(u.filter(Boolean)))}function la(){var Ne,ze,Ie,Le,Fe;const i=Xe(),u=Ze(),[g,p]=d.useState("loja"),[z,B]=d.useState(!1),[D,V]=d.useState([]),[P,De]=d.useState(""),[U,Pe]=d.useState("todas"),[m,H]=d.useState(null),[ue,M]=d.useState(!1),[ge,he]=d.useState(!1),[Ue,pe]=d.useState(!1),[f,O]=d.useState(localStorage.getItem(F)||""),[q,Q]=d.useState(null),[W,$]=d.useState({email:"",password:"",nome:""}),[X,Z]=d.useState({email:"",password:""}),[h,S]=d.useState(()=>te()),[ee,me]=d.useState(""),[k,ae]=d.useState(null),[E,fe]=d.useState(""),[T,ye]=d.useState("entrega"),[j,w]=d.useState(()=>sa()),[v,G]=d.useState(null),[J,re]=d.useState(null),[ie,be]=d.useState(""),[I,Me]=d.useState(()=>{try{return JSON.parse(localStorage.getItem(Be)||"[]")}catch{return[]}}),[je,xe]=d.useState({}),[ve,l]=d.useState(""),[Se,x]=d.useState(""),[o,oe]=d.useState(null),C=d.useMemo(()=>new URLSearchParams(i.search).get("tenant")||u.tenantId||"",[i.search,u.tenantId]),ke=d.useMemo(()=>o!=null&&o.id?{"X-Tenant-ID":o.id}:{},[o==null?void 0:o.id]),_=d.useMemo(()=>f?{Authorization:`Bearer ${f}`}:{},[f]),Oe=d.useMemo(()=>{const a=D.map(r=>(r==null?void 0:r.categoria_nome)||(r==null?void 0:r.categoria)||"Sem categoria").filter(Boolean);return["todas",...Array.from(new Set(a))]},[D]),_e=d.useMemo(()=>{const a=P.trim().toLowerCase();return D.filter(r=>{const s=String((r==null?void 0:r.nome)||"").toLowerCase(),t=(r==null?void 0:r.categoria_nome)||(r==null?void 0:r.categoria)||"Sem categoria";return(!a||s.includes(a))&&(U==="todas"||t===U)})},[D,P,U]);d.useEffect(()=>{if(!C){V([]),oe(null),l("Loja não informada na URL. Use /slug-da-loja.");return}qe(),Re()},[C]),d.useEffect(()=>{f&&(We(),we())},[f]),d.useEffect(()=>{o!=null&&o.cidade&&!E&&fe(o.cidade)},[o==null?void 0:o.cidade,E]),d.useEffect(()=>{f||localStorage.setItem(ce,JSON.stringify(h||N))},[h,f]);async function qe(){var a,r;try{const s=await y.get("/api/ecommerce/tenant-context",{params:{tenant:C}});oe((s==null?void 0:s.data)||null)}catch(s){oe(null),l(((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.detail)||"Loja inválida para e-commerce")}}async function Re(){var a,r;if(C){B(!0),l("");try{const s=await y.get("/api/ecommerce/produtos",{params:{tenant:C,limit:100,busca:P||void 0}});V(oa(s==null?void 0:s.data))}catch(s){V([]),l(((r=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao carregar produtos vendáveis")}finally{B(!1)}}}async function We(){if(f)try{const a=await y.get("/api/ecommerce/auth/me",{headers:_});Q(a.data)}catch{Q(null),O(""),localStorage.removeItem(F),S(te())}}async function we(a=_){var r,s;if(a!=null&&a.Authorization){pe(!0);try{const t=await y.get("/api/carrinho",{headers:a});S(t.data||{...N})}catch(t){l(((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.detail)||"Erro ao carregar carrinho")}finally{pe(!1)}}}async function Ce(a){var t;const r=te();if(!((t=r==null?void 0:r.itens)!=null&&t.length))return;const s={Authorization:`Bearer ${a}`};for(const n of r.itens)await y.post("/api/carrinho/adicionar",{produto_id:n.produto_id,quantidade:n.quantidade},{headers:s});await we(s),localStorage.removeItem(ce)}async function $e(a){var r,s,t;if(a.preventDefault(),!(o!=null&&o.id)){l("Loja não identificada na URL.");return}M(!0),l(""),x("");try{const n=await y.post("/api/ecommerce/auth/registrar",W,{headers:ke}),c=(r=n==null?void 0:n.data)==null?void 0:r.access_token;if(!c)throw new Error("Token não retornado");localStorage.setItem(F,c),O(c),await Ce(c),$({email:"",password:"",nome:""}),x("Cadastro realizado com sucesso."),p("loja")}catch(n){l(((t=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:t.detail)||"Erro ao cadastrar cliente")}finally{M(!1)}}async function Ge(a){var r,s,t;if(a.preventDefault(),!(o!=null&&o.id)){l("Loja não identificada na URL.");return}M(!0),l(""),x("");try{const n=await y.post("/api/ecommerce/auth/login",X,{headers:ke}),c=(r=n==null?void 0:n.data)==null?void 0:r.access_token;if(!c)throw new Error("Token não retornado");localStorage.setItem(F,c),O(c),await Ce(c),Z({email:"",password:""}),x("Login realizado com sucesso."),p("loja")}catch(n){l(((t=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:t.detail)||"Erro ao realizar login")}finally{M(!1)}}function Je(){Q(null),O(""),S({...N}),G(null),re(null),localStorage.removeItem(F),x("Sessão encerrada.")}async function Ae(a){var r,s;if(!f){l("");const t=ne(a);S(n=>{const c=Array.isArray(n==null?void 0:n.itens)?n.itens:[],A=c.find(R=>R.produto_id===a.id)?c.map(R=>R.produto_id===a.id?{...R,quantidade:Number(R.quantidade||0)+1}:R):[...c,{item_id:`guest-${a.id}`,produto_id:a.id,nome:a.nome,preco_unitario:t,quantidade:1}];return de(A)}),x("Produto adicionado ao carrinho. Faça login no checkout para finalizar.");return}l("");try{const t=await y.post("/api/carrinho/adicionar",{produto_id:a.id,quantidade:1},{headers:_});S(t.data),x("Produto adicionado ao carrinho.")}catch(t){l(((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.detail)||"Erro ao adicionar no carrinho")}}async function se(a,r){var s,t;if(!f){S(n=>{const c=Array.isArray(n==null?void 0:n.itens)?n.itens:[];if(r<=0){const A=c.filter(R=>R.item_id!==a);return de(A)}const L=c.map(A=>A.item_id===a?{...A,quantidade:r}:A);return de(L)});return}l("");try{if(r<=0){const c=await y.delete(`/api/carrinho/remover/${a}`,{headers:_});S(c.data);return}const n=await y.put(`/api/carrinho/atualizar/${a}`,{quantidade:r},{headers:_});S(n.data)}catch(n){l(((t=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:t.detail)||"Erro ao atualizar carrinho")}}async function Ke(a){var r,s;if(a.preventDefault(),!f){l("Faça login para aplicar cupom."),p("conta");return}if(ee.trim()){l("");try{const t=await y.post("/api/carrinho/aplicar-cupom",{codigo:ee.trim()},{headers:_});ae(t.data),x("Cupom validado.")}catch(t){ae(null),l(((s=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:s.detail)||"Cupom inválido")}}}async function Ye(a){var s,t,n;if(a.preventDefault(),!f){l("Faça login para continuar no checkout."),p("conta");return}if(!((s=h==null?void 0:h.itens)!=null&&s.length)){l("Adicione itens no carrinho antes de calcular o checkout.");return}const r=((o==null?void 0:o.cidade)||E||j.cidade||"").trim();if(!r||r.length<2){l("Cidade da loja não configurada para checkout.");return}l(""),G(null);try{const c=await y.get("/api/checkout/resumo",{headers:_,params:{cidade_destino:r,cupom:(k==null?void 0:k.codigo)||void 0}});G(c.data),x("Resumo de checkout calculado.")}catch(c){l(((n=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:n.detail)||"Erro ao calcular resumo do checkout")}}async function Ve(){var s,t;if(!f){l("Faça login para finalizar o pedido."),p("conta");return}const a=((o==null?void 0:o.cidade)||E||j.cidade||"").trim();if(!a||a.length<2){l("Cidade da loja não configurada para checkout.");return}const r=T==="retirada"?"RETIRADA NA LOJA":na(j);if(T==="entrega"&&!r){l("Informe o endereço de entrega.");return}he(!0),l(""),x(""),re(null);try{const c=(await y.post("/api/checkout/finalizar",{cidade_destino:a,endereco_entrega:r||null,cupom:(k==null?void 0:k.codigo)||null},{headers:{..._,"Idempotency-Key":ia()}})).data;if(re(c),S({pedido_id:null,itens:[],subtotal:0,total:0}),G(null),ae(null),me(""),T==="entrega"&&localStorage.setItem(le,JSON.stringify(j)),c!=null&&c.pedido_id){const L=Array.from(new Set([c.pedido_id,...I]));Me(L),localStorage.setItem(Be,JSON.stringify(L))}x("Pedido finalizado com sucesso."),p("pedidos")}catch(n){l(((t=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:t.detail)||"Erro ao finalizar checkout")}finally{he(!1)}}async function Ee(a){if(!(!f||!a))try{const r=await y.get(`/api/checkout/pedido/${a}/status`,{headers:_});xe(s=>({...s,[a]:r.data}))}catch(r){xe(s=>{var t,n;return{...s,[a]:{status:"erro",detail:((n=(t=r==null?void 0:r.response)==null?void 0:t.data)==null?void 0:n.detail)||"Erro ao consultar pedido"}}})}}d.useEffect(()=>{!f||g!=="pedidos"||I.slice(0,10).forEach(a=>{je[a]||Ee(a)})},[g,f,I]);const Te=Number((h==null?void 0:h.total)||0);function He(){var a;if(!((a=h==null?void 0:h.itens)!=null&&a.length)){l("Adicione itens no carrinho antes de finalizar.");return}if(!f){l("Faça login para finalizar o pedido."),p("conta");return}p("checkout")}function Qe(a){const r=Y(a);H(a),be(r[0]||"")}return e.jsxs("div",{className:"page",children:[e.jsx("h1",{children:"E-commerce MVP"}),e.jsx("p",{style:{color:"#666",marginBottom:16},children:"Loja, carrinho, checkout e conta do cliente no fluxo do e-commerce."}),e.jsxs("div",{style:{marginBottom:12,color:o!=null&&o.id?"#0a7d32":"#b00020"},children:["Loja: ",(o==null?void 0:o.name)||"não identificada"," (",(o==null?void 0:o.ecommerce_slug)||C||"-",")"]}),(o==null?void 0:o.storefront_path)&&e.jsxs("div",{style:{marginBottom:12,color:"#4b5563"},children:["URL da loja: ",o.storefront_path]}),!C&&e.jsx("div",{style:{marginBottom:12,color:"#b00020"},children:"Use a URL no formato: /slug-da-loja"}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:16},children:[e.jsx("button",{className:"btn-secondary",onClick:()=>p("loja"),children:"Loja"}),e.jsx("button",{className:"btn-secondary",onClick:()=>p("carrinho"),children:"Carrinho"}),e.jsx("button",{className:"btn-secondary",onClick:()=>p("checkout"),children:"Checkout"}),e.jsx("button",{className:"btn-secondary",onClick:()=>p("pedidos"),children:"Meus pedidos"}),e.jsx("button",{className:"btn-secondary",onClick:()=>p("conta"),children:"Conta"})]}),ve&&e.jsx("div",{style:{background:"#ffe8e8",color:"#8c0000",padding:10,borderRadius:6,marginBottom:12},children:ve}),Se&&e.jsx("div",{style:{background:"#e8fff0",color:"#0a7d32",padding:10,borderRadius:6,marginBottom:12},children:Se}),g==="loja"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0, 1fr) 320px",gap:16},children:[e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:12,border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("h2",{style:{fontSize:20,marginBottom:4},children:"Catálogo da loja"}),e.jsx("div",{style:{color:"#64748b",fontSize:14},children:"Selecione produtos, confira detalhes e adicione ao carrinho."})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:14,flexWrap:"wrap"},children:[e.jsx("input",{value:P,onChange:a=>De(a.target.value),placeholder:"Buscar produto...",style:{flex:1,minWidth:240,padding:10,border:"1px solid #d1d5db",borderRadius:10}}),e.jsx("select",{value:U,onChange:a=>Pe(a.target.value),style:{padding:10,border:"1px solid #d1d5db",borderRadius:10},children:Oe.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx("button",{className:"btn-secondary",onClick:Re,disabled:z,children:z?"Carregando...":"Atualizar"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:12},children:[_e.map(a=>e.jsxs("button",{type:"button",onClick:()=>Qe(a),style:{border:"1px solid #e5e7eb",borderRadius:12,padding:10,background:"#fff",textAlign:"left",cursor:"pointer",display:"grid",gap:8},children:[e.jsx("div",{style:{borderRadius:10,background:"#f1f5f9",height:140,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:a!=null&&a.imagem_principal?e.jsx("img",{src:a.imagem_principal,alt:a.nome,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:"#64748b",fontSize:12},children:"Sem imagem"})}),e.jsxs("div",{style:{minHeight:42},children:[e.jsx("div",{style:{fontSize:14,fontWeight:700,lineHeight:1.25},children:a.nome}),e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:4},children:(a==null?void 0:a.categoria_nome)||(a==null?void 0:a.categoria)||"Sem categoria"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("strong",{style:{fontSize:16},children:b(ne(a))}),e.jsx("button",{className:"btn-primary",onClick:r=>{r.stopPropagation(),Ae(a)},children:"Adicionar"})]})]},a.id)),!z&&_e.length===0&&e.jsx("div",{style:{color:"#666",padding:12,display:"grid",gap:10},children:e.jsx("div",{children:"Nenhum produto encontrado para o filtro atual."})})]})]}),e.jsxs("aside",{style:{background:"#fff",padding:16,borderRadius:12,border:"1px solid #e5e7eb",alignSelf:"start",position:"sticky",top:8},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:10},children:"Seu carrinho"}),(Ne=h==null?void 0:h.itens)!=null&&Ne.length?e.jsxs("div",{style:{display:"grid",gap:8},children:[h.itens.slice(0,6).map(a=>e.jsxs("div",{style:{borderBottom:"1px solid #f1f5f9",paddingBottom:6,marginBottom:4},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:a.nome}),e.jsxs("div",{style:{fontSize:12,color:"#666"},children:[a.quantidade," x ",b(a.preco_unitario)]})]},a.item_id)),h.itens.length>6&&e.jsxs("div",{style:{fontSize:12,color:"#666"},children:["+ ",h.itens.length-6," item(ns)"]}),e.jsxs("div",{style:{marginTop:4,fontWeight:700,fontSize:16},children:["Subtotal: ",b(Te)]}),e.jsx("button",{className:"btn-primary",onClick:He,children:"Finalizar"}),e.jsx("button",{className:"btn-secondary",onClick:()=>p("carrinho"),children:"Editar carrinho"}),!f&&e.jsx("div",{style:{fontSize:12,color:"#666"},children:"Login/cadastro só será solicitado no fechamento."})]}):e.jsx("div",{style:{color:"#666"},children:"Seu carrinho está vazio."})]})]}),m&&e.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15, 23, 42, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:60},onClick:()=>H(null),children:e.jsxs("div",{style:{background:"#fff",width:"min(980px, 100%)",maxHeight:"90vh",overflowY:"auto",borderRadius:14,border:"1px solid #e5e7eb",padding:16,display:"grid",gridTemplateColumns:"1.1fr 1fr",gap:16},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{children:[e.jsx("div",{style:{borderRadius:12,background:"#f1f5f9",minHeight:260,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:ie?e.jsx("img",{src:ie,alt:m.nome,style:{width:"100%",height:360,objectFit:"cover"}}):e.jsx("span",{style:{color:"#64748b"},children:"Sem imagem disponível"})}),Y(m).length>1&&e.jsx("div",{style:{display:"flex",gap:8,marginTop:10,overflowX:"auto"},children:Y(m).map(a=>e.jsx("button",{onClick:()=>be(a),style:{border:ie===a?"2px solid #6366f1":"1px solid #d1d5db",borderRadius:8,width:74,height:74,overflow:"hidden",padding:0,background:"#fff",cursor:"pointer"},children:e.jsx("img",{src:a,alt:"Miniatura do produto",style:{width:"100%",height:"100%",objectFit:"cover"}})},a))})]}),e.jsxs("div",{style:{display:"grid",alignContent:"start",gap:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:8},children:[e.jsx("h3",{style:{margin:0,fontSize:24,lineHeight:1.2},children:m.nome}),e.jsx("button",{className:"btn-secondary",onClick:()=>H(null),children:"Fechar"})]}),e.jsx("div",{style:{fontSize:24,fontWeight:800,color:"#0f172a"},children:b(ne(m))}),e.jsxs("div",{style:{color:"#475569"},children:["Categoria: ",e.jsx("strong",{children:(m==null?void 0:m.categoria_nome)||(m==null?void 0:m.categoria)||"Sem categoria"})]}),e.jsxs("div",{style:{color:"#475569"},children:["Estoque disponível: ",e.jsx("strong",{children:(m==null?void 0:m.estoque_ecommerce)??0})]}),e.jsxs("div",{style:{color:"#475569"},children:["Código: ",e.jsx("strong",{children:(m==null?void 0:m.codigo)||"-"})]}),Y(m).length<=1&&e.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Este produto ainda não possui galeria com múltiplas fotos cadastradas."}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn-primary",onClick:()=>Ae(m),children:"Adicionar ao carrinho"}),e.jsx("button",{className:"btn-secondary",onClick:()=>p("carrinho"),children:"Ver carrinho"})]})]})]})}),g==="carrinho"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Carrinho"}),Ue?e.jsx("div",{children:"Carregando carrinho..."}):(ze=h==null?void 0:h.itens)!=null&&ze.length?e.jsxs("div",{style:{display:"grid",gap:8},children:[h.itens.map(a=>e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:6,padding:8},children:[e.jsx("div",{style:{fontWeight:600},children:a.nome}),e.jsx("div",{style:{fontSize:12,color:"#666"},children:b(a.preco_unitario)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:6},children:[e.jsx("button",{className:"btn-secondary",onClick:()=>se(a.item_id,a.quantidade-1),children:"-"}),e.jsx("span",{children:a.quantidade}),e.jsx("button",{className:"btn-secondary",onClick:()=>se(a.item_id,a.quantidade+1),children:"+"}),e.jsx("button",{className:"btn-secondary",onClick:()=>se(a.item_id,0),children:"Remover"})]})]},a.item_id)),e.jsxs("div",{style:{marginTop:8,fontWeight:700},children:["Total: ",b(Te)]})]}):e.jsx("div",{style:{color:"#666"},children:"Carrinho vazio"}),e.jsxs("form",{onSubmit:Ke,style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("input",{value:ee,onChange:a=>me(a.target.value),placeholder:"Cupom",style:{flex:1,padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-secondary",type:"submit",children:"Aplicar"})]}),k&&e.jsxs("div",{style:{marginTop:8,color:"#0a7d32"},children:["Cupom ",k.codigo,": -",b(k.desconto)]})]}),g==="checkout"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"grid",gap:10},children:[e.jsx("h3",{style:{marginTop:0},children:"Checkout"}),e.jsxs("form",{onSubmit:Ye,style:{display:"grid",gap:8},children:[e.jsxs("div",{style:{display:"grid",gap:6},children:[e.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Forma de recebimento"}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"radio",name:"deliveryMode",value:"entrega",checked:T==="entrega",onChange:()=>ye("entrega")}),"Entrega"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"radio",name:"deliveryMode",value:"retirada",checked:T==="retirada",onChange:()=>ye("retirada")}),"Retirada na loja"]})]})]}),e.jsx("input",{value:(o==null?void 0:o.cidade)||E,onChange:a=>fe(a.target.value),placeholder:"Cidade da loja",disabled:!!(o!=null&&o.cidade),style:{padding:8,border:"1px solid #ddd",borderRadius:6,background:o!=null&&o.cidade?"#f8fafc":"#fff"}}),T==="entrega"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{value:j.cep,onChange:a=>w(r=>({...r,cep:a.target.value})),placeholder:"CEP",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:j.endereco,onChange:a=>w(r=>({...r,endereco:a.target.value})),placeholder:"Rua / Avenida",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsx("input",{value:j.numero,onChange:a=>w(r=>({...r,numero:a.target.value})),placeholder:"Número",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:j.complemento,onChange:a=>w(r=>({...r,complemento:a.target.value})),placeholder:"Complemento",style:{padding:8,border:"1px solid #ddd",borderRadius:6}})]}),e.jsx("input",{value:j.bairro,onChange:a=>w(r=>({...r,bairro:a.target.value})),placeholder:"Bairro",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px",gap:8},children:[e.jsx("input",{value:j.cidade||(o==null?void 0:o.cidade)||"",onChange:a=>w(r=>({...r,cidade:a.target.value})),placeholder:"Cidade",disabled:!!(o!=null&&o.cidade),style:{padding:8,border:"1px solid #ddd",borderRadius:6,background:o!=null&&o.cidade?"#f8fafc":"#fff"}}),e.jsx("input",{value:j.estado||(o==null?void 0:o.uf)||"",onChange:a=>w(r=>({...r,estado:a.target.value})),placeholder:"UF",style:{padding:8,border:"1px solid #ddd",borderRadius:6}})]})]}),e.jsx("button",{className:"btn-secondary",type:"submit",children:"Calcular resumo"})]}),v&&e.jsxs("div",{style:{background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:10},children:[e.jsxs("div",{children:["Itens: ",v.itens_count]}),e.jsxs("div",{children:["Subtotal: ",b(v.subtotal)]}),e.jsxs("div",{children:["Frete: ",b((Ie=v==null?void 0:v.frete)==null?void 0:Ie.valor_frete)]}),e.jsxs("div",{children:["Desconto: ",b((Le=v==null?void 0:v.cupom)==null?void 0:Le.desconto)]}),e.jsxs("div",{style:{fontWeight:700},children:["Total: ",b(v.total)]})]}),e.jsx("button",{className:"btn-primary",onClick:Ve,disabled:ge||!(o!=null&&o.cidade||E)||!((Fe=h==null?void 0:h.itens)!=null&&Fe.length),children:ge?"Finalizando...":"Finalizar pedido"}),(J==null?void 0:J.pedido_id)&&e.jsxs("div",{style:{background:"#e8fff0",color:"#0a7d32",padding:10,borderRadius:6},children:["Pedido confirmado: ",e.jsx("strong",{children:J.pedido_id})]})]}),g==="pedidos"&&e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Meus pedidos"}),I.length===0?e.jsx("div",{style:{color:"#666"},children:"Nenhum pedido registrado nesta sessão."}):e.jsx("div",{style:{display:"grid",gap:8},children:I.map(a=>{const r=je[a];return e.jsxs("div",{style:{border:"1px solid #eee",borderRadius:6,padding:10},children:[e.jsx("div",{children:e.jsx("strong",{children:a})}),e.jsxs("div",{children:["Status: ",(r==null?void 0:r.status)||"não consultado"]}),e.jsxs("div",{children:["Total: ",(r==null?void 0:r.total)!=null?b(r.total):"-"]}),e.jsx("button",{className:"btn-secondary",onClick:()=>Ee(a),style:{marginTop:6},children:"Atualizar status"})]},a)})})]}),g==="conta"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Cadastro"}),e.jsxs("form",{onSubmit:$e,style:{display:"grid",gap:8},children:[e.jsx("input",{value:W.nome,onChange:a=>$(r=>({...r,nome:a.target.value})),placeholder:"Nome",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:W.email,onChange:a=>$(r=>({...r,email:a.target.value})),placeholder:"Email",type:"email",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:W.password,onChange:a=>$(r=>({...r,password:a.target.value})),placeholder:"Senha",type:"password",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-primary",type:"submit",disabled:ue,children:"Cadastrar"})]})]}),e.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8},children:[e.jsx("h3",{style:{marginTop:0},children:"Login"}),e.jsxs("form",{onSubmit:Ge,style:{display:"grid",gap:8},children:[e.jsx("input",{value:X.email,onChange:a=>Z(r=>({...r,email:a.target.value})),placeholder:"Email",type:"email",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("input",{value:X.password,onChange:a=>Z(r=>({...r,password:a.target.value})),placeholder:"Senha",type:"password",style:{padding:8,border:"1px solid #ddd",borderRadius:6}}),e.jsx("button",{className:"btn-primary",type:"submit",disabled:ue,children:"Entrar"})]}),e.jsx("hr",{style:{margin:"12px 0"}}),e.jsx("h4",{style:{marginBottom:6},children:"Perfil"}),q?e.jsxs("div",{style:{display:"grid",gap:4},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Nome:"})," ",q.nome||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Email:"})," ",q.email||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ID:"})," ",q.id]}),e.jsx("button",{className:"btn-secondary",onClick:Je,style:{marginTop:8},children:"Sair"})]}):e.jsx("div",{style:{color:"#666"},children:"Nenhum cliente autenticado."})]})]})]})}export{la as default};
