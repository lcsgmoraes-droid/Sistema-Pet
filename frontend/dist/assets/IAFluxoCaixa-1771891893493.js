import{r as h,j as e}from"./vendor-react-1771891893493.js";import{a as y,u as ae}from"./index-1771891893493.js";import{n as j}from"./vendor-utils-1771891893493.js";import{ah as te,ba as S,au as re,bb as ie,ai as _,a0 as P,aI as B,$,a3 as k,b9 as ee,ag as le,bc as oe,b as de,a2 as ne}from"./vendor-icons-1771891893493.js";import{R as ce,A as me,C as G,X as V,Y as Q,T as U,a as X,g as W,b as Y,L as xe}from"./vendor-recharts-1771891893493.js";import{p as he,f as ge,a as ue}from"./vendor-datefns-1771891893493.js";const be=a=>{const s={critico:"bg-red-100 text-red-800 border-red-200",alerta:"bg-yellow-100 text-yellow-800 border-yellow-200",ok:"bg-green-100 text-green-800 border-green-200"};return s[a]||s.ok},je=a=>a==="critico"?e.jsx($,{className:"w-5 h-5"}):a==="alerta"?e.jsx($,{className:"w-5 h-5"}):e.jsx(k,{className:"w-5 h-5"}),pe=a=>a==="melhorando"?e.jsx(_,{className:"w-5 h-5 text-green-600"}):a==="piorando"?e.jsx(P,{className:"w-5 h-5 text-red-600"}):e.jsx(B,{className:"w-5 h-5 text-gray-600"});function fe({indices:a}){const[s,t]=h.useState(null);if(!a)return e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhum √≠ndice dispon√≠vel"});const{saldo_atual:i,dias_de_caixa:d,status:o,tendencia:r,score_saude:c,receita_mensal_estimada:g,despesa_mensal_estimada:l,percentual_variacao_7d:x}=a;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(te,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"relative",children:[pe(r),e.jsx("button",{onMouseEnter:()=>t("saldo"),onMouseLeave:()=>t(null),className:"ml-2 text-gray-400 hover:text-gray-600",children:e.jsx(S,{className:"w-4 h-4"})}),s==="saldo"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Saldo Atual"}),e.jsx("p",{children:"Seu saldo de caixa real neste momento. O n√∫mero verde ao lado mostra a varia√ß√£o dos √∫ltimos 7 dias."})]})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Saldo Atual"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i||0)}),x&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[x>0?"+":"",x.toFixed(1),"% em 7 dias"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(re,{className:"w-6 h-6 text-purple-600"})}),e.jsx("button",{onMouseEnter:()=>t("dias"),onMouseLeave:()=>t(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(S,{className:"w-4 h-4"})}),s==="dias"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Dias de Caixa"}),e.jsx("p",{children:"Quantos dias voc√™ consegue pagar as despesas com seu saldo atual. Se tem R$ 10.000 e gasta R$ 1.000/dia = 10 dias."})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Dias de Caixa"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(d==null?void 0:d.toFixed(1))||"0.0"," dias"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:d<7?"Cr√≠tico - menos de 1 semana":d<15?"Alerta - menos de 2 semanas":"Saud√°vel"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${be(o)}`,children:je(o)}),e.jsx("button",{onMouseEnter:()=>t("status"),onMouseLeave:()=>t(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(S,{className:"w-4 h-4"})}),s==="status"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Status"}),e.jsxs("p",{children:[e.jsx("strong",{children:"CRITICO:"})," <7 dias (risco iminente). ",e.jsx("strong",{children:"ALERTA:"})," 7-15 dias. ",e.jsx("strong",{children:"OK:"})," >15 dias."]})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Status"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 capitalize",children:o||"N/A"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1 capitalize",children:["Tend√™ncia: ",r||"est√°vel"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(ie,{className:"w-6 h-6 text-green-600"})}),e.jsx("button",{onMouseEnter:()=>t("score"),onMouseLeave:()=>t(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(S,{className:"w-4 h-4"})}),s==="score"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Score de Sa√∫de"}),e.jsx("p",{children:"Nota de 0-100 que resume a sa√∫de financeira. Considera dias de caixa, tend√™ncia e volatilidade."})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Score de Sa√∫de"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(c==null?void 0:c.toFixed(0))||"0","/100"]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${c>=70?"bg-green-600":c>=40?"bg-yellow-600":"bg-red-600"}`,style:{width:`${c||0}%`}})})]}),g&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(_,{className:"w-6 h-6 text-green-600"})})}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Receita Mensal"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Estimativa"})]}),l&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Despesa Mensal"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Estimativa"})]})]})}const N=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(a),se=a=>{try{const s=he(a);return ge(s,"dd/MMM",{locale:ue})}catch{return a}},H=({active:a,payload:s})=>{if(!a||!s||!s.length)return null;const t=s[0].payload;return e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:se(t.data_projetada)}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-blue-600",children:["Saldo: ",e.jsx("strong",{children:N(t.saldo_estimado)})]}),t.limite_superior&&e.jsxs("p",{className:"text-green-600",children:["Otimista: ",N(t.limite_superior)]}),t.limite_inferior&&e.jsxs("p",{className:"text-red-600",children:["Pessimista: ",N(t.limite_inferior)]}),t.alerta_nivel&&e.jsxs("p",{className:`font-medium ${t.alerta_nivel==="critico"?"text-red-600":t.alerta_nivel==="alerta"?"text-yellow-600":"text-green-600"}`,children:["Status: ",t.alerta_nivel]})]})]})};function A({projecoes:a,titulo:s="Proje√ß√£o de Fluxo de Caixa",detalhado:t=!1}){var o,r,c,g,l,x;if(!a||a.length===0)return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s}),e.jsx("div",{className:"text-center py-8 text-gray-500",children:'Nenhuma proje√ß√£o dispon√≠vel. Clique em "Atualizar Proje√ß√£o" para gerar.'})]});const i=a.map(n=>({...n,data_formatada:se(n.data_projetada),saldo:n.saldo_estimado||0,superior:n.limite_superior||null,inferior:n.limite_inferior||null})),d=i.some(n=>n.superior!==null||n.inferior!==null);return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Saldo Inicial"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:N(((o=i[0])==null?void 0:o.saldo)||0)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Saldo Final"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:N(((r=i[i.length-1])==null?void 0:r.saldo)||0)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Varia√ß√£o"}),e.jsx("p",{className:`text-lg font-bold ${((c=i[i.length-1])==null?void 0:c.saldo)-((g=i[0])==null?void 0:g.saldo)>=0?"text-green-600":"text-red-600"}`,children:N((((l=i[i.length-1])==null?void 0:l.saldo)||0)-(((x=i[0])==null?void 0:x.saldo)||0))})]})]}),e.jsx(ce,{width:"100%",height:t?400:300,children:d?e.jsxs(me,{data:i,children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(V,{dataKey:"data_formatada",stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(Q,{stroke:"#6b7280",style:{fontSize:"12px"},tickFormatter:n=>`R$ ${(n/1e3).toFixed(0)}k`}),e.jsx(U,{content:e.jsx(H,{})}),e.jsx(X,{}),e.jsx(W,{type:"monotone",dataKey:"superior",stroke:"#10b981",fill:"#d1fae5",fillOpacity:.3,name:"Cen√°rio Otimista"}),e.jsx(W,{type:"monotone",dataKey:"inferior",stroke:"#ef4444",fill:"#fee2e2",fillOpacity:.3,name:"Cen√°rio Pessimista"}),e.jsx(Y,{type:"monotone",dataKey:"saldo",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},name:"Saldo Estimado"})]}):e.jsxs(xe,{data:i,children:[e.jsx(G,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(V,{dataKey:"data_formatada",stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(Q,{stroke:"#6b7280",style:{fontSize:"12px"},tickFormatter:n=>`R$ ${(n/1e3).toFixed(0)}k`}),e.jsx(U,{content:e.jsx(H,{})}),e.jsx(X,{}),e.jsx(Y,{type:"monotone",dataKey:"saldo",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},name:"Saldo Estimado"})]})}),i.some(n=>n.vai_faltar_caixa)&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"‚ö†Ô∏è Aten√ß√£o: Proje√ß√£o indica que o caixa pode ficar negativo nos pr√≥ximos dias!"})})]})}const Ne=a=>{const s={critico:{icon:$,bgColor:"bg-red-50",borderColor:"border-red-200",textColor:"text-red-800",iconColor:"text-red-600"},alerta:{icon:le,bgColor:"bg-yellow-50",borderColor:"border-yellow-200",textColor:"text-yellow-800",iconColor:"text-yellow-600"},aviso:{icon:ee,bgColor:"bg-blue-50",borderColor:"border-blue-200",textColor:"text-blue-800",iconColor:"text-blue-600"},info:{icon:k,bgColor:"bg-green-50",borderColor:"border-green-200",textColor:"text-green-800",iconColor:"text-green-600"}};return s[a]||s.info};function J({alertas:a}){if(!a||a.length===0)return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Alertas do Caixa"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"w-12 h-12 text-green-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum alerta no momento"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Seu caixa est√° saud√°vel! üéâ"})]})]});const s={critico:0,alerta:1,aviso:2,info:3},t=[...a].sort((i,d)=>(s[i.tipo]||3)-(s[d.tipo]||3));return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Alertas do Caixa"}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-sm rounded-full",children:t.length})]}),e.jsx("div",{className:"space-y-3",children:t.map((i,d)=>{const o=Ne(i.tipo),r=o.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${o.bgColor} ${o.borderColor}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:`w-5 h-5 flex-shrink-0 mt-0.5 ${o.iconColor}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-medium ${o.textColor} mb-1`,children:i.titulo}),e.jsx("p",{className:`text-sm ${o.textColor} opacity-90`,children:i.mensagem}),i.data&&e.jsx("p",{className:`text-xs ${o.textColor} opacity-70 mt-2`,children:new Date(i.data).toLocaleString("pt-BR")})]})]})},d)})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:t.filter(i=>i.tipo==="critico").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Cr√≠ticos"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:t.filter(i=>i.tipo==="alerta").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Alertas"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.filter(i=>i.tipo==="aviso").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Avisos"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.filter(i=>i.tipo==="info").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Infos"})]})]})]})}const Z=[{id:"otimista",nome:"Otimista",descricao:"Aumento de 20% nas receitas e redu√ß√£o de 10% nas despesas",icon:_,color:"green"},{id:"realista",nome:"Realista",descricao:"Mant√©m o padr√£o atual de receitas e despesas",icon:B,color:"blue"},{id:"pessimista",nome:"Pessimista",descricao:"Redu√ß√£o de 20% nas receitas e aumento de 10% nas despesas",icon:P,color:"red"}];function ye({userId:a,projecoesBase:s=[]}){var x,n,v,b,u,p,w,C,I,E,F,D,L,M,O,T,z,q,K;const[t,i]=h.useState("realista"),[d,o]=h.useState(!1),[r,c]=h.useState(null),g=async()=>{o(!0);try{const R={Authorization:`Bearer ${localStorage.getItem("token")}`},f=await y.post(`/api/ia/fluxo/simular-cenario/${a}`,{cenario:t},{headers:R});c(f.data),j.success(`Cen√°rio ${t} simulado com sucesso!`)}catch(m){console.error("Erro ao simular cen√°rio:",m),j.error("Erro ao simular cen√°rio")}finally{o(!1)}},l=Z.find(m=>m.id===t);return l==null||l.icon,e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Simulador de Cen√°rios"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Simule diferentes cen√°rios para entender o impacto no seu fluxo de caixa"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:Z.map(m=>{const R=m.icon,f=t===m.id;return e.jsxs("button",{onClick:()=>i(m.id),className:`p-4 rounded-lg border-2 transition-all text-left ${f?`border-${m.color}-500 bg-${m.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(R,{className:`w-6 h-6 ${f?`text-${m.color}-600`:"text-gray-400"}`}),e.jsx("h4",{className:`font-semibold ${f?`text-${m.color}-900`:"text-gray-900"}`,children:m.nome})]}),e.jsx("p",{className:`text-sm ${f?`text-${m.color}-700`:"text-gray-600"}`,children:m.descricao})]},m.id)})}),e.jsx("button",{onClick:g,disabled:d,className:"w-full md:w-auto px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Simulando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-5 h-5"}),"Simular Cen√°rio"]})})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Compara√ß√£o: Base vs ",l==null?void 0:l.nome]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Cen√°rio Atual"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Saldo Final"}),e.jsx("span",{className:"font-semibold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(((x=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:x.saldo_estimado)||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Varia√ß√£o"}),e.jsx("span",{className:"font-semibold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((((n=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:n.saldo_estimado)||0)-(((v=s==null?void 0:s[0])==null?void 0:v.saldo_estimado)||0))})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-700 mb-3",children:["Cen√°rio ",l==null?void 0:l.nome]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Saldo Final"}),e.jsx("span",{className:`font-semibold ${t==="otimista"?"text-green-600":t==="pessimista"?"text-red-600":"text-blue-600"}`,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(((p=(u=r==null?void 0:r.projecoes_ajustadas)==null?void 0:u[((b=r==null?void 0:r.projecoes_ajustadas)==null?void 0:b.length)-1])==null?void 0:p.saldo_ajustado)||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Varia√ß√£o"}),e.jsx("span",{className:`font-semibold ${t==="otimista"?"text-green-600":t==="pessimista"?"text-red-600":"text-blue-600"}`,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((((I=(C=r==null?void 0:r.projecoes_ajustadas)==null?void 0:C[((w=r==null?void 0:r.projecoes_ajustadas)==null?void 0:w.length)-1])==null?void 0:I.saldo_ajustado)||0)-(((F=(E=r==null?void 0:r.projecoes_ajustadas)==null?void 0:E[0])==null?void 0:F.saldo_ajustado)||0))})]})]})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Diferen√ßa no Saldo Final"}),e.jsx("span",{className:`text-xl font-bold ${(((M=(L=r==null?void 0:r.projecoes_ajustadas)==null?void 0:L[((D=r==null?void 0:r.projecoes_ajustadas)==null?void 0:D.length)-1])==null?void 0:M.saldo_ajustado)||0)>(((O=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:O.saldo_estimado)||0)?"text-green-600":"text-red-600"}`,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((((q=(z=r==null?void 0:r.projecoes_ajustadas)==null?void 0:z[((T=r==null?void 0:r.projecoes_ajustadas)==null?void 0:T.length)-1])==null?void 0:q.saldo_ajustado)||0)-(((K=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:K.saldo_estimado)||0))})]})})]}),e.jsx(A,{projecoes:(r==null?void 0:r.projecoes_ajustadas)||[],titulo:`Proje√ß√£o - Cen√°rio ${l==null?void 0:l.nome}`,detalhado:!0})]}),!r&&s&&s.length>0&&e.jsx(A,{projecoes:s,titulo:"Proje√ß√£o Atual (Cen√°rio Base)",detalhado:!0})]})}function ve(){const[a,s]=h.useState(!1),t=[{titulo:"Dias de Caixa",descricao:"Quantos dias seu caixa consegue cobrir as despesas com o saldo atual. Se tem R$ 10.000 e gasta R$ 1.000/dia, ter√° 10 dias de caixa.",formula:"Saldo Atual √∑ Despesa M√©dia Di√°ria",referencia:"√öltimos 30 dias"},{titulo:"Saldo Estimado (Proje√ß√£o)",descricao:"Previs√£o do saldo do caixa para os pr√≥ximos 15 dias, calculada usando intelig√™ncia artificial (Prophet) baseada em hist√≥rico de 30+ dias.",formula:"Saldo Atual + Receitas Previstas - Despesas Previstas",referencia:"Pr√≥ximos 15 dias"},{titulo:"Entrada/Sa√≠da Estimada",descricao:"Previs√£o di√°ria de quanto voc√™ deve receber (entradas) e gastar (sa√≠das) nos pr√≥ximos dias.",formula:"M√©dia hist√≥rica √∑ 30 dias √ó fator sazonalidade",referencia:"Pr√≥ximos 15 dias"},{titulo:"Status do Caixa",descricao:"Classifica√ß√£o da sa√∫de financeira: CRITICO (<7 dias), ALERTA (7-15 dias) ou OK (>15 dias)",formula:'Status = IF(dias_caixa < 7) "CRITICO" ELSE IF(dias_caixa < 15) "ALERTA" ELSE "OK"',referencia:"Dados em tempo real"}],i=[{nome:"Vis√£o Geral",conteudo:"Mostra os √≠ndices principais de sa√∫de do caixa: quanto tempo de saldo voc√™ tem, a tend√™ncia (melhorando/piorando), despesa m√©dia di√°ria e score geral de sa√∫de.",periodo:"√öltimos 30 dias de hist√≥rico"},{nome:"Proje√ß√µes 15 Dias",conteudo:"Gr√°fico e tabela com a previs√£o de saldo di√°rio para os pr√≥ximos 15 dias. Usa algoritmo Prophet com intelig√™ncia artificial.",periodo:"Pr√≥ximos 15 dias a partir de hoje"},{nome:"Alertas",conteudo:"Lista autom√°tica de avisos: se o caixa est√° cr√≠tico, se h√° risco de falta de saldo, ou se a tend√™ncia est√° piorando.",periodo:"Monitoramento cont√≠nuo"},{nome:"Simulador",conteudo:"Permite simular 3 cen√°rios: OTIMISTA (+20% receita, -10% despesa), REALISTA (sem mudan√ßas) e PESSIMISTA (-20% receita, +10% despesa).",periodo:"Pr√≥ximos 15 dias com mudan√ßas aplicadas"}];return e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-6",children:[e.jsxs("button",{onClick:()=>s(!a),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Entenda os Dados"})]}),e.jsx(de,{className:`w-5 h-5 text-blue-600 transition-transform ${a?"rotate-180":""}`})]}),a&&e.jsxs("div",{className:"mt-6 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"O que cada aba mostra?"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((d,o)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:d.nome}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:d.conteudo}),e.jsxs("p",{className:"text-xs text-blue-600 font-medium",children:["üìÖ ",d.periodo]})]},o))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"M√©tricas Explicadas"}),e.jsx("div",{className:"space-y-4",children:t.map((d,o)=>e.jsx("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-blue-600",children:o+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:d.titulo}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:d.descricao}),e.jsxs("div",{className:"mt-2 text-xs space-y-1",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("strong",{children:"C√°lculo:"})," ",d.formula]}),e.jsxs("p",{className:"text-blue-600",children:[e.jsx("strong",{children:"Per√≠odo:"})," ",d.referencia]})]})]})]})},o))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"Perguntas Frequentes"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:'‚ùì Qual per√≠odo a "Vis√£o Geral" est√° analisando?'}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Os √∫ltimos ",e.jsx("strong",{children:"30 dias"})," de movimenta√ß√µes realizadas. Ela calcula a despesa m√©dia desse per√≠odo para determinar quantos dias de caixa voc√™ tem."]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:"‚ùì O gr√°fico de Proje√ß√µes √© confi√°vel?"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Usa algoritmo Prophet (intelig√™ncia artificial) que aprende com os √∫ltimos ",e.jsx("strong",{children:"30+ dias"})," de dados. Quanto mais hist√≥rico, mais preciso. Funciona bem para tend√™ncias, mas n√£o prev√™ eventos inesperados."]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:"‚ùì O Simulador altera meus dados reais?"}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"N√ÉO!"}),' √â apenas uma simula√ß√£o. Mostra "E se..." ocorressem essas mudan√ßas. Seus dados permanecem intactos.']})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:'‚ùì Como interpretar "Dias de Caixa"?'}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"10 dias"})," = voc√™ pode cobrir ",e.jsx("strong",{children:"10 dias de despesas"})," com saldo atual. Se ",e.jsx("strong",{children:"<7 dias"})," √© cr√≠tico (risco iminente). Se ",e.jsx("strong",{children:"7-15"})," √© alerta. Se ",e.jsx("strong",{children:">15"})," est√° ok."]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:'‚ùì Qual √© a diferen√ßa entre "Saldo Atual" e "Saldo Estimado"?'}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Saldo Atual"})," = saldo real hoje. ",e.jsx("strong",{children:"Saldo Estimado"})," = previs√£o do saldo daqui a X dias (levando em conta receitas/despesas esperadas)."]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"üí° Dicas Importantes:"}),e.jsxs("ul",{className:"text-sm text-blue-900 space-y-1",children:[e.jsxs("li",{children:["‚Ä¢ Clique em ",e.jsx("strong",{children:'"Atualizar Proje√ß√£o"'})," para recalcular com dados mais recentes"]}),e.jsx("li",{children:"‚Ä¢ Os Alertas aparecem automaticamente quando h√° risco (caixa <7 dias ou tend√™ncia negativa)"}),e.jsx("li",{children:'‚Ä¢ Use o Simulador para planejar: "E se aumentar despesas de marketing em 20%?"'}),e.jsx("li",{children:"‚Ä¢ Se tiver menos de 30 dias de hist√≥rico, as proje√ß√µes ser√£o mais conservadoras"})]})]})]})]})}function we({userId:a}){const[s,t]=h.useState(!0),[i,d]=h.useState(null),[o,r]=h.useState([]),[c,g]=h.useState([]),[l,x]=h.useState("visao-geral");h.useEffect(()=>{n()},[a]);const n=async()=>{t(!0);try{const u={Authorization:`Bearer ${localStorage.getItem("token")}`},[p,w,C]=await Promise.all([y.get(`/ia/fluxo/indices-saude/${a}`,{headers:u}),y.get(`/ia/fluxo/projecoes/${a}?dias=15`,{headers:u}),y.get(`/ia/fluxo/alertas/${a}`,{headers:u})]);d(p.data),r(w.data||[]),g(C.data||[])}catch(b){console.error("Erro ao carregar dados IA:",b),j.error("Erro ao carregar dados da IA")}finally{t(!1)}},v=async()=>{const b=j.loading("Gerando proje√ß√£o com Prophet...");try{const p={Authorization:`Bearer ${localStorage.getItem("token")}`};await y.post(`/ia/fluxo/projetar-15-dias/${a}`,{},{headers:p}),j.success("Proje√ß√£o gerada com sucesso!"),n()}catch(u){console.error("Erro ao gerar proje√ß√£o:",u),j.error("Erro ao gerar proje√ß√£o")}finally{j.dismiss(b)}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(ve,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ü§ñ Fluxo de Caixa Preditivo"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Intelig√™ncia artificial analisando seu caixa"})]}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ne,{className:"w-4 h-4"}),"Atualizar Proje√ß√£o"]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[e.jsx("button",{onClick:()=>x("visao-geral"),className:`px-4 py-2 font-medium transition-colors ${l==="visao-geral"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Vis√£o Geral"}),e.jsx("button",{onClick:()=>x("projecoes"),className:`px-4 py-2 font-medium transition-colors ${l==="projecoes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Proje√ß√µes 15 Dias"}),e.jsxs("button",{onClick:()=>x("alertas"),className:`px-4 py-2 font-medium transition-colors relative ${l==="alertas"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Alertas",c.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:c.length})]}),e.jsx("button",{onClick:()=>x("simulador"),className:`px-4 py-2 font-medium transition-colors ${l==="simulador"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Simulador"})]}),e.jsxs("div",{className:"space-y-6",children:[l==="visao-geral"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border-l-4 border-green-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"üìä Vis√£o Geral:"})," An√°lise dos √∫ltimos ",e.jsx("strong",{children:"30 dias"})," para calcular a sa√∫de do caixa. Mostra quanto tempo voc√™ consegue manter o neg√≥cio com saldo atual."]})}),e.jsx(fe,{indices:i}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(A,{projecoes:o.slice(0,7),titulo:"Pr√≥ximos 7 Dias"}),e.jsx(J,{alertas:c.slice(0,3)})]})]}),l==="projecoes"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"üìà Proje√ß√£o 15 Dias:"})," Previs√£o usando intelig√™ncia artificial (Prophet). Baseada em ",e.jsx("strong",{children:"30+ dias de hist√≥rico"})," para prever entradas e sa√≠das dos pr√≥ximos ",e.jsx("strong",{children:"15 dias"}),". Quanto mais hist√≥rico, mais precisa a previs√£o."]})}),e.jsx(A,{projecoes:o,titulo:"Proje√ß√£o 15 Dias com Prophet",detalhado:!0})]}),l==="alertas"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border-l-4 border-orange-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"‚ö†Ô∏è Alertas:"})," Avisos autom√°ticos gerados em tempo real.",e.jsx("strong",{children:" Cr√≠tico"})," = menos de 7 dias de caixa (risco iminente).",e.jsx("strong",{children:" Alerta"})," = 7-15 dias (aten√ß√£o necess√°ria).",e.jsx("strong",{children:" OK"})," = mais de 15 dias (situa√ß√£o confort√°vel)."]})}),e.jsx(J,{alertas:c})]}),l==="simulador"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-l-4 border-purple-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"üéØ Simulador:"})," Teste 3 cen√°rios para os ",e.jsx("strong",{children:"pr√≥ximos 15 dias"}),".",e.jsx("strong",{children:" Otimista:"})," +20% receita, -10% despesa.",e.jsx("strong",{children:" Realista:"})," sem mudan√ßas.",e.jsx("strong",{children:" Pessimista:"})," -20% receita, +10% despesa.",e.jsx("strong",{children:"Seus dados reais n√£o s√£o alterados!"})]})}),e.jsx(ye,{userId:a,projecoesBase:o})]})]})]})}function Pe(){const{user:a}=ae();return e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(we,{userId:(a==null?void 0:a.id)||1})})}export{Pe as default};
