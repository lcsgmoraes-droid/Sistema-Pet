import{r as d,j as e,b1 as B,aA as T,bd as _,ay as k,ax as A,be as D,az as F,X as O,a$ as $}from"./vendor-react-1772136024665.js";import{a as f}from"./index-1772136024665.js";const x=[{value:"banco",label:"Banco",icon:_,cor_padrao:"#dc2626"},{value:"caixa",label:"Caixa FÃ­sico",icon:k,cor_padrao:"#16a34a"},{value:"digital",label:"Carteira Digital",icon:A,cor_padrao:"#2563eb"}],P=["ðŸ¦","ðŸ’°","ðŸ’³","ðŸ’µ","ðŸ’¸","ðŸ§","ðŸª™","ðŸ’´","ðŸ’¶","ðŸ’·","ðŸ¤‘","ðŸ’²","ðŸ”’","ðŸ¦","ðŸª","ðŸ¢","ðŸ­","ðŸŽ¯","ðŸ“Š","ðŸ“ˆ","ðŸ’¼","ðŸ‘›","ðŸŽ","âš¡"],C={banco:"ðŸ¦",caixa:"ðŸ’°",digital:"ðŸ’³"},z=o=>{if(typeof o!="string"||!o)return"";try{return decodeURIComponent(escape(o))}catch{return o}},N=(o,j="banco")=>{const n=z(o).trim(),m=C[j]||"ðŸ¦";return!n||n.includes("?")||n.includes("ï¿½")||n.includes("Ã°")||n.includes("Ãƒ")?m:n};function L(){const[o,j]=d.useState([]),[n,m]=d.useState(!0),[E,g]=d.useState(!1),[h,w]=d.useState(null),[p,u]=d.useState(""),[r,l]=d.useState({nome:"",tipo:"banco",banco:"",saldo_inicial:0,cor:"#dc2626",icone:C.banco,instituicao_bancaria:!1,ativa:!0});d.useEffect(()=>{y()},[]);const y=async()=>{try{m(!0);const s=((await f.get("/contas-bancarias")).data||[]).map(t=>({...t,icone:N(t.icone,t.tipo)}));j(s)}catch(a){console.error("Erro:",a),u("Erro ao carregar contas bancÃ¡rias")}finally{m(!1)}},v=(a=null)=>{if(a)l({nome:a.nome,tipo:a.tipo,banco:a.banco||"",saldo_inicial:a.saldo_inicial,cor:a.cor||"#dc2626",icone:N(a.icone,a.tipo),instituicao_bancaria:a.instituicao_bancaria||!1,ativa:a.ativa}),w(a);else{const s=x[0];l({nome:"",tipo:"banco",banco:"",saldo_inicial:0,cor:s.cor_padrao,icone:C.banco,instituicao_bancaria:!1,ativa:!0}),w(null)}g(!0),u("")},S=async a=>{var s,t,c;a.preventDefault();try{const i={nome:r.nome.trim(),tipo:r.tipo,banco:((s=r.banco)==null?void 0:s.trim())||null,saldo_inicial:Number(r.saldo_inicial)||0,cor:r.cor,icone:N(r.icone,r.tipo),instituicao_bancaria:!!r.instituicao_bancaria,ativa:!!r.ativa};console.log("Enviando dados:",i),h?await f.put(`/contas-bancarias/${h.id}`,i):await f.post("/contas-bancarias",i),await y(),g(!1),u("")}catch(i){console.error("Erro completo:",i),console.error("Response:",i.response),u(((c=(t=i.response)==null?void 0:t.data)==null?void 0:c.detail)||i.message||"Erro ao salvar conta")}},I=async a=>{var s,t;if(confirm("Deseja realmente excluir esta conta?"))try{await f.delete(`/contas-bancarias/${a}`),await y()}catch(c){console.error("Erro:",c),u(((t=(s=c.response)==null?void 0:s.data)==null?void 0:t.detail)||"Erro ao excluir conta")}};return n?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Cadastro de Bancos"}),e.jsx("p",{className:"text-gray-600",children:"Configure as contas bancÃ¡rias, caixas e carteiras digitais do sistema"})]}),e.jsxs("button",{onClick:()=>v(),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[e.jsx(B,{className:"w-5 h-5"}),"Nova Conta"]})]})}),p&&e.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-red-800",children:p})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(a=>{var t,c,i;const s=((t=x.find(b=>b.value===a.tipo))==null?void 0:t.icon)||_;return e.jsxs("div",{className:`bg-white rounded-xl border-2 p-4 transition ${a.ativa?"border-gray-200 hover:border-blue-300":"border-gray-100 opacity-60"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-2xl",style:{backgroundColor:`${a.cor}20`},children:a.icone}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800",children:a.nome}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(s,{className:"w-3 h-3"}),(c=x.find(b=>b.value===a.tipo))==null?void 0:c.label]})]})]}),!a.ativa&&e.jsx("span",{className:"text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded",children:"Inativa"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Tipo de Conta"}),e.jsx("p",{className:"text-lg font-semibold text-gray-800",children:(i=x.find(b=>b.value===a.tipo))==null?void 0:i.label}),a.banco&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a.banco})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(a),className:"flex items-center justify-center bg-gray-100 text-gray-700 p-2 rounded-lg hover:bg-gray-200 transition",children:e.jsx(D,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>I(a.id),className:"flex items-center justify-center bg-red-50 text-red-600 p-2 rounded-lg hover:bg-red-100 transition",children:e.jsx(F,{className:"w-4 h-4"})})]})]},a.id)})}),o.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(k,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg mb-4",children:"Nenhuma conta cadastrada"}),e.jsx("button",{onClick:()=>v(),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Cadastrar primeira conta"})]}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:h?"Editar Conta":"Nova Conta"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[p&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-800 text-sm",children:p}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),e.jsx("input",{type:"text",value:r.nome,onChange:a=>l({...r,nome:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsx("select",{value:r.tipo,onChange:a=>{const s=x.find(t=>t.value===a.target.value);l({...r,tipo:a.target.value,cor:(s==null?void 0:s.cor_padrao)||r.cor})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:x.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),r.tipo==="banco"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Banco"}),e.jsx("input",{type:"text",value:r.banco,onChange:a=>l({...r,banco:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Santander, Bradesco..."})]}),!h&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Saldo Inicial"}),e.jsx("input",{type:"number",step:"0.01",value:r.saldo_inicial,onChange:a=>l({...r,saldo_inicial:parseFloat(a.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cor"}),e.jsx("input",{type:"color",value:r.cor,onChange:a=>l({...r,cor:a.target.value}),className:"w-full h-10 rounded-lg cursor-pointer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ãcone Atual"}),e.jsx("div",{className:"w-full h-10 border border-gray-300 rounded-lg flex items-center justify-center text-2xl bg-white",style:{backgroundColor:`${r.cor}10`},children:r.icone})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Escolher Ãcone"}),e.jsx("div",{className:"grid grid-cols-8 gap-2 p-3 bg-gray-50 rounded-lg border border-gray-200 max-h-32 overflow-y-auto",children:P.map((a,s)=>e.jsx("button",{type:"button",onClick:()=>l({...r,icone:a}),className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl transition hover:scale-110 ${r.icone===a?"bg-blue-100 border-2 border-blue-500 ring-2 ring-blue-200":"bg-white border border-gray-200 hover:border-blue-300"}`,children:a},s))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"instituicao_bancaria",checked:r.instituicao_bancaria,onChange:a=>l({...r,instituicao_bancaria:a.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"instituicao_bancaria",className:"text-sm text-gray-700",children:"ðŸ¦ InstituiÃ§Ã£o BancÃ¡ria (para conciliaÃ§Ã£o OFX)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"ativa",checked:r.ativa,onChange:a=>l({...r,ativa:a.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{htmlFor:"ativa",className:"text-sm text-gray-700",children:"Conta ativa"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>g(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[e.jsx($,{className:"w-4 h-4"}),"Salvar"]})]})]})]})})]})}export{L as default};
