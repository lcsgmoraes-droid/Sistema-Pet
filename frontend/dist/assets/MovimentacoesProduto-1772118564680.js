import{ah as H,S as Q,r as b,z as d,j as e}from"./vendor-react-1772118564680.js";import{a as w}from"./index-1772118564680.js";function J(){const{id:_}=H(),q=Q(),[t,M]=b.useState(null),[h,S]=b.useState([]),[T,L]=b.useState(!0),[E,j]=b.useState(!1),[u,k]=b.useState([]),[$,I]=b.useState(null),[p,C]=b.useState("entrada"),[s,g]=b.useState({quantidade:"",custo_unitario:"",observacao:"",lote:"",data_validade:"",data_fabricacao:""});b.useEffect(()=>{F()},[_]);const F=async()=>{var a,r,o;try{L(!0),console.log("Carregando produto ID:",_);const i=await w.get(`/produtos/${_}`);console.log("Produto carregado:",i.data),M(i.data);const l=await w.get(`/estoque/movimentacoes/produto/${_}`);console.log("MovimentaÃ§Ãµes carregadas:",l.data),S(l.data)}catch(i){console.error("Erro ao carregar dados:",i),console.error("Detalhes do erro:",(a=i.response)==null?void 0:a.data),d.error(((o=(r=i.response)==null?void 0:r.data)==null?void 0:o.detail)||"Erro ao carregar dados do produto")}finally{L(!1)}},R=(a,r=null)=>{var o,i;if((t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="VIRTUAL"&&!r){d.error(`âŒ KIT VIRTUAL nÃ£o permite movimentaÃ§Ã£o manual de estoque.

O estoque deste kit Ã© calculado automaticamente com base nos componentes.

Para alterar o estoque, movimente os produtos componentes individualmente.`,{duration:6e3});return}C(a),I(r),g(r?{quantidade:((o=r.quantidade)==null?void 0:o.toString())||"",custo_unitario:((i=r.custo_unitario)==null?void 0:i.toString())||"",observacao:r.observacao||"",lote:r.lote_id||"",data_validade:"",data_fabricacao:""}:{quantidade:"",custo_unitario:a==="entrada"&&(t==null?void 0:t.preco_custo)||"",observacao:"",lote:"",data_validade:"",data_fabricacao:"",retornar_componentes:!1}),j(!0)},A=()=>{u.length===h.length?k([]):k(h.map(a=>a.id))},D=a=>{u.includes(a)?k(u.filter(r=>r!==a)):k([...u,a])},z=async()=>{var a,r;if(u.length===0){d.error("Selecione pelo menos um lanÃ§amento");return}if(confirm(`Deseja realmente excluir ${u.length} lanÃ§amento(s)?`))try{const i=(await Promise.all(u.map(l=>w.delete(`/estoque/movimentacoes/${l}`)))).flatMap(l=>l.data.componentes_estornados||[]);i.length>0?d.success(`${u.length} lanÃ§amento(s) excluÃ­do(s)!
âœ… ${i.length} componente(s) estornado(s)`,{duration:5e3}):d.success(`${u.length} lanÃ§amento(s) excluÃ­do(s)`),k([]),F()}catch(o){console.error("Erro ao excluir:",o),d.error(((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao excluir lanÃ§amentos")}},P=async a=>{var r,o,i;a.preventDefault();try{if($){const x={quantidade:parseFloat(s.quantidade),custo_unitario:s.custo_unitario?parseFloat(s.custo_unitario):null,observacao:s.observacao||null};await w.patch(`/estoque/movimentacoes/${$.id}`,x),d.success("LanÃ§amento atualizado com sucesso!"),j(!1),I(null),F();return}let l="/estoque/",n={produto_id:parseInt(_),quantidade:parseFloat(s.quantidade),custo_unitario:s.custo_unitario?parseFloat(s.custo_unitario):null,observacao:s.observacao||null};if(p==="entrada")l+="entrada",n.tipo="entrada",n.motivo="compra",n.numero_lote=s.lote||null,n.data_validade=s.data_validade||null,n.data_fabricacao=s.data_fabricacao||null;else if(p==="saida")l+="saida",n.tipo="saida",n.motivo="saida_manual",n.numero_lote=s.lote||null,n.data_validade=s.data_validade||null,(t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="FISICO"&&(n.retornar_componentes=s.retornar_componentes===!0);else if(p==="balanco"){const x=parseFloat(s.quantidade),c=(t==null?void 0:t.estoque_atual)||0,f=x-c;l+=f>=0?"entrada":"saida",n.tipo=f>=0?"entrada":"saida",n.quantidade=Math.abs(f),n.motivo="balanco"}const y=await w.post(l,n);if(console.log("Response da entrada:",y.data),p==="entrada"&&y.data){const{custo_anterior:x,custo_unitario:c,variacao_preco:f}=y.data;if(f&&x!==null&&x!==void 0){let N="LanÃ§amento registrado!";f==="aumento"?(N+=` â¬†ï¸ Custo aumentou de R$ ${x==null?void 0:x.toFixed(2)} para R$ ${c==null?void 0:c.toFixed(2)}`,d.error(N,{duration:5e3})):f==="reducao"?(N+=` â¬‡ï¸ Custo reduziu de R$ ${x==null?void 0:x.toFixed(2)} para R$ ${c==null?void 0:c.toFixed(2)}`,d.success(N,{duration:5e3})):f==="estavel"&&(N+=` Custo mantido em R$ ${c==null?void 0:c.toFixed(2)}`,d(N,{icon:"âž–",duration:3e3}))}else c?d.success(`LanÃ§amento registrado! Custo: R$ ${c==null?void 0:c.toFixed(2)}`,{duration:3e3}):d.success("LanÃ§amento registrado com sucesso!")}else if((r=y.data)!=null&&r.componentes_sensibilizados&&y.data.componentes_sensibilizados.length>0){const x=y.data.componentes_sensibilizados.length;d.success(`LanÃ§amento registrado com sucesso!
âœ… ${x} componente(s) sensibilizado(s)`,{duration:4e3})}else d.success("LanÃ§amento registrado com sucesso!");j(!1),F()}catch(l){console.error("Erro ao registrar lanÃ§amento:",l),d.error(((i=(o=l.response)==null?void 0:o.data)==null?void 0:i.detail)||"Erro ao registrar lanÃ§amento")}},V=a=>{if(!a)return"-";const r=new Date(a);return new Date(r.getTime()-3*60*60*1e3).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"America/Sao_Paulo"})},O=a=>({compra:"Compra",venda:"Venda",venda_online:"Venda Online",ajuste:"Ajuste",saida_manual:"SaÃ­da Manual",devolucao:"DevoluÃ§Ã£o",perda:"Perda",transferencia:"TransferÃªncia",balanco:"BalanÃ§o"})[a]||a,K=a=>a.referencia_tipo==="venda"?a.documento&&(a.documento.length===44||a.documento.startsWith("NF"))?{texto:`NF ${a.documento}`,icone:"nf-venda",cor:"text-red-600",link:null}:{texto:`Pedido #${a.referencia_id}`,icone:"pedido",cor:"text-orange-600",link:`/pdv?vendaId=${a.referencia_id}`}:a.motivo==="balanco"?{texto:"BalanÃ§o",icone:"balanco",cor:"text-blue-600",link:null}:a.tipo==="saida"?{texto:"SaÃ­da Manual",icone:"manual",cor:"text-red-600",link:null}:a.tipo==="entrada"&&a.documento&&a.documento.length===44?{texto:`NF ${a.documento.substring(25,34)}`,icone:"nf-entrada",cor:"text-green-600",link:null}:a.tipo==="entrada"&&a.documento?{texto:a.documento,icone:"documento",cor:"text-blue-600",link:`/pdv?vendaId=${a.documento}`}:a.tipo==="entrada"?{texto:"Entrada Manual",icone:"manual",cor:"text-green-600",link:null}:{texto:"Manual",icone:"manual",cor:"text-gray-500",link:null},B=h.filter(a=>a.tipo==="entrada").reduce((a,r)=>a+parseFloat(r.quantidade||0),0),U=h.filter(a=>a.tipo==="saida").reduce((a,r)=>a+parseFloat(r.quantidade||0),0);if(T)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-gray-500",children:"Carregando..."})});if(!t)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-red-500",children:"Produto nÃ£o encontrado"})});const m=t.estoque_atual||0,v=t.estoque_minimo||0,W=m>v?"text-green-600":m===0?"text-red-600":"text-yellow-600";return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[(t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="VIRTUAL"&&e.jsx("div",{className:"mb-6 bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-indigo-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-indigo-900 mb-1",children:"ðŸ§© KIT VIRTUAL - Estoque Calculado Automaticamente"}),e.jsxs("p",{className:"text-sm text-indigo-800",children:["Este Ã© um produto do tipo ",e.jsx("strong",{children:"KIT VIRTUAL"}),". O estoque Ã© calculado automaticamente com base nos componentes que o compÃµem.",e.jsx("br",{}),e.jsx("strong",{children:"NÃ£o Ã© possÃ­vel movimentar o estoque do kit diretamente."})," Para alterar o estoque, movimente os produtos componentes individualmente."]})]})]})}),(t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="FISICO"&&e.jsx("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-1",children:"ðŸ“¦ KIT FÃSICO - Estoque PrÃ³prio com SensibilizaÃ§Ã£o"}),e.jsxs("p",{className:"text-sm text-green-800",children:["Este Ã© um produto do tipo ",e.jsx("strong",{children:"KIT FÃSICO"}),". Possui estoque prÃ³prio e independente.",e.jsx("br",{}),e.jsx("strong",{children:"Importante:"})," Ao movimentar o estoque do kit, os estoques dos componentes tambÃ©m serÃ£o automaticamente sensibilizados na mesma proporÃ§Ã£o."]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${m>v?"bg-green-100":m===0?"bg-red-100":"bg-yellow-100"}`,children:e.jsx("svg",{className:`w-6 h-6 ${W}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>q("/produtos"),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.nome})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{children:["CÃ³digo: ",e.jsx("span",{className:"font-mono",children:t.codigo||t.sku})]}),t.codigo_barras&&e.jsxs("div",{children:["EAN: ",e.jsx("span",{className:"font-mono",children:t.codigo_barras})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-green-600 font-medium mb-1",children:"Total Entradas"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:B.toFixed(2)})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-red-600 font-medium mb-1",children:"Total SaÃ­das"}),e.jsx("div",{className:"text-2xl font-bold text-red-700",children:U.toFixed(2)})]}),e.jsxs("div",{className:`rounded-lg p-3 ${m>v?"bg-blue-50":m===0?"bg-red-50":"bg-yellow-50"}`,children:[e.jsx("div",{className:`text-xs font-medium mb-1 ${m>v?"text-blue-600":m===0?"text-red-600":"text-yellow-600"}`,children:"Saldo Atual"}),e.jsxs("div",{className:`text-2xl font-bold ${m>v?"text-blue-700":m===0?"text-red-700":"text-yellow-700"}`,children:[m.toFixed(2)," ",t.unidade||"UN"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"Estoque MÃ­n/MÃ¡x"}),e.jsxs("div",{className:"text-lg font-bold text-gray-700",children:[v.toFixed(0)," / ",(t.estoque_maximo||0).toFixed(0)]})]})]}),e.jsx("div",{className:"relative group",children:e.jsxs("button",{onClick:()=>{(t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="VIRTUAL"?d.error(`KIT VIRTUAL nÃ£o permite movimentaÃ§Ã£o manual.

Movimente os componentes individualmente.`,{duration:4e3}):j(!0)},disabled:(t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="VIRTUAL",className:`px-6 py-2 rounded-lg transition-colors flex items-center gap-2 ${(t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="VIRTUAL"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Incluir lanÃ§amento"]})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"LanÃ§amentos"}),u.length>0&&e.jsxs("button",{onClick:z,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Excluir (",u.length,")"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 w-12",children:e.jsx("input",{type:"checkbox",checked:u.length===h.length&&h.length>0,onChange:A,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data e Hora"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Entrada"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SaÃ­da"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PreÃ§o Venda"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"PreÃ§o Compra"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lote"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Origem"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ObservaÃ§Ã£o"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-8 text-center text-gray-500",children:"Nenhuma movimentaÃ§Ã£o registrada"})}):h.map((a,r)=>{const o=K(a),i=r>0?h[r-1]:null,l=i&&a.referencia_tipo==="venda"&&i.referencia_tipo==="venda"&&a.referencia_id===i.referencia_id;return e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${l?"border-l-4 border-l-blue-500 bg-blue-50":""}`,onClick:()=>R(a.tipo,a),children:[e.jsx("td",{className:"px-4 py-3 w-12",onClick:n=>n.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:u.includes(a.id),onChange:()=>D(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:V(a.created_at)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center",children:a.tipo==="entrada"?e.jsx("span",{className:"text-green-600 font-semibold",children:parseFloat(a.quantidade).toFixed(2)}):"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-center",children:a.tipo==="saida"?e.jsx("span",{className:"text-red-600 font-semibold",children:parseFloat(a.quantidade).toFixed(2)}):"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right text-gray-900",children:t.preco_venda?`R$ ${t.preco_venda.toFixed(2)}`:"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-right",children:a.custo_unitario?a.variacao_custo?e.jsxs("div",{className:"relative group inline-block",title:`Custo anterior: R$ ${a.variacao_custo.custo_anterior.toFixed(2)}
Custo atual: R$ ${a.variacao_custo.custo_atual.toFixed(2)}
DiferenÃ§a: R$ ${a.variacao_custo.diferenca_valor.toFixed(2)} (${a.variacao_custo.diferenca_percentual>0?"+":""}${a.variacao_custo.diferenca_percentual.toFixed(1)}%)`,children:[e.jsxs("span",{className:`font-semibold ${a.variacao_custo.tipo==="aumento"?"text-red-600":a.variacao_custo.tipo==="reducao"?"text-green-600":"text-gray-900"}`,children:["R$ ",a.custo_unitario.toFixed(2)]}),e.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 hidden group-hover:block z-50",children:e.jsxs("div",{className:"bg-gray-900 text-white text-xs rounded-lg py-2 px-3 whitespace-nowrap shadow-lg",children:[e.jsx("div",{className:"font-semibold mb-1",children:"VariaÃ§Ã£o de Custo"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["Anterior: R$ ",a.variacao_custo.custo_anterior.toFixed(2)]}),e.jsxs("div",{children:["Atual: R$ ",a.variacao_custo.custo_atual.toFixed(2)]}),e.jsxs("div",{className:a.variacao_custo.tipo==="aumento"?"text-red-400":"text-green-400",children:[a.variacao_custo.tipo==="aumento"?"â–²":"â–¼"," R$ ",Math.abs(a.variacao_custo.diferenca_valor).toFixed(2)," (",a.variacao_custo.diferenca_percentual>0?"+":"",a.variacao_custo.diferenca_percentual.toFixed(1),"%)"]})]}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"border-4 border-transparent border-t-gray-900"})})]})})]}):e.jsxs("span",{className:"text-gray-900",children:["R$ ",a.custo_unitario.toFixed(2)]}):"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:a.lote_info?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:a.lote_info.nome}),a.lote_info.consumido_acumulado!==void 0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",a.lote_info.consumido_acumulado.toFixed(0),"/",a.lote_info.total_lote.toFixed(0),")"]})]}):a.lote_nome?a.lote_nome:"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",onClick:n=>n.stopPropagation(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx("span",{className:"text-blue-600",title:"Mesmo pedido/venda",children:"â†ª"}),o.link?e.jsx("a",{href:o.link,onClick:n=>{n.preventDefault(),n.stopPropagation(),q(o.link)},className:`${o.cor} font-medium hover:underline cursor-pointer`,children:o.texto}):e.jsx("span",{className:`${o.cor} font-medium`,children:o.texto})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.motivo&&a.motivo!=="compra"&&a.motivo!=="venda"&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:O(a.motivo)}),a.observacao]})})]},a.id)})})]})})]}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:$?"Editar LanÃ§amento":"Novo LanÃ§amento"}),e.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-4",children:[!$&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo *"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{type:"button",onClick:()=>C("entrada"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${p==="entrada"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Entrada"}),e.jsx("button",{type:"button",onClick:()=>C("saida"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${p==="saida"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"SaÃ­da"}),e.jsx("button",{type:"button",onClick:()=>C("balanco"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${p==="balanco"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"BalanÃ§o"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:p==="balanco"?"Saldo Total *":"Quantidade *"}),e.jsx("input",{type:"number",step:"0.01",value:s.quantidade,onChange:a=>g({...s,quantidade:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),p==="balanco"&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Estoque atual: ",m,". Digite o novo saldo total."]})]}),p==="entrada"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PreÃ§o de Compra"}),e.jsx("input",{type:"number",step:"0.01",value:s.custo_unitario,onChange:a=>g({...s,custo_unitario:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["NÃºmero do Lote ",e.jsx("span",{className:"text-gray-400",children:"(opcional)"})]}),e.jsx("input",{type:"text",value:s.lote,onChange:a=>g({...s,lote:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: LOTE-001"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Data de Validade ",e.jsx("span",{className:"text-gray-400",children:"(opcional)"})]}),e.jsx("input",{type:"date",value:s.data_validade,onChange:a=>g({...s,data_validade:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Data de FabricaÃ§Ã£o ",e.jsx("span",{className:"text-gray-400",children:"(opcional)"})]}),e.jsx("input",{type:"date",value:s.data_fabricacao,onChange:a=>g({...s,data_fabricacao:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),p==="saida"&&e.jsxs(e.Fragment,{children:[(t==null?void 0:t.tipo_produto)==="KIT"&&(t==null?void 0:t.tipo_kit)==="FISICO"&&e.jsx("div",{className:"p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:"retornar_componentes",checked:s.retornar_componentes===!0,onChange:a=>g({...s,retornar_componentes:a.target.checked}),className:"mt-1 h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:"retornar_componentes",className:"block text-sm font-semibold text-gray-900 cursor-pointer",children:"ðŸ”„ Desmontar kit e retornar componentes ao estoque"}),e.jsxs("p",{className:"text-xs text-gray-700 mt-1",children:[e.jsx("strong",{children:"Marque esta opÃ§Ã£o"})," se vocÃª desmontou o kit e quer devolver os produtos unitÃ¡rios ao estoque."]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[e.jsx("strong",{children:"Deixe desmarcado"})," se houve perda, roubo ou venda do kit montado."]})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["NÃºmero do Lote ",e.jsx("span",{className:"text-gray-400",children:"(opcional)"})]}),e.jsx("input",{type:"text",value:s.lote,onChange:a=>g({...s,lote:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: LOTE-001"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Deixe vazio para usar FIFO automÃ¡tico"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Data de Validade ",e.jsx("span",{className:"text-gray-400",children:"(opcional)"})]}),e.jsx("input",{type:"date",value:s.data_validade,onChange:a=>g({...s,data_validade:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ObservaÃ§Ã£o"}),e.jsx("textarea",{value:s.observacao,onChange:a=>g({...s,observacao:a.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ObservaÃ§Ãµes sobre este lanÃ§amento..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Incluir"})]})]})]})})]})}export{J as default};
