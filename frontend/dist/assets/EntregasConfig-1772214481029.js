import{r as d,j as e}from"./vendor-react-1772214481029.js";import{a as c}from"./api-1772214481029.js";import"./index-1772214481029.js";function _(){const[f,j]=d.useState(!0),[l,u]=d.useState(!1),[p,g]=d.useState(!1),[m,x]=d.useState([]),[r,t]=d.useState({entregador_padrao_id:"",ponto_inicial_rota:"",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""});d.useEffect(()=>{async function a(){var o,s;try{const[n,i]=await Promise.all([c.get("/configuracoes/entregas"),c.get("/clientes/",{params:{is_entregador:!0,entregador_ativo:!0}})]);t({entregador_padrao_id:n.data.entregador_padrao_id??"",ponto_inicial_rota:"",cep:n.data.cep??"",logradouro:n.data.logradouro??"",numero:n.data.numero??"",complemento:n.data.complemento??"",bairro:n.data.bairro??"",cidade:n.data.cidade??"",estado:n.data.estado??""});const h=Array.isArray(i.data)?i.data:((o=i.data)==null?void 0:o.clientes)||((s=i.data)==null?void 0:s.items)||[];console.log("üöö Entregadores carregados:",h),x(h)}catch(n){console.error("‚ùå Erro ao carregar configura√ß√µes:",n),alert("Erro ao carregar configura√ß√µes de entrega"),x([])}finally{j(!1)}}a()},[]);async function v(){const a=r.cep.replace(/\D/g,"");if(a.length!==8){alert("CEP inv√°lido. Digite 8 d√≠gitos.");return}g(!0);try{const s=await(await fetch(`https://viacep.com.br/ws/${a}/json/`)).json();if(s.erro){alert("CEP n√£o encontrado");return}t({...r,logradouro:s.logradouro||"",bairro:s.bairro||"",cidade:s.localidade||"",estado:s.uf||""})}catch(o){console.error(o),alert("Erro ao buscar CEP")}finally{g(!1)}}async function y(a){a.preventDefault(),u(!0);try{await c.put("/configuracoes/entregas",{entregador_padrao_id:r.entregador_padrao_id||null,cep:r.cep||null,logradouro:r.logradouro||null,numero:r.numero||null,complemento:r.complemento||null,bairro:r.bairro||null,cidade:r.cidade||null,estado:r.estado||null}),alert("Configura√ß√µes salvas com sucesso")}catch(o){console.error(o),alert("Erro ao salvar configura√ß√µes")}finally{u(!1)}}return f?e.jsx("div",{children:"Carregando..."}):e.jsxs("div",{className:"page",children:[e.jsx("h1",{children:"Configura√ß√µes de Entregas"}),e.jsxs("form",{onSubmit:y,style:{maxWidth:600},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Entregador padr√£o"}),e.jsxs("select",{value:r.entregador_padrao_id,onChange:a=>t({...r,entregador_padrao_id:a.target.value}),children:[e.jsx("option",{value:"",children:"Nenhum (escolher manualmente)"}),Array.isArray(m)&&m.map(a=>e.jsx("option",{value:a.id,children:a.nome},a.id))]}),e.jsx("p",{style:{fontSize:12,color:"#666",marginTop:5},children:"Este entregador ser√° pr√©-selecionado ao criar novas rotas."})]}),e.jsx("hr",{style:{margin:"30px 0",border:"none",borderTop:"1px solid #ddd"}}),e.jsx("h3",{style:{marginBottom:20},children:"Ponto Inicial Padr√£o da Rota"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"CEP *"}),e.jsxs("div",{style:{display:"flex",gap:10},children:[e.jsx("input",{type:"text",value:r.cep.replace(/(\d{5})(\d)/,"$1-$2"),onChange:a=>{const o=a.target.value.replace(/\D/g,"");t({...r,cep:o.slice(0,8)})},placeholder:"00000-000",maxLength:9,style:{flex:1}}),e.jsx("button",{type:"button",onClick:v,disabled:p||r.cep.length<8,style:{padding:"0 20px",display:"flex",alignItems:"center",gap:5},children:p?"Buscando...":e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"üîç"}),"Buscar"]})})]}),e.jsx("p",{style:{fontSize:12,color:"#666",marginTop:5},children:"Digite o CEP e clique em Buscar para preencher automaticamente."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Logradouro (Rua/Avenida) *"}),e.jsx("input",{type:"text",value:r.logradouro,onChange:a=>t({...r,logradouro:a.target.value}),placeholder:"Ex: Rua das Flores"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:15},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"N√∫mero *"}),e.jsx("input",{type:"text",value:r.numero,onChange:a=>t({...r,numero:a.target.value}),placeholder:"123"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Complemento"}),e.jsx("input",{type:"text",value:r.complemento,onChange:a=>t({...r,complemento:a.target.value}),placeholder:"Ex: Loja 1"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Bairro *"}),e.jsx("input",{type:"text",value:r.bairro,onChange:a=>t({...r,bairro:a.target.value}),placeholder:"Ex: Centro"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:15},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Cidade *"}),e.jsx("input",{type:"text",value:r.cidade,onChange:a=>t({...r,cidade:a.target.value}),placeholder:"Ex: S√£o Paulo"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Estado *"}),e.jsx("input",{type:"text",value:r.estado,onChange:a=>{const o=a.target.value.toUpperCase().slice(0,2);t({...r,estado:o})},placeholder:"SP",maxLength:2})]})]}),e.jsx("p",{style:{fontSize:12,color:"#666",marginTop:15,marginBottom:20},children:"Este endere√ßo ser√° usado como ponto de partida para calcular as rotas de entrega."}),e.jsx("button",{type:"submit",disabled:l,style:{backgroundColor:"#2563eb",color:"white",padding:"12px 24px",border:"none",borderRadius:"6px",fontSize:"16px",fontWeight:"500",cursor:l?"not-allowed":"pointer",opacity:l?.6:1,transition:"all 0.2s"},onMouseOver:a=>{l||(a.target.style.backgroundColor="#1d4ed8")},onMouseOut:a=>{l||(a.target.style.backgroundColor="#2563eb")},children:l?"Salvando...":"Salvar Configura√ß√µes"})]})]})}export{_ as default};
