import{r as i,j as e,R as Y}from"./vendor-react-1772205603228.js";import{a as h}from"./index-1772205603228.js";const se=()=>{const[v,y]=i.useState([]),[I,$]=i.useState(!0),[A,E]=i.useState(!1),[L,D]=i.useState(null),[x,F]=i.useState([]),[N,w]=i.useState([]),[r,b]=i.useState(!1),[C,P]=i.useState(null);i.useEffect(()=>{g()},[]);const g=async()=>{try{$(!0);const c=await h.get("/comissoes/configuracoes/funcionarios");c.data.success&&y(c.data.data)}catch(c){console.error("Erro ao carregar funcion√°rios:",c),P("Erro ao carregar funcion√°rios com comiss√µes")}finally{$(!1)}},_=async(c=null)=>{D(c),E(!0),b(!0);try{const u=await h.get("/comissoes/arvore-produtos");if(u.data.success&&w(u.data.data),c){const j=await h.get(`/comissoes/configuracoes/funcionario/${c}`);j.data.success&&F(j.data.data)}}catch(u){console.error("Erro ao carregar dados:",u),P("Erro ao carregar dados de configura√ß√£o")}finally{b(!1)}},o=()=>{E(!1),D(null),F([]),w([]),g()},f=async c=>{const u=prompt("Digite o ID do funcion√°rio de destino:");if(u)try{const j=await h.post("/comissoes/configuracoes/duplicar",{funcionario_origem_id:parseInt(c),funcionario_destino_id:parseInt(u)});j.data.success&&(alert(j.data.message),g())}catch(j){console.error("Erro ao duplicar configura√ß√£o:",j),alert("Erro ao duplicar configura√ß√£o")}};return I?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Cadastro de Comiss√µes"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie as comiss√µes dos funcion√°rios"})]}),e.jsxs("button",{onClick:()=>_(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx("span",{children:"+"}),"Nova Comiss√£o"]})]})}),C&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:C}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:v.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx("p",{className:"text-lg mb-2",children:"Nenhuma comiss√£o configurada"}),e.jsx("p",{className:"text-sm",children:'Clique em "Nova Comiss√£o" para come√ßar'})]}):e.jsx("div",{className:"divide-y",children:v.map(c=>e.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>_(c.id),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-semibold",children:c.nome.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:c.nome}),e.jsx("p",{className:"text-sm text-gray-500",children:c.cargo})]})]}),e.jsxs("div",{className:"mt-2 flex gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[e.jsx("strong",{children:c.categorias})," categorias"]}),e.jsxs("span",{children:[e.jsx("strong",{children:c.subcategorias})," subcategorias"]}),e.jsxs("span",{children:[e.jsx("strong",{children:c.produtos})," produtos espec√≠ficos"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:u=>{u.stopPropagation(),_(c.id)},className:"px-3 py-1 text-blue-600 hover:bg-blue-50 rounded",children:"Editar"}),e.jsx("button",{onClick:u=>{u.stopPropagation(),f(c.id)},className:"px-3 py-1 text-gray-600 hover:bg-gray-100 rounded",title:"Duplicar configura√ß√£o para outro funcion√°rio",children:"Duplicar"})]})]})},c.id))})}),A&&e.jsx(Z,{funcionarioId:L,configuracoes:x,arvoreProdutos:N,loading:r,onClose:o,onSave:()=>{g(),o()}})]})},Z=({funcionarioId:v,configuracoes:y,arvoreProdutos:I,loading:$,onClose:A,onSave:E})=>{const[L,D]=i.useState([]),[x,F]=i.useState(v||""),[N,w]=i.useState(""),[r,b]=i.useState({desconta_taxa_cartao:!0,desconta_impostos:!0,desconta_taxa_entrega:!1,comissao_venda_parcial:!0}),[C,P]=i.useState({}),[g,_]=i.useState({}),[o,f]=i.useState(null),[c,u]=i.useState([]),[j,q]=i.useState(!1),[G,J]=i.useState({atual:0,total:0}),[p,V]=i.useState(null);i.useEffect(()=>{U()},[]),i.useEffect(()=>{const a={};if(y.forEach(s=>{const t=`${s.tipo}-${s.referencia_id}`;a[t]=s}),_(a),y.length>0){const s=y[0],t={desconta_taxa_cartao:s.desconta_taxa_cartao??!0,desconta_impostos:s.desconta_impostos??!0,desconta_taxa_entrega:s.desconta_custo_entrega??!1,comissao_venda_parcial:s.comissao_venda_parcial??!0};b(t),V(t)}},[y]);const U=async()=>{try{const a=await h.get("/comissoes/funcionarios");if(a.data.success&&(D(a.data.data),v)){const s=a.data.data.find(t=>t.id===parseInt(v));s&&s.data_fechamento_comissao&&w(String(s.data_fechamento_comissao))}}catch(a){console.error("Erro ao carregar funcion√°rios:",a)}},X=a=>{P(s=>({...s,[a]:!s[a]}))},R=(a,s,t)=>{const d=`${a}-${s}`,n=g[d];f({tipo:a,id:s,nome:t,tipo_calculo:(n==null?void 0:n.tipo_calculo)||"percentual",percentual:(n==null?void 0:n.percentual)||10,percentual_loja:(n==null?void 0:n.percentual_loja)||50,permite_edicao_venda:(n==null?void 0:n.permite_edicao_venda)||!1,observacoes:(n==null?void 0:n.observacoes)||""})},Q=()=>{if(!x){alert("Selecione um funcion√°rio");return}if(!o){alert("Selecione um item para configurar");return}if(c.some(t=>t.tipo===o.tipo&&t.referencia_id===o.id)){alert("Este item j√° foi adicionado √† lista!");return}if(o.tipo==="categoria"&&c.some(d=>(d.tipo==="subcategoria"||d.tipo==="produto")&&d.nome.includes(o.nome))&&!confirm(`‚ö†Ô∏è ATEN√á√ÉO: Voc√™ j√° configurou produtos/subcategorias desta categoria.

HIERARQUIA: Produto > Subcategoria > Categoria

A configura√ß√£o mais espec√≠fica tem prioridade.

Deseja adicionar mesmo assim?`))return;const s={tipo:o.tipo,referencia_id:o.id,nome:o.nome,tipo_calculo:o.tipo_calculo,percentual:parseFloat(o.percentual)||0,percentual_loja:o.tipo_calculo==="lucro"?parseFloat(o.percentual_loja)||0:null,permite_edicao_venda:o.permite_edicao_venda||!1,observacoes:o.observacoes||""};u([...c,s]),f(null),alert('Configura√ß√£o adicionada! Configure mais itens ou clique em "Salvar Todas"')},B=a=>{u(c.filter((s,t)=>t!==a))},K=async()=>{var a,s,t;if(!x){alert("Selecione um funcion√°rio");return}if(c.length===0){alert("Adicione pelo menos uma configura√ß√£o");return}q(!0);try{N&&await h.put(`/funcionarios/${x}`,{data_fechamento_comissao:parseInt(N)});const d=c.map(m=>({funcionario_id:parseInt(x),tipo:m.tipo,referencia_id:m.referencia_id,tipo_calculo:m.tipo_calculo,percentual:parseFloat(m.percentual)||0,percentual_loja:m.percentual_loja?parseFloat(m.percentual_loja):null,permite_edicao_venda:m.permite_edicao_venda||!1,observacoes:m.observacoes||"",desconta_taxa_cartao:r.desconta_taxa_cartao,desconta_impostos:r.desconta_impostos,desconta_taxa_entrega:r.desconta_taxa_entrega,comissao_venda_parcial:r.comissao_venda_parcial}));console.log("Enviando configura√ß√µes em batch:",d);const n=await h.post("/comissoes/configuracoes/batch",{configuracoes:d});if(console.log("Resposta do servidor:",n.data),n.data.success){if(alert(`‚úÖ ${n.data.total} configura√ß√µes salvas com sucesso!`),u([]),x)try{const m=await h.get(`/comissoes/configuracoes/funcionario/${x}`);if(m.data.success){const z={};m.data.data.forEach(l=>{const k=`${l.tipo}-${l.referencia_id}`;z[k]=l}),_(z)}}catch(m){console.error("Erro ao recarregar configura√ß√µes:",m)}E()}}catch(d){console.error("Erro ao salvar configura√ß√µes:",d),console.error("Resposta do servidor:",(a=d.response)==null?void 0:a.data);const n=((t=(s=d.response)==null?void 0:s.data)==null?void 0:t.detail)||d.message||"Erro desconhecido";alert(`‚ùå Erro ao salvar configura√ß√µes:

${n}`)}finally{q(!1),J({atual:0,total:0})}},H=async()=>{if(!x){alert("Selecione um funcion√°rio");return}if(!o){if(Object.keys(g).length===0){alert("Nenhuma configura√ß√£o encontrada para atualizar as regras.");return}if(!(p&&(r.desconta_taxa_cartao!==p.desconta_taxa_cartao||r.desconta_impostos!==p.desconta_impostos||r.desconta_taxa_entrega!==p.desconta_taxa_entrega||r.comissao_venda_parcial!==p.comissao_venda_parcial))){alert("Nenhuma altera√ß√£o detectada nas regras.");return}if(!confirm("Deseja atualizar as regras de c√°lculo em TODAS as configura√ß√µes deste funcion√°rio?"))return;try{console.log("üíæ SALVANDO REGRAS - Estado atual:",r);for(const[s,t]of Object.entries(g)){const d={funcionario_id:parseInt(x),tipo:t.tipo,referencia_id:t.referencia_id,tipo_calculo:t.tipo_calculo,percentual:parseFloat(t.percentual),percentual_loja:t.percentual_loja?parseFloat(t.percentual_loja):null,desconta_taxa_cartao:r.desconta_taxa_cartao,desconta_impostos:r.desconta_impostos,desconta_custo_entrega:r.desconta_taxa_entrega,comissao_venda_parcial:r.comissao_venda_parcial,permite_edicao_venda:t.permite_edicao_venda,observacoes:t.observacoes||""};console.log("üíæ Dados sendo enviados ao backend:",d),await h.post("/comissoes/configuracoes",d)}alert("‚úÖ Regras atualizadas com sucesso em todas as configura√ß√µes!"),V(r)}catch(s){console.error("Erro ao atualizar regras:",s),alert("Erro ao atualizar regras")}return}if(!o){alert("Selecione um item para configurar");return}try{const a={funcionario_id:parseInt(x),tipo:o.tipo,referencia_id:o.id,tipo_calculo:o.tipo_calculo,percentual:parseFloat(o.percentual),percentual_loja:o.tipo_calculo==="lucro"?parseFloat(o.percentual_loja):null,desconta_taxa_cartao:r.desconta_taxa_cartao,desconta_impostos:r.desconta_impostos,desconta_custo_entrega:r.desconta_taxa_entrega,comissao_venda_parcial:r.comissao_venda_parcial,permite_edicao_venda:o.permite_edicao_venda,observacoes:o.observacoes},s=await h.post("/comissoes/configuracoes",a);if(s.data.success){alert("Configura√ß√£o salva com sucesso!");const t=`${o.tipo}-${o.id}`;_(d=>({...d,[t]:{...a,id:s.data.config_id,nome_item:o.nome}})),f(null)}}catch(a){console.error("Erro ao salvar configura√ß√£o:",a),alert("Erro ao salvar configura√ß√£o")}},W=(a,s)=>{const t=`${a}-${s}`;return g[t]},T=(a,s)=>!!W(a,s),O=(a,s)=>c.some(t=>t.tipo===a&&t.referencia_id===s),M=(a,s=0)=>{const t="  ".repeat(s),d=s===0?"üì¶":"‚Üí",n=a.filhas&&a.filhas.length>0,m=a.produtos&&a.produtos.length>0;return T("categoria",a.id)?C[a.id]?e.jsxs(Y.Fragment,{children:[n&&a.filhas.map(l=>M(l,s+1)),m&&e.jsx("div",{className:"pl-6",style:{paddingLeft:`${24+s*20}px`},children:a.produtos.map(l=>{const k=T("produto",l.id),S=O("produto",l.id);return k?null:e.jsxs("div",{className:`p-2 flex items-center justify-between cursor-pointer hover:bg-gray-50 ${S?"bg-yellow-50":""}`,onClick:()=>R("produto",l.id,l.nome),children:[e.jsxs("span",{className:"text-sm",children:["üìå ",l.nome]}),S&&e.jsx("span",{className:"text-xs text-yellow-600",children:"‚è≥ Na lista"})]},`prod-${l.id}`)})})]},`cat-${a.id}`):null:e.jsxs("div",{className:"border-b last:border-b-0",children:[e.jsxs("div",{className:`p-3 flex items-center justify-between cursor-pointer hover:bg-gray-50 ${O("categoria",a.id)?"bg-yellow-50":""}`,style:{paddingLeft:`${12+s*20}px`},onClick:()=>R("categoria",a.id,`${t}${a.nome}`),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[(n||m)&&e.jsx("button",{onClick:l=>{l.stopPropagation(),X(a.id)},className:"text-gray-500",children:C[a.id]?"‚ñº":"‚ñ∂"}),e.jsxs("span",{className:s===0?"font-medium":"text-sm",children:[d," ",a.nome,s>0&&e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(N√≠vel ",s+1,")"]})]})]}),O("categoria",a.id)&&e.jsx("span",{className:"text-xs text-yellow-600",children:"‚è≥ Na lista"})]}),C[a.id]&&e.jsxs("div",{children:[n&&e.jsx("div",{children:a.filhas.map(l=>M(l,s+1))}),m&&e.jsx("div",{className:"pl-6",style:{paddingLeft:`${24+s*20}px`},children:a.produtos.map(l=>{const k=T("produto",l.id),S=O("produto",l.id);return k?null:e.jsxs("div",{className:`p-2 flex items-center justify-between cursor-pointer hover:bg-gray-50 ${S?"bg-yellow-50":""}`,onClick:()=>R("produto",l.id,l.nome),children:[e.jsxs("span",{className:"text-sm",children:["üìå ",l.nome]}),S&&e.jsx("span",{className:"text-xs text-yellow-600",children:"‚è≥ Na lista"})]},`prod-${l.id}`)})})]})]},`cat-${a.id}`)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Configura√ß√£o de Comiss√£o"}),e.jsx("button",{onClick:A,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Funcion√°rio"}),e.jsxs("select",{value:x,onChange:a=>F(a.target.value),className:"w-full border rounded-lg px-3 py-2",disabled:!!v,children:[e.jsx("option",{value:"",children:"Selecione um funcion√°rio"}),L.map(a=>e.jsxs("option",{value:a.id,children:[a.nome," - ",a.cargo]},a.id))]}),e.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded text-xs",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600",children:"‚ÑπÔ∏è"}),e.jsxs("div",{className:"text-blue-700",children:[e.jsx("strong",{children:"Apenas parceiros podem receber comiss√µes."}),e.jsx("br",{}),'Se a pessoa n√£o aparecer na lista, marque-a como "Parceiro" no cadastro de pessoas primeiro.']})]})})]}),x&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"üìÖ Dia do m√™s para fechamento de comiss√£o"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",min:"1",max:"31",value:N,onChange:a=>w(a.target.value),placeholder:"Ex: 5 (paga dia 5 de cada m√™s)",className:"flex-1 border rounded-lg px-3 py-2"}),e.jsx("button",{onClick:async()=>{try{await h.put(`/clientes/${x}`,{data_fechamento_comissao:N?parseInt(N):null}),alert("‚úÖ Data de fechamento salva com sucesso!")}catch(a){console.error("Erro ao salvar data:",a),alert("‚ùå Erro ao salvar data de fechamento")}},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 whitespace-nowrap",children:"üíæ Salvar Data"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Deixe em branco para pagamento 30 dias ap√≥s a venda (padr√£o)"})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Regras de C√°lculo"}),e.jsxs("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded text-sm",children:[e.jsx("div",{className:"font-semibold text-blue-800 mb-1",children:"üìã Hierarquia de Configura√ß√µes"}),e.jsxs("div",{className:"text-blue-700 text-xs",children:[e.jsx("strong",{children:"Produto"})," (prioridade m√°xima) ‚Üí ",e.jsx("strong",{children:"Subcategoria"})," ‚Üí ",e.jsx("strong",{children:"Categoria"})," (prioridade m√≠nima)",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600",children:"Ao vender um produto, o sistema busca a configura√ß√£o mais espec√≠fica."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.desconta_taxa_cartao,onChange:a=>{console.log("‚úÖ Checkbox TAXA CART√ÉO alterado para:",a.target.checked),b({...r,desconta_taxa_cartao:a.target.checked})},className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Desconta taxa de cart√£o"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.desconta_impostos,onChange:a=>{console.log("‚úÖ Checkbox IMPOSTOS alterado para:",a.target.checked),b({...r,desconta_impostos:a.target.checked})},className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Desconta impostos"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.desconta_taxa_entrega,onChange:a=>{console.log("‚úÖ Checkbox TAXA ENTREGA alterado para:",a.target.checked),b({...r,desconta_taxa_entrega:a.target.checked})},className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Desconta taxa de entrega"})]}),e.jsx("div",{className:"border-t pt-2 mt-3",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.comissao_venda_parcial,onChange:a=>{console.log("‚úÖ Checkbox VENDA PARCIAL alterado para:",a.target.checked),b({...r,comissao_venda_parcial:a.target.checked})},className:"rounded"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:"Gerar comiss√£o em vendas parciais"}),e.jsx("span",{className:"text-xs text-gray-500",children:r.comissao_venda_parcial?"Comiss√£o gerada proporcionalmente a cada pagamento recebido":"Comiss√£o gerada somente quando a venda estiver 100% paga"})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Sele√ß√£o de Produtos"}),Object.keys(g).length>0&&e.jsxs("div",{className:"mb-4 border rounded-lg p-3 bg-green-50",children:[e.jsxs("h4",{className:"text-sm font-semibold text-green-800 mb-2",children:["‚úÖ Itens J√° Configurados (",Object.keys(g).length,")"]}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:Object.entries(g).map(([a,s])=>e.jsxs("div",{className:"w-full flex items-center justify-between text-xs bg-white p-2 rounded hover:bg-gray-50 transition-colors group",children:[e.jsxs("button",{onClick:()=>R(s.tipo,s.referencia_id,s.nome_item||"Item"),className:"flex-1 flex items-center gap-2 text-left",children:[s.tipo==="categoria"&&"üì¶",s.tipo==="subcategoria"&&"üìÇ",s.tipo==="produto"&&"üìå",e.jsx("span",{className:"text-gray-700",children:s.nome_item||"Item"}),e.jsx("span",{className:"text-green-600 font-medium ml-auto",children:s.tipo_calculo==="percentual"?`${s.percentual}%`:`Lucro ${s.percentual}%`})]}),e.jsx("button",{onClick:async()=>{if(confirm(`Deseja remover a configura√ß√£o de "${s.nome_item||"Item"}"?`))try{await h.delete(`/comissoes/configuracoes/${s.id}`),alert("Configura√ß√£o removida com sucesso!");const t={...g};delete t[a],_(t)}catch(t){console.error("Erro ao remover:",t),alert("Erro ao remover configura√ß√£o")}},className:"ml-2 text-red-600 hover:text-red-800 opacity-0 group-hover:opacity-100 transition-opacity",children:"üóëÔ∏è"})]},a))}),e.jsx("p",{className:"text-xs text-green-700 mt-2 italic",children:"üí° Clique em um item para editar"})]}),$?e.jsx("div",{className:"text-center py-8",children:"Carregando..."}):e.jsx("div",{className:"border rounded-lg max-h-96 overflow-y-auto",children:I.map(a=>M(a,0))},Object.keys(g).length)]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Configura√ß√£o"}),o?e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-700",children:[o.tipo==="categoria"&&"üì¶ ",o.tipo==="subcategoria"&&"üìÇ ",o.tipo==="produto"&&"üìå ",o.nome]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Tipo: ",o.tipo]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo de Comiss√£o"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"percentual",checked:o.tipo_calculo==="percentual",onChange:a=>f({...o,tipo_calculo:a.target.value})}),e.jsx("span",{className:"text-sm",children:"Percentual fixo sobre venda"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"lucro",checked:o.tipo_calculo==="lucro",onChange:a=>f({...o,tipo_calculo:a.target.value})}),e.jsx("span",{className:"text-sm",children:"Divis√£o de lucro"})]})]})]}),o.tipo_calculo==="percentual"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Percentual"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:o.percentual,onChange:a=>f({...o,percentual:a.target.value}),className:"border rounded px-3 py-2 w-24"}),e.jsx("span",{children:"%"})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Divis√£o do Lucro"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Funcion√°rio"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"number",min:"0",max:"100",value:o.percentual,onChange:a=>{const s=parseFloat(a.target.value);f({...o,percentual:s,percentual_loja:100-s})},className:"border rounded px-2 py-1 w-20"}),e.jsx("span",{className:"text-sm",children:"%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Loja"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"number",value:o.percentual_loja,readOnly:!0,className:"border rounded px-2 py-1 w-20 bg-gray-100"}),e.jsx("span",{className:"text-sm",children:"%"})]})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"C√°lculo: Pre√ßo Venda - Desconto - Taxas - Impostos - Custo = Lucro"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.permite_edicao_venda,onChange:a=>f({...o,permite_edicao_venda:a.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Permite editar percentual na venda"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Observa√ß√µes"}),e.jsx("textarea",{value:o.observacoes,onChange:a=>f({...o,observacoes:a.target.value}),className:"border rounded px-3 py-2 w-full",rows:"3"})]}),e.jsx("button",{onClick:Q,className:"w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded mb-2",children:"‚ûï Adicionar √† Lista"}),e.jsx("button",{onClick:H,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded",children:"üíæ Salvar Agora"})]}):e.jsx("div",{className:"border rounded-lg p-8 text-center text-gray-500",children:e.jsx("p",{children:"Selecione uma categoria, subcategoria ou produto ao lado para configurar"})}),c.length>0&&e.jsxs("div",{className:"mt-6 border rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold mb-3",children:["Configura√ß√µes a Salvar (",c.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:c.map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:a.nome}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",a.tipo_calculo==="percentual"?`${a.percentual}%`:`Lucro ${a.percentual}%`,")"]})]}),e.jsx("button",{onClick:()=>B(s),className:"text-red-600 hover:text-red-800",children:"‚úï"})]},s))}),e.jsx("button",{onClick:K,disabled:j,className:`w-full py-2 rounded mt-4 text-white ${j?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:j?e.jsxs("span",{children:["‚è≥ Salvando ",G.atual,"/",G.total,"..."]}):"üíæ Salvar Todas as Configura√ß√µes"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["‚ÑπÔ∏è As configura√ß√µes se aplicam ",e.jsx("strong",{children:"apenas √†s comiss√µes futuras"}),". Comiss√µes j√° geradas n√£o s√£o alteradas."]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:A,className:"px-4 py-2 border rounded hover:bg-gray-50 bg-white",children:"Fechar"}),e.jsxs("button",{onClick:H,disabled:!o&&(!p||r.desconta_taxa_cartao===p.desconta_taxa_cartao&&r.desconta_impostos===p.desconta_impostos&&r.desconta_taxa_entrega===p.desconta_taxa_entrega&&r.comissao_venda_parcial===p.comissao_venda_parcial),className:`px-6 py-2 rounded font-medium ${o||p&&(r.desconta_taxa_cartao!==p.desconta_taxa_cartao||r.desconta_impostos!==p.desconta_impostos||r.desconta_taxa_entrega!==p.desconta_taxa_entrega||r.comissao_venda_parcial!==p.comissao_venda_parcial)?"bg-blue-600 hover:bg-blue-700 text-white cursor-pointer":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:["üíæ ",o?"Salvar Altera√ß√µes":"Atualizar Regras"]})]})]})})]})})};export{se as default};
