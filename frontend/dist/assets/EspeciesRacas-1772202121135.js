import{r,j as e,a9 as y,B as V,D as W,P as Y,ab as _,ac as $,ad as Z,y as L,T as z,ag as A}from"./vendor-react-1772202121135.js";import{a as l}from"./index-1772202121135.js";/* empty css                            */const te=()=>{const[G,T]=r.useState([]),[q,R]=r.useState(!0),[S,k]=r.useState(new Set),[B,w]=r.useState(!1),[I,F]=r.useState(!1),[N,g]=r.useState(null),[E,f]=r.useState(null),[D,P]=r.useState(null),[p,n]=r.useState(""),[x,O]=r.useState(""),[o,d]=r.useState({nome:"",ativo:!0}),[c,m]=r.useState({nome:"",especie_id:"",ativo:!0});r.useEffect(()=>{h()},[]);const h=async()=>{try{R(!0);const[a,s]=await Promise.all([l.get("/cadastros/especies"),l.get("/cadastros/racas")]),i=a.data.map(b=>({...b,racas:s.data.filter(U=>U.especie_id===b.id)}));T(i);const t=new Set(i.map(b=>b.id));k(t)}catch(a){console.error("Erro ao carregar dados:",a),n("Erro ao carregar dados")}finally{R(!1)}},H=a=>{const s=new Set(S);s.has(a)?s.delete(a):s.add(a),k(s)},M=(a=null)=>{a?(g(a),d({nome:a.nome,ativo:a.ativo})):(g(null),d({nome:"",ativo:!0})),n(""),w(!0)},u=()=>{w(!1),g(null),d({nome:"",ativo:!0}),n("")},X=async a=>{var s,i;if(a.preventDefault(),n(""),!o.nome||o.nome.trim()===""){n("O nome da espécie é obrigatório");return}try{N?await l.put(`/cadastros/especies/${N.id}`,o):await l.post("/cadastros/especies",o),h(),u()}catch(t){console.error("Erro ao salvar espécie:",t),n(((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.detail)||"Erro ao salvar espécie")}},J=async a=>{var s,i;if(window.confirm(`Deseja realmente desativar a espécie "${a.nome}"?

Isso também desativará todas as raças vinculadas.`))try{await l.delete(`/cadastros/especies/${a.id}`),h()}catch(t){console.error("Erro ao desativar espécie:",t),alert(((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.detail)||"Erro ao desativar espécie")}},C=(a,s=null)=>{P(a),s?(f(s),m({nome:s.nome,especie_id:s.especie_id,ativo:s.ativo})):(f(null),m({nome:"",especie_id:a.id,ativo:!0})),n(""),F(!0)},v=()=>{F(!1),f(null),P(null),m({nome:"",especie_id:"",ativo:!0}),n("")},K=async a=>{var s,i;if(a.preventDefault(),n(""),!c.nome||c.nome.trim()===""){n("O nome da raça é obrigatório");return}try{const t={nome:c.nome,especie_id:parseInt(c.especie_id),ativo:c.ativo};E?await l.put(`/cadastros/racas/${E.id}`,t):await l.post("/cadastros/racas",t),h(),v()}catch(t){console.error("Erro ao salvar raça:",t),n(((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.detail)||"Erro ao salvar raça")}},Q=async a=>{var s,i;if(window.confirm(`Deseja realmente desativar a raça "${a.nome}"?`))try{await l.delete(`/cadastros/racas/${a.id}`),h()}catch(t){console.error("Erro ao desativar raça:",t),alert(((i=(s=t.response)==null?void 0:s.data)==null?void 0:i.detail)||"Erro ao desativar raça")}},j=G.filter(a=>a.nome.toLowerCase().includes(x.toLowerCase())||a.racas.some(s=>s.nome.toLowerCase().includes(x.toLowerCase())));return q?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Carregando espécies e raças..."})]}):e.jsxs("div",{className:"cadastros-container",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Espécies e Raças"}),e.jsx("p",{className:"page-subtitle",children:"Gerencie as espécies de animais e suas raças"})]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>M(),children:[e.jsx(y,{})," Nova Espécie"]})]}),e.jsxs("div",{className:"filters-bar",children:[e.jsx("input",{type:"text",placeholder:"Buscar espécie ou raça...",value:x,onChange:a=>O(a.target.value),className:"search-input"}),e.jsxs("div",{className:"filter-info",children:[j.length," espécie",j.length!==1?"s":""]})]}),e.jsx("div",{className:"especies-list",children:j.length===0?e.jsx("div",{className:"empty-state",children:x?"Nenhuma espécie ou raça encontrada":"Nenhuma espécie cadastrada"}):j.map(a=>{const s=S.has(a.id),i=a.racas.filter(t=>t.ativo);return e.jsxs("div",{className:`especie-card ${a.ativo?"":"inactive"}`,children:[e.jsxs("div",{className:"especie-header",children:[e.jsxs("div",{className:"especie-info",onClick:()=>H(a.id),children:[e.jsx("button",{className:"expand-btn",children:s?e.jsx(V,{size:20}):e.jsx(W,{size:20})}),e.jsx(Y,{className:"especie-icon",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"especie-nome",children:a.nome}),e.jsxs("span",{className:"racas-count",children:[i.length," raça",i.length!==1?"s":""," ativa",i.length!==1?"s":""]})]}),!a.ativo&&e.jsx("span",{className:"badge badge-danger",children:"Inativa"})]}),e.jsxs("div",{className:"especie-actions",children:[e.jsx("button",{className:"btn-icon btn-success",onClick:()=>C(a),title:"Adicionar Raça",children:e.jsx(y,{})}),e.jsx("button",{className:"btn-icon btn-edit",onClick:()=>M(a),title:"Editar Espécie",children:e.jsx(_,{})}),a.ativo&&e.jsx("button",{className:"btn-icon btn-delete",onClick:()=>J(a),title:"Desativar Espécie",children:e.jsx($,{})})]})]}),s&&e.jsx("div",{className:"racas-list",children:a.racas.length===0?e.jsxs("div",{className:"empty-racas",children:[e.jsx("p",{children:"Nenhuma raça cadastrada ainda"}),e.jsxs("button",{className:"btn btn-sm btn-primary",onClick:()=>C(a),children:[e.jsx(y,{})," Adicionar Primeira Raça"]})]}):e.jsx(e.Fragment,{children:a.racas.map(t=>e.jsxs("div",{className:`raca-item ${t.ativo?"":"inactive"}`,children:[e.jsxs("div",{className:"raca-info",children:[e.jsx(Z,{className:"raca-icon",size:16}),e.jsx("span",{className:"raca-nome",children:t.nome}),!t.ativo&&e.jsx("span",{className:"badge badge-sm badge-danger",children:"Inativa"})]}),e.jsxs("div",{className:"raca-actions",children:[e.jsx("button",{className:"btn-icon-sm btn-edit",onClick:()=>C(a,t),title:"Editar Raça",children:e.jsx(_,{size:14})}),t.ativo&&e.jsx("button",{className:"btn-icon-sm btn-delete",onClick:()=>Q(t),title:"Desativar Raça",children:e.jsx($,{size:14})})]})]},t.id))})})]},a.id)})}),B&&e.jsx("div",{className:"modal-overlay",onClick:u,children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:N?"Editar Espécie":"Nova Espécie"}),e.jsx("button",{className:"btn-close",onClick:u,children:e.jsx(L,{})})]}),e.jsxs("form",{onSubmit:X,children:[e.jsxs("div",{className:"modal-body",children:[p&&e.jsxs("div",{className:"alert alert-danger",children:[e.jsx(z,{})," ",p]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nome da Espécie *"}),e.jsx("input",{type:"text",value:o.nome,onChange:a=>d({...o,nome:a.target.value}),placeholder:"Ex: Cão, Gato, Ave, Réptil...",required:!0,autoFocus:!0}),e.jsx("small",{children:"Exemplos: Cão, Gato, Ave, Réptil, Coelho, Peixe, Hamster"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:o.ativo,onChange:a=>d({...o,ativo:a.target.checked})}),e.jsx("span",{children:"Espécie ativa"})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:u,children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx(A,{})," Salvar"]})]})]})]})}),I&&e.jsx("div",{className:"modal-overlay",onClick:v,children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:[E?"Editar Raça":"Nova Raça",D&&e.jsxs("span",{className:"subtitle",children:[" - ",D.nome]})]}),e.jsx("button",{className:"btn-close",onClick:v,children:e.jsx(L,{})})]}),e.jsxs("form",{onSubmit:K,children:[e.jsxs("div",{className:"modal-body",children:[p&&e.jsxs("div",{className:"alert alert-danger",children:[e.jsx(z,{})," ",p]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nome da Raça *"}),e.jsx("input",{type:"text",value:c.nome,onChange:a=>m({...c,nome:a.target.value}),placeholder:"Ex: Labrador, Siamês, SRD...",required:!0,autoFocus:!0}),e.jsx("small",{children:"Exemplos: Labrador, Golden Retriever, SRD (Sem Raça Definida)"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:c.ativo,onChange:a=>m({...c,ativo:a.target.checked})}),e.jsx("span",{children:"Raça ativa"})]})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:v,children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"btn btn-primary",children:[e.jsx(A,{})," Salvar"]})]})]})]})})]})};export{te as default};
