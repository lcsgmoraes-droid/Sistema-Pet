import{r as h,j as e,aF as de,bz as A,aS as ce,bA as me,aG as _,ak as P,b4 as ae,aj as $,an as F,by as re,aA as xe,bB as ue,aP as f,d as he,am as ge}from"./vendor-react-1772318170511.js";import{a as v,u as be}from"./index-1772318170511.js";import{R as je,A as pe,C as V,X as W,Y as Q,T as Z,a as H,f as X,b as J,L as fe}from"./vendor-charts-1772318170511.js";import{t as B,c as Ne,m as ie,a as le,f as ye,p as ve}from"./pt-BR-1772318170511.js";const we=t=>{const s={critico:"bg-red-100 text-red-800 border-red-200",alerta:"bg-yellow-100 text-yellow-800 border-yellow-200",ok:"bg-green-100 text-green-800 border-green-200"};return s[t]||s.ok},Ce=t=>t==="critico"?e.jsx($,{className:"w-5 h-5"}):t==="alerta"?e.jsx($,{className:"w-5 h-5"}):e.jsx(F,{className:"w-5 h-5"}),Se=t=>t==="melhorando"?e.jsx(_,{className:"w-5 h-5 text-green-600"}):t==="piorando"?e.jsx(P,{className:"w-5 h-5 text-red-600"}):e.jsx(ae,{className:"w-5 h-5 text-gray-600"});function Ae({indices:t}){const[s,a]=h.useState(null);if(!t)return e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Nenhum Ã­ndice disponÃ­vel"});const{saldo_atual:r,dias_de_caixa:i,status:n,tendencia:l,score_saude:d,receita_mensal_estimada:x,despesa_mensal_estimada:o,percentual_variacao_7d:m}=t;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(de,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"relative",children:[Se(l),e.jsx("button",{onMouseEnter:()=>a("saldo"),onMouseLeave:()=>a(null),className:"ml-2 text-gray-400 hover:text-gray-600",children:e.jsx(A,{className:"w-4 h-4"})}),s==="saldo"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Saldo Atual"}),e.jsx("p",{children:"Seu saldo de caixa real neste momento. O nÃºmero verde ao lado mostra a variaÃ§Ã£o dos Ãºltimos 7 dias."})]})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Saldo Atual"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r||0)}),m&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[m>0?"+":"",m.toFixed(1),"% em 7 dias"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(ce,{className:"w-6 h-6 text-purple-600"})}),e.jsx("button",{onMouseEnter:()=>a("dias"),onMouseLeave:()=>a(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(A,{className:"w-4 h-4"})}),s==="dias"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Dias de Caixa"}),e.jsx("p",{children:"Quantos dias vocÃª consegue pagar as despesas com seu saldo atual. Se tem R$ 10.000 e gasta R$ 1.000/dia = 10 dias."})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Dias de Caixa"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(i==null?void 0:i.toFixed(1))||"0.0"," dias"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:i<7?"CrÃ­tico - menos de 1 semana":i<15?"Alerta - menos de 2 semanas":"SaudÃ¡vel"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${we(n)}`,children:Ce(n)}),e.jsx("button",{onMouseEnter:()=>a("status"),onMouseLeave:()=>a(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(A,{className:"w-4 h-4"})}),s==="status"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Status"}),e.jsxs("p",{children:[e.jsx("strong",{children:"CRITICO:"})," <7 dias (risco iminente). ",e.jsx("strong",{children:"ALERTA:"})," 7-15 dias. ",e.jsx("strong",{children:"OK:"})," >15 dias."]})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Status"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 capitalize",children:n||"N/A"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1 capitalize",children:["TendÃªncia: ",l||"estÃ¡vel"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative group",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(me,{className:"w-6 h-6 text-green-600"})}),e.jsx("button",{onMouseEnter:()=>a("score"),onMouseLeave:()=>a(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(A,{className:"w-4 h-4"})}),s==="score"&&e.jsxs("div",{className:"absolute -right-40 top-8 bg-gray-900 text-white text-xs rounded p-2 w-48 z-10 whitespace-normal",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Score de SaÃºde"}),e.jsx("p",{children:"Nota de 0-100 que resume a saÃºde financeira. Considera dias de caixa, tendÃªncia e volatilidade."})]})]}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Score de SaÃºde"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(d==null?void 0:d.toFixed(0))||"0","/100"]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${d>=70?"bg-green-600":d>=40?"bg-yellow-600":"bg-red-600"}`,style:{width:`${d||0}%`}})})]}),x&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(_,{className:"w-6 h-6 text-green-600"})})}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Receita Mensal"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Estimativa"})]}),o&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-red-600"})})}),e.jsx("h3",{className:"text-gray-600 text-sm font-medium mb-1",children:"Despesa Mensal"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Estimativa"})]})]})}function De(t,s){const a=()=>Ne(s==null?void 0:s.in,NaN),i=$e(t);let n;if(i.date){const o=_e(i.date,2);n=Pe(o.restDateString,o.year)}if(!n||isNaN(+n))return a();const l=+n;let d=0,x;if(i.time&&(d=Fe(i.time),isNaN(d)))return a();if(i.timezone){if(x=Te(i.timezone),isNaN(x))return a()}else{const o=new Date(l+d),m=B(0,s==null?void 0:s.in);return m.setFullYear(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate()),m.setHours(o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds(),o.getUTCMilliseconds()),m}return B(l+d+x,s==null?void 0:s.in)}const D={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ie=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ke=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Re=/^([+-])(\d{2})(?::?(\d{2}))?$/;function $e(t){const s={},a=t.split(D.dateTimeDelimiter);let r;if(a.length>2)return s;if(/:/.test(a[0])?r=a[0]:(s.date=a[0],r=a[1],D.timeZoneDelimiter.test(s.date)&&(s.date=t.split(D.timeZoneDelimiter)[0],r=t.substr(s.date.length,t.length))),r){const i=D.timezone.exec(r);i?(s.time=r.replace(i[1],""),s.timezone=i[1]):s.time=r}return s}function _e(t,s){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=t.match(a);if(!r)return{year:NaN,restDateString:""};const i=r[1]?parseInt(r[1]):null,n=r[2]?parseInt(r[2]):null;return{year:n===null?i:n*100,restDateString:t.slice((r[1]||r[2]).length)}}function Pe(t,s){if(s===null)return new Date(NaN);const a=t.match(Ie);if(!a)return new Date(NaN);const r=!!a[4],i=y(a[1]),n=y(a[2])-1,l=y(a[3]),d=y(a[4]),x=y(a[5])-1;if(r)return ze(s,d,x)?Ee(s,d,x):new Date(NaN);{const o=new Date(0);return!Oe(s,n,l)||!Le(s,i)?new Date(NaN):(o.setUTCFullYear(s,n,Math.max(i,l)),o)}}function y(t){return t?parseInt(t):1}function Fe(t){const s=t.match(ke);if(!s)return NaN;const a=R(s[1]),r=R(s[2]),i=R(s[3]);return Ue(a,r,i)?a*ie+r*le+i*1e3:NaN}function R(t){return t&&parseFloat(t.replace(",","."))||0}function Te(t){if(t==="Z")return 0;const s=t.match(Re);if(!s)return 0;const a=s[1]==="+"?-1:1,r=parseInt(s[2]),i=s[3]&&parseInt(s[3])||0;return qe(r,i)?a*(r*ie+i*le):NaN}function Ee(t,s,a){const r=new Date(0);r.setUTCFullYear(t,0,4);const i=r.getUTCDay()||7,n=(s-1)*7+a+1-i;return r.setUTCDate(r.getUTCDate()+n),r}const Me=[31,null,31,30,31,30,31,31,30,31,30,31];function oe(t){return t%400===0||t%4===0&&t%100!==0}function Oe(t,s,a){return s>=0&&s<=11&&a>=1&&a<=(Me[s]||(oe(t)?29:28))}function Le(t,s){return s>=1&&s<=(oe(t)?366:365)}function ze(t,s,a){return s>=1&&s<=53&&a>=0&&a<=6}function Ue(t,s,a){return t===24?s===0&&a===0:a>=0&&a<60&&s>=0&&s<60&&t>=0&&t<25}function qe(t,s){return s>=0&&s<=59}const N=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(t),ne=t=>{try{const s=De(t);return ye(s,"dd/MMM",{locale:ve})}catch{return t}},ee=({active:t,payload:s})=>{if(!t||!s||!s.length)return null;const a=s[0].payload;return e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg border border-gray-200",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:ne(a.data_projetada)}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-blue-600",children:["Saldo: ",e.jsx("strong",{children:N(a.saldo_estimado)})]}),a.limite_superior&&e.jsxs("p",{className:"text-green-600",children:["Otimista: ",N(a.limite_superior)]}),a.limite_inferior&&e.jsxs("p",{className:"text-red-600",children:["Pessimista: ",N(a.limite_inferior)]}),a.alerta_nivel&&e.jsxs("p",{className:`font-medium ${a.alerta_nivel==="critico"?"text-red-600":a.alerta_nivel==="alerta"?"text-yellow-600":"text-green-600"}`,children:["Status: ",a.alerta_nivel]})]})]})};function I({projecoes:t,titulo:s="ProjeÃ§Ã£o de Fluxo de Caixa",detalhado:a=!1}){var n,l,d,x,o,m;if(!t||t.length===0)return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s}),e.jsx("div",{className:"text-center py-8 text-gray-500",children:'Nenhuma projeÃ§Ã£o disponÃ­vel. Clique em "Atualizar ProjeÃ§Ã£o" para gerar.'})]});const r=t.map(c=>({...c,data_formatada:ne(c.data_projetada),saldo:c.saldo_estimado||0,superior:c.limite_superior||null,inferior:c.limite_inferior||null})),i=r.some(c=>c.superior!==null||c.inferior!==null);return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:s}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Saldo Inicial"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:N(((n=r[0])==null?void 0:n.saldo)||0)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Saldo Final"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:N(((l=r[r.length-1])==null?void 0:l.saldo)||0)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"VariaÃ§Ã£o"}),e.jsx("p",{className:`text-lg font-bold ${((d=r[r.length-1])==null?void 0:d.saldo)-((x=r[0])==null?void 0:x.saldo)>=0?"text-green-600":"text-red-600"}`,children:N((((o=r[r.length-1])==null?void 0:o.saldo)||0)-(((m=r[0])==null?void 0:m.saldo)||0))})]})]}),e.jsx(je,{width:"100%",height:a?400:300,children:i?e.jsxs(pe,{data:r,children:[e.jsx(V,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(W,{dataKey:"data_formatada",stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(Q,{stroke:"#6b7280",style:{fontSize:"12px"},tickFormatter:c=>`R$ ${(c/1e3).toFixed(0)}k`}),e.jsx(Z,{content:e.jsx(ee,{})}),e.jsx(H,{}),e.jsx(X,{type:"monotone",dataKey:"superior",stroke:"#10b981",fill:"#d1fae5",fillOpacity:.3,name:"CenÃ¡rio Otimista"}),e.jsx(X,{type:"monotone",dataKey:"inferior",stroke:"#ef4444",fill:"#fee2e2",fillOpacity:.3,name:"CenÃ¡rio Pessimista"}),e.jsx(J,{type:"monotone",dataKey:"saldo",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},name:"Saldo Estimado"})]}):e.jsxs(fe,{data:r,children:[e.jsx(V,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(W,{dataKey:"data_formatada",stroke:"#6b7280",style:{fontSize:"12px"}}),e.jsx(Q,{stroke:"#6b7280",style:{fontSize:"12px"},tickFormatter:c=>`R$ ${(c/1e3).toFixed(0)}k`}),e.jsx(Z,{content:e.jsx(ee,{})}),e.jsx(H,{}),e.jsx(J,{type:"monotone",dataKey:"saldo",stroke:"#3b82f6",strokeWidth:3,dot:{r:4,fill:"#3b82f6"},name:"Saldo Estimado"})]})}),r.some(c=>c.vai_faltar_caixa)&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 font-medium",children:"âš ï¸ AtenÃ§Ã£o: ProjeÃ§Ã£o indica que o caixa pode ficar negativo nos prÃ³ximos dias!"})})]})}const Ye=t=>{const s={critico:{icon:$,bgColor:"bg-red-50",borderColor:"border-red-200",textColor:"text-red-800",iconColor:"text-red-600"},alerta:{icon:xe,bgColor:"bg-yellow-50",borderColor:"border-yellow-200",textColor:"text-yellow-800",iconColor:"text-yellow-600"},aviso:{icon:re,bgColor:"bg-blue-50",borderColor:"border-blue-200",textColor:"text-blue-800",iconColor:"text-blue-600"},info:{icon:F,bgColor:"bg-green-50",borderColor:"border-green-200",textColor:"text-green-800",iconColor:"text-green-600"}};return s[t]||s.info};function se({alertas:t}){if(!t||t.length===0)return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Alertas do Caixa"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"w-12 h-12 text-green-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum alerta no momento"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Seu caixa estÃ¡ saudÃ¡vel! ğŸ‰"})]})]});const s={critico:0,alerta:1,aviso:2,info:3},a=[...t].sort((r,i)=>(s[r.tipo]||3)-(s[i.tipo]||3));return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Alertas do Caixa"}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-sm rounded-full",children:a.length})]}),e.jsx("div",{className:"space-y-3",children:a.map((r,i)=>{const n=Ye(r.tipo),l=n.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${n.bgColor} ${n.borderColor}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(l,{className:`w-5 h-5 flex-shrink-0 mt-0.5 ${n.iconColor}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-medium ${n.textColor} mb-1`,children:r.titulo}),e.jsx("p",{className:`text-sm ${n.textColor} opacity-90`,children:r.mensagem}),r.data&&e.jsx("p",{className:`text-xs ${n.textColor} opacity-70 mt-2`,children:new Date(r.data).toLocaleString("pt-BR")})]})]})},i)})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-red-600",children:a.filter(r=>r.tipo==="critico").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"CrÃ­ticos"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:a.filter(r=>r.tipo==="alerta").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Alertas"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a.filter(r=>r.tipo==="aviso").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Avisos"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.filter(r=>r.tipo==="info").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Infos"})]})]})]})}const te=[{id:"otimista",nome:"Otimista",descricao:"Aumento de 20% nas receitas e reduÃƒÂ§ÃƒÂ£o de 10% nas despesas",icon:_,color:"green"},{id:"realista",nome:"Realista",descricao:"MantÃƒÂ©m o padrÃƒÂ£o atual de receitas e despesas",icon:ae,color:"blue"},{id:"pessimista",nome:"Pessimista",descricao:"ReduÃƒÂ§ÃƒÂ£o de 20% nas receitas e aumento de 10% nas despesas",icon:P,color:"red"}];function Ke({userId:t,projecoesBase:s=[]}){var m,c,w,b,g,j,C,S,T,E,M,O,L,z,U,q,Y,K,G;const[a,r]=h.useState("realista"),[i,n]=h.useState(!1),[l,d]=h.useState(null),x=async()=>{n(!0);try{const k={Authorization:`Bearer ${localStorage.getItem("access_token")||localStorage.getItem("token")}`},p=await v.post(`/api/ia/fluxo/simular-cenario/${t}`,{cenario:a},{headers:k});d(p.data),f.success(`CenÃƒÂ¡rio ${a} simulado com sucesso!`)}catch(u){console.error("Erro ao simular cenÃƒÂ¡rio:",u),f.error("Erro ao simular cenÃƒÂ¡rio")}finally{n(!1)}},o=te.find(u=>u.id===a);return o==null||o.icon,e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Simulador de CenÃƒÂ¡rios"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Simule diferentes cenÃƒÂ¡rios para entender o impacto no seu fluxo de caixa"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:te.map(u=>{const k=u.icon,p=a===u.id;return e.jsxs("button",{onClick:()=>r(u.id),className:`p-4 rounded-lg border-2 transition-all text-left ${p?`border-${u.color}-500 bg-${u.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(k,{className:`w-6 h-6 ${p?`text-${u.color}-600`:"text-gray-400"}`}),e.jsx("h4",{className:`font-semibold ${p?`text-${u.color}-900`:"text-gray-900"}`,children:u.nome})]}),e.jsx("p",{className:`text-sm ${p?`text-${u.color}-700`:"text-gray-600"}`,children:u.descricao})]},u.id)})}),e.jsx("button",{onClick:x,disabled:i,className:"w-full md:w-auto px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Simulando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-5 h-5"}),"Simular CenÃƒÂ¡rio"]})})]}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["ComparaÃƒÂ§ÃƒÂ£o: Base vs ",o==null?void 0:o.nome]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"CenÃƒÂ¡rio Atual"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Saldo Final"}),e.jsx("span",{className:"font-semibold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(((m=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:m.saldo_estimado)||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"VariaÃƒÂ§ÃƒÂ£o"}),e.jsx("span",{className:"font-semibold text-gray-900",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((((c=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:c.saldo_estimado)||0)-(((w=s==null?void 0:s[0])==null?void 0:w.saldo_estimado)||0))})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-700 mb-3",children:["CenÃƒÂ¡rio ",o==null?void 0:o.nome]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Saldo Final"}),e.jsx("span",{className:`font-semibold ${a==="otimista"?"text-green-600":a==="pessimista"?"text-red-600":"text-blue-600"}`,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(((j=(g=l==null?void 0:l.projecoes_ajustadas)==null?void 0:g[((b=l==null?void 0:l.projecoes_ajustadas)==null?void 0:b.length)-1])==null?void 0:j.saldo_ajustado)||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"VariaÃƒÂ§ÃƒÂ£o"}),e.jsx("span",{className:`font-semibold ${a==="otimista"?"text-green-600":a==="pessimista"?"text-red-600":"text-blue-600"}`,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((((T=(S=l==null?void 0:l.projecoes_ajustadas)==null?void 0:S[((C=l==null?void 0:l.projecoes_ajustadas)==null?void 0:C.length)-1])==null?void 0:T.saldo_ajustado)||0)-(((M=(E=l==null?void 0:l.projecoes_ajustadas)==null?void 0:E[0])==null?void 0:M.saldo_ajustado)||0))})]})]})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"DiferenÃƒÂ§a no Saldo Final"}),e.jsx("span",{className:`text-xl font-bold ${(((z=(L=l==null?void 0:l.projecoes_ajustadas)==null?void 0:L[((O=l==null?void 0:l.projecoes_ajustadas)==null?void 0:O.length)-1])==null?void 0:z.saldo_ajustado)||0)>(((U=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:U.saldo_estimado)||0)?"text-green-600":"text-red-600"}`,children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format((((K=(Y=l==null?void 0:l.projecoes_ajustadas)==null?void 0:Y[((q=l==null?void 0:l.projecoes_ajustadas)==null?void 0:q.length)-1])==null?void 0:K.saldo_ajustado)||0)-(((G=s==null?void 0:s[(s==null?void 0:s.length)-1])==null?void 0:G.saldo_estimado)||0))})]})})]}),e.jsx(I,{projecoes:(l==null?void 0:l.projecoes_ajustadas)||[],titulo:`ProjeÃƒÂ§ÃƒÂ£o - CenÃƒÂ¡rio ${o==null?void 0:o.nome}`,detalhado:!0})]}),!l&&s&&s.length>0&&e.jsx(I,{projecoes:s,titulo:"ProjeÃƒÂ§ÃƒÂ£o Atual (CenÃƒÂ¡rio Base)",detalhado:!0})]})}function Ge(){const[t,s]=h.useState(!1),a=[{titulo:"Dias de Caixa",descricao:"Quantos dias seu caixa consegue cobrir as despesas com o saldo atual. Se tem R$ 10.000 e gasta R$ 1.000/dia, terÃ¡ 10 dias de caixa.",formula:"Saldo Atual Ã· Despesa MÃ©dia DiÃ¡ria",referencia:"Ãšltimos 30 dias"},{titulo:"Saldo Estimado (ProjeÃ§Ã£o)",descricao:"PrevisÃ£o do saldo do caixa para os prÃ³ximos 15 dias, calculada usando inteligÃªncia artificial (Prophet) baseada em histÃ³rico de 30+ dias.",formula:"Saldo Atual + Receitas Previstas - Despesas Previstas",referencia:"PrÃ³ximos 15 dias"},{titulo:"Entrada/SaÃ­da Estimada",descricao:"PrevisÃ£o diÃ¡ria de quanto vocÃª deve receber (entradas) e gastar (saÃ­das) nos prÃ³ximos dias.",formula:"MÃ©dia histÃ³rica Ã· 30 dias Ã— fator sazonalidade",referencia:"PrÃ³ximos 15 dias"},{titulo:"Status do Caixa",descricao:"ClassificaÃ§Ã£o da saÃºde financeira: CRITICO (<7 dias), ALERTA (7-15 dias) ou OK (>15 dias)",formula:'Status = IF(dias_caixa < 7) "CRITICO" ELSE IF(dias_caixa < 15) "ALERTA" ELSE "OK"',referencia:"Dados em tempo real"}],r=[{nome:"VisÃ£o Geral",conteudo:"Mostra os Ã­ndices principais de saÃºde do caixa: quanto tempo de saldo vocÃª tem, a tendÃªncia (melhorando/piorando), despesa mÃ©dia diÃ¡ria e score geral de saÃºde.",periodo:"Ãšltimos 30 dias de histÃ³rico"},{nome:"ProjeÃ§Ãµes 15 Dias",conteudo:"GrÃ¡fico e tabela com a previsÃ£o de saldo diÃ¡rio para os prÃ³ximos 15 dias. Usa algoritmo Prophet com inteligÃªncia artificial.",periodo:"PrÃ³ximos 15 dias a partir de hoje"},{nome:"Alertas",conteudo:"Lista automÃ¡tica de avisos: se o caixa estÃ¡ crÃ­tico, se hÃ¡ risco de falta de saldo, ou se a tendÃªncia estÃ¡ piorando.",periodo:"Monitoramento contÃ­nuo"},{nome:"Simulador",conteudo:"Permite simular 3 cenÃ¡rios: OTIMISTA (+20% receita, -10% despesa), REALISTA (sem mudanÃ§as) e PESSIMISTA (-20% receita, +10% despesa).",periodo:"PrÃ³ximos 15 dias com mudanÃ§as aplicadas"}];return e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-6",children:[e.jsxs("button",{onClick:()=>s(!t),className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Entenda os Dados"})]}),e.jsx(he,{className:`w-5 h-5 text-blue-600 transition-transform ${t?"rotate-180":""}`})]}),t&&e.jsxs("div",{className:"mt-6 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"O que cada aba mostra?"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((i,n)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:i.nome}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:i.conteudo}),e.jsxs("p",{className:"text-xs text-blue-600 font-medium",children:["ğŸ“… ",i.periodo]})]},n))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"MÃ©tricas Explicadas"}),e.jsx("div",{className:"space-y-4",children:a.map((i,n)=>e.jsx("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-blue-600",children:n+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:i.titulo}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:i.descricao}),e.jsxs("div",{className:"mt-2 text-xs space-y-1",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("strong",{children:"CÃ¡lculo:"})," ",i.formula]}),e.jsxs("p",{className:"text-blue-600",children:[e.jsx("strong",{children:"PerÃ­odo:"})," ",i.referencia]})]})]})]})},n))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"Perguntas Frequentes"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:'â“ Qual perÃ­odo a "VisÃ£o Geral" estÃ¡ analisando?'}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Os Ãºltimos ",e.jsx("strong",{children:"30 dias"})," de movimentaÃ§Ãµes realizadas. Ela calcula a despesa mÃ©dia desse perÃ­odo para determinar quantos dias de caixa vocÃª tem."]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:"â“ O grÃ¡fico de ProjeÃ§Ãµes Ã© confiÃ¡vel?"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Usa algoritmo Prophet (inteligÃªncia artificial) que aprende com os Ãºltimos ",e.jsx("strong",{children:"30+ dias"})," de dados. Quanto mais histÃ³rico, mais preciso. Funciona bem para tendÃªncias, mas nÃ£o prevÃª eventos inesperados."]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:"â“ O Simulador altera meus dados reais?"}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"NÃƒO!"}),' Ã‰ apenas uma simulaÃ§Ã£o. Mostra "E se..." ocorressem essas mudanÃ§as. Seus dados permanecem intactos.']})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:'â“ Como interpretar "Dias de Caixa"?'}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"10 dias"})," = vocÃª pode cobrir ",e.jsx("strong",{children:"10 dias de despesas"})," com saldo atual. Se ",e.jsx("strong",{children:"<7 dias"})," Ã© crÃ­tico (risco iminente). Se ",e.jsx("strong",{children:"7-15"})," Ã© alerta. Se ",e.jsx("strong",{children:">15"})," estÃ¡ ok."]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[e.jsx("p",{className:"font-semibold text-gray-900 text-sm mb-1",children:'â“ Qual Ã© a diferenÃ§a entre "Saldo Atual" e "Saldo Estimado"?'}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Saldo Atual"})," = saldo real hoje. ",e.jsx("strong",{children:"Saldo Estimado"})," = previsÃ£o do saldo daqui a X dias (levando em conta receitas/despesas esperadas)."]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-300 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"ğŸ’¡ Dicas Importantes:"}),e.jsxs("ul",{className:"text-sm text-blue-900 space-y-1",children:[e.jsxs("li",{children:["â€¢ Clique em ",e.jsx("strong",{children:'"Atualizar ProjeÃ§Ã£o"'})," para recalcular com dados mais recentes"]}),e.jsx("li",{children:"â€¢ Os Alertas aparecem automaticamente quando hÃ¡ risco (caixa <7 dias ou tendÃªncia negativa)"}),e.jsx("li",{children:'â€¢ Use o Simulador para planejar: "E se aumentar despesas de marketing em 20%?"'}),e.jsx("li",{children:"â€¢ Se tiver menos de 30 dias de histÃ³rico, as projeÃ§Ãµes serÃ£o mais conservadoras"})]})]})]})]})}function Ve({userId:t}){const[s,a]=h.useState(!0),[r,i]=h.useState(null),[n,l]=h.useState([]),[d,x]=h.useState([]),[o,m]=h.useState("visao-geral");h.useEffect(()=>{c()},[t]);const c=async()=>{a(!0);try{const g={Authorization:`Bearer ${localStorage.getItem("access_token")||localStorage.getItem("token")}`},[j,C,S]=await Promise.all([v.get(`/ia/fluxo/indices-saude/${t}`,{headers:g}),v.get(`/ia/fluxo/projecoes/${t}?dias=15`,{headers:g}),v.get(`/ia/fluxo/alertas/${t}`,{headers:g})]);i(j.data),l(C.data||[]),x(S.data||[])}catch(b){console.error("Erro ao carregar dados IA:",b),f.error("Erro ao carregar dados da IA")}finally{a(!1)}},w=async()=>{const b=f.loading("Gerando projeÃƒÂ§ÃƒÂ£o com Prophet...");try{const j={Authorization:`Bearer ${localStorage.getItem("access_token")||localStorage.getItem("token")}`};await v.post(`/ia/fluxo/projetar-15-dias/${t}`,{},{headers:j}),f.success("ProjeÃƒÂ§ÃƒÂ£o gerada com sucesso!",{id:b}),c()}catch(g){console.error("Erro ao gerar projeÃƒÂ§ÃƒÂ£o:",g),f.error("Erro ao gerar projeÃƒÂ§ÃƒÂ£o",{id:b})}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ge,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ã°Å¸Â¤â€“ Fluxo de Caixa Preditivo"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"InteligÃƒÂªncia artificial analisando seu caixa"})]}),e.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4"}),"Atualizar ProjeÃƒÂ§ÃƒÂ£o"]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[e.jsx("button",{onClick:()=>m("visao-geral"),className:`px-4 py-2 font-medium transition-colors ${o==="visao-geral"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"VisÃƒÂ£o Geral"}),e.jsx("button",{onClick:()=>m("projecoes"),className:`px-4 py-2 font-medium transition-colors ${o==="projecoes"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"ProjeÃƒÂ§ÃƒÂµes 15 Dias"}),e.jsxs("button",{onClick:()=>m("alertas"),className:`px-4 py-2 font-medium transition-colors relative ${o==="alertas"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Alertas",d.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:d.length})]}),e.jsx("button",{onClick:()=>m("simulador"),className:`px-4 py-2 font-medium transition-colors ${o==="simulador"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Simulador"})]}),e.jsxs("div",{className:"space-y-6",children:[o==="visao-geral"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border-l-4 border-green-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Ã°Å¸â€œÅ  VisÃƒÂ£o Geral:"})," AnÃƒÂ¡lise dos ÃƒÂºltimos ",e.jsx("strong",{children:"30 dias"})," para calcular a saÃƒÂºde do caixa. Mostra quanto tempo vocÃƒÂª consegue manter o negÃƒÂ³cio com saldo atual."]})}),e.jsx(Ae,{indices:r}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(I,{projecoes:n.slice(0,7),titulo:"PrÃƒÂ³ximos 7 Dias"}),e.jsx(se,{alertas:d.slice(0,3)})]})]}),o==="projecoes"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Ã°Å¸â€œË† ProjeÃƒÂ§ÃƒÂ£o 15 Dias:"})," PrevisÃƒÂ£o usando inteligÃƒÂªncia artificial (Prophet). Baseada em ",e.jsx("strong",{children:"30+ dias de histÃƒÂ³rico"})," para prever entradas e saÃƒÂ­das dos prÃƒÂ³ximos ",e.jsx("strong",{children:"15 dias"}),". Quanto mais histÃƒÂ³rico, mais precisa a previsÃƒÂ£o."]})}),e.jsx(I,{projecoes:n,titulo:"ProjeÃƒÂ§ÃƒÂ£o 15 Dias com Prophet",detalhado:!0})]}),o==="alertas"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border-l-4 border-orange-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Ã¢Å¡Â Ã¯Â¸Â Alertas:"})," Avisos automÃƒÂ¡ticos gerados em tempo real.",e.jsx("strong",{children:" CrÃƒÂ­tico"})," = menos de 7 dias de caixa (risco iminente).",e.jsx("strong",{children:" Alerta"})," = 7-15 dias (atenÃƒÂ§ÃƒÂ£o necessÃƒÂ¡ria).",e.jsx("strong",{children:" OK"})," = mais de 15 dias (situaÃƒÂ§ÃƒÂ£o confortÃƒÂ¡vel)."]})}),e.jsx(se,{alertas:d})]}),o==="simulador"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-l-4 border-purple-500 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Ã°Å¸Å½Â¯ Simulador:"})," Teste 3 cenÃƒÂ¡rios para os ",e.jsx("strong",{children:"prÃƒÂ³ximos 15 dias"}),".",e.jsx("strong",{children:" Otimista:"})," +20% receita, -10% despesa.",e.jsx("strong",{children:" Realista:"})," sem mudanÃƒÂ§as.",e.jsx("strong",{children:" Pessimista:"})," -20% receita, +10% despesa.",e.jsx("strong",{children:"Seus dados reais nÃƒÂ£o sÃƒÂ£o alterados!"})]})}),e.jsx(Ke,{userId:t,projecoesBase:n})]})]})]})}function Xe(){const{user:t}=be();return e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(Ve,{userId:(t==null?void 0:t.id)||1})})}export{Xe as default};
