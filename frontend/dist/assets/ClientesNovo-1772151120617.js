import{r as i,j as e,z as Z,T as ie,_ as Ve,Z as we,$ as Qe,a0 as ue,o as ge,a1 as va,p as ae,l as ya,a2 as _e,a3 as Oe,a4 as Na,a5 as ne,a6 as _a,S as wa,a7 as Ca,a8 as ka,a9 as We,P as le,aa as qe,ab as He,ac as Je,y as Ea,ad as Ue,ae as Ge,af as Pa,ag as Sa}from"./vendor-react-1772151120617.js";import{a as M}from"./index-1772151120617.js";import{C as $a}from"./ClienteTimeline-1772151120617.js";function Fa({isOpen:f,onClose:o,onSuccess:j}){var V,m;const[h,y]=i.useState(null),[w,C]=i.useState(!1),[p,A]=i.useState(null),[D,E]=i.useState("upload"),l=d=>{const x=d.target.files[0];x&&(x.name.endsWith(".xlsx")||x.name.endsWith(".xls")?(y(x),A(null)):(Z.error("Arquivo deve ser Excel (.xlsx ou .xls)"),d.target.value=""))},_=async()=>{try{const d=localStorage.getItem("access_token")||localStorage.getItem("token"),x=await M.get("/pessoas/template-importacao",{headers:{Authorization:`Bearer ${d}`},responseType:"blob"}),H=window.URL.createObjectURL(new Blob([x.data])),g=document.createElement("a");g.href=H,g.setAttribute("download",`template_pessoas_${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(H),Z.success("Template baixado com sucesso!")}catch(d){console.error("Erro ao baixar template:",d),Z.error("Erro ao baixar template")}},T=async()=>{var d,x,H,g;if(!h){Z.error("Selecione um arquivo para importar");return}C(!0),E("processando");try{const J=new FormData;J.append("file",h);const O=await M.post("/pessoas/importar",J);A(O.data),E("resultado");const Q=(((d=O.data.criados)==null?void 0:d.length)||0)+(((x=O.data.atualizados)==null?void 0:x.length)||0);Q>0&&(Z.success(`${Q} pessoas processadas com sucesso!`),j&&j()),O.data.total_erros>0&&Z.error(`${O.data.total_erros} pessoas com erro`)}catch(J){console.error("Erro ao importar:",J),Z.error(((g=(H=J.response)==null?void 0:H.data)==null?void 0:g.detail)||"Erro ao importar pessoas"),E("upload")}finally{C(!1)}},v=()=>{y(null),A(null),E("upload")},k=()=>{v(),o()};return f?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-purple-600 to-purple-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"ImportaÃƒÂ§ÃƒÂ£o de Pessoas em Lote"})]}),e.jsx("button",{onClick:k,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:[D==="upload"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-purple-900 mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Como funciona"]}),e.jsxs("ul",{className:"text-sm text-purple-800 space-y-1 ml-7",children:[e.jsx("li",{children:"1. Baixe o template Excel clicando no botÃƒÂ£o abaixo"}),e.jsx("li",{children:"2. Preencha os dados das pessoas (clientes, fornecedores, veterinÃƒÂ¡rios)"}),e.jsx("li",{children:"3. Salve o arquivo e faÃƒÂ§a o upload aqui"}),e.jsx("li",{children:"4. Pessoas novas serÃƒÂ£o criadas, existentes serÃƒÂ£o atualizadas (baseado no CPF/CNPJ)"})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:_,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Baixar Template Excel"]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecione a Planilha Preenchida"}),e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx("svg",{className:"w-12 h-12 mb-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Clique para selecionar"})," ou arraste o arquivo"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Apenas arquivos Excel (.xlsx, .xls)"}),h&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-purple-600",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"font-medium",children:h.name})]})]}),e.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:l})]})})]})]}),D==="processando"&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mb-4"}),e.jsx("p",{className:"text-lg text-gray-700",children:"Processando planilha..."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Isso pode levar alguns segundos"})]}),D==="resultado"&&p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:p.total_processados||0}),e.jsx("div",{className:"text-sm text-blue-800 mt-1",children:"Total Processado"})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:((V=p.criados)==null?void 0:V.length)||0}),e.jsx("div",{className:"text-sm text-green-800 mt-1",children:"Criados"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:((m=p.atualizados)==null?void 0:m.length)||0}),e.jsx("div",{className:"text-sm text-yellow-800 mt-1",children:"Atualizados"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:p.total_erros||0}),e.jsx("div",{className:"text-sm text-red-800 mt-1",children:"Erros"})]})]}),p.criados&&p.criados.length>0&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-green-900 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Pessoas Criadas (",p.criados.length,")"]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"text-sm space-y-1",children:p.criados.map((d,x)=>e.jsxs("li",{className:"text-green-800",children:["Linha ",d.linha,": ",e.jsx("span",{className:"font-medium",children:d.nome})," (",d.tipo,")"]},x))})})]}),p.atualizados&&p.atualizados.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-yellow-900 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Pessoas Atualizadas (",p.atualizados.length,")"]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"text-sm space-y-1",children:p.atualizados.map((d,x)=>e.jsxs("li",{className:"text-yellow-800",children:["Linha ",d.linha,": ",e.jsx("span",{className:"font-medium",children:d.nome})," (",d.tipo,")"]},x))})})]}),p.erros&&p.erros.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Erros (",p.erros.length,")"]}),e.jsx("div",{className:"max-h-40 overflow-y-auto",children:e.jsx("ul",{className:"text-sm space-y-2",children:p.erros.map((d,x)=>e.jsxs("li",{className:"text-red-800",children:[e.jsxs("strong",{children:["Linha ",d.linha]})," (",d.nome||"?","): ",d.erro]},x))})})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3 bg-gray-50",children:[D==="upload"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:k,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:T,disabled:!h||w,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Importando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Importar Pessoas"]})})]}),D==="resultado"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:v,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Importar Novamente"}),e.jsx("button",{onClick:k,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Concluir"})]})]})]})}):null}const se={VIP:{color:"purple",bgClass:"bg-purple-100",textClass:"text-purple-800",borderClass:"border-purple-300",icon:va,descricao:"Cliente de alto valor",emoji:"ðŸ‘‘"},Recorrente:{color:"blue",bgClass:"bg-blue-100",textClass:"text-blue-800",borderClass:"border-blue-300",icon:ge,descricao:"Compra com frequÃªncia",emoji:"ðŸ”„"},Novo:{color:"green",bgClass:"bg-green-100",textClass:"text-green-800",borderClass:"border-green-300",icon:we,descricao:"Cliente recente",emoji:"ðŸŒŸ"},Inativo:{color:"gray",bgClass:"bg-gray-100",textClass:"text-gray-800",borderClass:"border-gray-300",icon:ue,descricao:"Sem compras recentes",emoji:"â°"},Endividado:{color:"red",bgClass:"bg-red-100",textClass:"text-red-800",borderClass:"border-red-300",icon:ie,descricao:"Alto saldo devedor",emoji:"âš ï¸"},Risco:{color:"orange",bgClass:"bg-orange-100",textClass:"text-orange-800",borderClass:"border-orange-300",icon:Qe,descricao:"DiminuiÃ§Ã£o de frequÃªncia",emoji:"ðŸ“‰"},Regular:{color:"gray",bgClass:"bg-gray-100",textClass:"text-gray-600",borderClass:"border-gray-200",icon:we,descricao:"Cliente regular",emoji:"ðŸ‘¤"}};function za({segmento:f,size:o="sm",showIcon:j=!1}){if(!f)return null;const h=se[f]||se.Regular,y=h.icon,w={xs:"text-xs px-2 py-0.5",sm:"text-xs px-2 py-1",md:"text-sm px-3 py-1.5",lg:"text-base px-4 py-2"};return e.jsxs("span",{className:`inline-flex items-center gap-1 font-medium rounded-full ${h.bgClass} ${h.textClass} ${w[o]}`,title:h.descricao,children:[j&&e.jsx(y,{size:o==="xs"?10:o==="sm"?12:14}),h.emoji," ",f]})}function Ma({tag:f}){const o=se[f]||se.Regular;return e.jsxs("span",{className:`inline-flex items-center gap-1 text-xs font-medium px-2 py-1 rounded-md ${o.bgClass} ${o.textClass}`,title:o.descricao,children:[o.emoji," ",f]})}function pe(f){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(f)}function Aa({clienteId:f,compact:o=!1}){const[j,h]=i.useState(null),[y,w]=i.useState(!0),[C,p]=i.useState(null),[A,D]=i.useState(!1);i.useEffect(()=>{f&&E()},[f]);const E=async()=>{var m;try{w(!0),p(null);const d=await M.get(`/segmentacao/clientes/${f}`);h(d.data)}catch(d){((m=d.response)==null?void 0:m.status)===404?p("not_calculated"):(p("Erro ao carregar segmentaÃ§Ã£o"),console.error("Erro ao carregar segmentaÃ§Ã£o:",d))}finally{w(!1)}},l=async()=>{try{D(!0);const m=await M.post(`/segmentacao/clientes/${f}/recalcular`);h(m.data),p(null)}catch(m){console.error("Erro ao recalcular segmento:",m),alert("Erro ao recalcular segmento. Tente novamente.")}finally{D(!1)}};if(y)return e.jsxs("div",{className:"animate-pulse bg-gray-100 rounded-lg p-6",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]});if(C==="not_calculated")return e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ie,{className:"text-yellow-600 mt-1",size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-yellow-900 mb-2",children:"SegmentaÃ§Ã£o nÃ£o calculada"}),e.jsx("p",{className:"text-sm text-yellow-800 mb-4",children:"Este cliente ainda nÃ£o foi segmentado. Clique abaixo para calcular."}),e.jsxs("button",{onClick:l,disabled:A,className:"flex items-center gap-2 px-4 py-2 bg-yellow-600 hover:bg-yellow-700 disabled:bg-yellow-400 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(Ve,{className:A?"animate-spin":""}),A?"Calculando...":"Calcular segmento"]})]})]})});if(C&&C!=="not_calculated")return e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-800",children:C})});if(!j)return null;const _=se[j.segmento]||se.Regular,T=_.icon,v=j.metricas||{},k={purple:"bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-300",blue:"bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-300",green:"bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-300",gray:"bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-300",red:"bg-gradient-to-br from-red-50 to-red-100 border-2 border-red-300",orange:"bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-300"},V=k[_.color]||k.gray;return o?e.jsx(za,{segmento:j.segmento,size:"sm"}):e.jsxs("div",{className:`${V} rounded-xl p-6 shadow-sm`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 ${_.bgClass} rounded-lg`,children:e.jsx(T,{className:_.textClass,size:24})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[_.emoji," SegmentaÃ§Ã£o: ",e.jsx("span",{className:_.textClass,children:j.segmento})]}),e.jsx("p",{className:"text-sm text-gray-600",children:_.descricao})]})]}),e.jsxs("button",{onClick:l,disabled:A,className:"flex items-center gap-2 px-3 py-2 bg-white hover:bg-gray-50 disabled:bg-gray-100 border border-gray-300 text-gray-700 rounded-lg transition-colors text-sm",title:"Recalcular segmento",children:[e.jsx(Ve,{size:14,className:A?"animate-spin":""}),A?"Calculando...":"Atualizar"]})]}),j.tags&&j.tags.length>1&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"TambÃ©m se enquadra em:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:j.tags.filter(m=>m!==j.segmento).map(m=>e.jsx(Ma,{tag:m},m))})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ae,{className:"text-gray-500",size:16}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Total 90 dias"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:pe(v.total_compras_90d||0)})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ya,{className:"text-gray-500",size:16}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Compras 90d"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:v.compras_90d||0})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ge,{className:"text-gray-500",size:16}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Ticket mÃ©dio"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:pe(v.ticket_medio||0)})]}),e.jsxs("div",{className:"bg-white/80 backdrop-blur rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ue,{className:"text-gray-500",size:16}),e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Ãšltima compra"})]}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:v.ultima_compra_dias===9999?"Nunca":`${v.ultima_compra_dias} dias`})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white/60 rounded-lg p-2",children:[e.jsx("span",{className:"text-gray-600",children:"Total em aberto:"}),e.jsx("span",{className:`font-semibold ${v.total_em_aberto>0?"text-red-600":"text-green-600"}`,children:pe(v.total_em_aberto||0)})]}),e.jsxs("div",{className:"flex justify-between items-center bg-white/60 rounded-lg p-2",children:[e.jsx("span",{className:"text-gray-600",children:"Cliente hÃ¡:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:v.primeira_compra_dias>0?`${v.primeira_compra_dias} dias`:"Sem compras"})]}),e.jsxs("div",{className:"flex justify-between items-center bg-white/60 rounded-lg p-2",children:[e.jsx("span",{className:"text-gray-600",children:"Total histÃ³rico:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:pe(v.total_historico||0)})]}),e.jsxs("div",{className:"flex justify-between items-center bg-white/60 rounded-lg p-2",children:[e.jsx("span",{className:"text-gray-600",children:"Total de compras:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:v.total_compras_historico||0})]})]}),j.updated_at&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-300/50",children:e.jsxs("p",{className:"text-xs text-gray-600",children:["Atualizado em: ",new Date(j.updated_at).toLocaleString("pt-BR")]})})]})}const Ra={RISCO:{color:"red",bgClass:"bg-red-50",borderClass:"border-red-200",tagClass:"bg-red-100 text-red-700",label:"âš ï¸ Risco"},OPORTUNIDADE:{color:"green",bgClass:"bg-green-50",borderClass:"border-green-200",tagClass:"bg-green-100 text-green-700",label:"ðŸ’¡ Oportunidade"},ATENCAO:{color:"yellow",bgClass:"bg-yellow-50",borderClass:"border-yellow-200",tagClass:"bg-yellow-100 text-yellow-700",label:"ðŸ‘€ AtenÃ§Ã£o"}};function La(f,o,j,h){const y=[],w=new Date;if((o==null?void 0:o.segmento)==="VIP"&&(o==null?void 0:o.dias_desde_ultima_compra)>20&&y.push({tipo:"RISCO",icone:Na,titulo:"VIP em risco de churn",descricao:`Sem compras hÃ¡ ${o.dias_desde_ultima_compra} dias. Cliente VIP precisa de atenÃ§Ã£o especial.`,prioridade:10}),(o==null?void 0:o.dias_desde_ultima_compra)>90&&y.push({tipo:"RISCO",icone:ue,titulo:"Cliente inativo hÃ¡ muito tempo",descricao:`Ãšltima compra foi hÃ¡ ${o.dias_desde_ultima_compra} dias. Considere campanha de reativaÃ§Ã£o.`,prioridade:8}),(o==null?void 0:o.saldo_devedor)>0&&(o==null?void 0:o.total_90d)>0&&(o==null?void 0:o.dias_desde_ultima_compra)<30){const C=o.saldo_devedor/o.total_90d*100;C>50&&y.push({tipo:"ATENCAO",icone:ae,titulo:"Alto endividamento com atividade recente",descricao:`Saldo devedor de R$ ${o.saldo_devedor.toFixed(2)} (${C.toFixed(0)}% das compras). Avaliar condiÃ§Ãµes.`,prioridade:9})}if((o==null?void 0:o.segmento)==="Novo"&&(o==null?void 0:o.ticket_medio)>200&&y.push({tipo:"OPORTUNIDADE",icone:ge,titulo:"Novo cliente de alto valor",descricao:`Ticket mÃ©dio de R$ ${o.ticket_medio.toFixed(2)}. Potencial para se tornar VIP.`,prioridade:7}),h||y.push({tipo:"ATENCAO",icone:ne,titulo:"WhatsApp nÃ£o registrado",descricao:"Adicione o nÃºmero para facilitar comunicaÃ§Ã£o e envio de promoÃ§Ãµes.",prioridade:5}),j&&j.length>0){const C=j.filter(p=>{if(!p.ultima_consulta)return!0;const A=new Date(p.ultima_consulta);return Math.floor((w-A)/(1e3*60*60*24))>60});if(C.length>0){const p=C[0].nome;y.push({tipo:"OPORTUNIDADE",icone:_a,titulo:`Pet ${p} sem consulta hÃ¡ mais de 60 dias`,descricao:`${C.length===1?"Considere":`${C.length} pets precisam de`} check-up ou retorno.`,prioridade:6})}}return(o==null?void 0:o.segmento)==="Recorrente"&&(o==null?void 0:o.dias_desde_ultima_compra)>30&&y.push({tipo:"ATENCAO",icone:ue,titulo:"Cliente recorrente com atraso",descricao:`Costuma comprar regularmente, mas estÃ¡ hÃ¡ ${o.dias_desde_ultima_compra} dias sem aparecer.`,prioridade:7}),(o==null?void 0:o.saldo_credito)>0&&y.push({tipo:"OPORTUNIDADE",icone:ae,titulo:"Cliente tem crÃ©dito disponÃ­vel",descricao:`R$ ${o.saldo_credito.toFixed(2)} de crÃ©dito pode ser usado. Incentive o uso.`,prioridade:4}),y.sort((C,p)=>p.prioridade-C.prioridade).slice(0,3)}function Ia({clienteId:f,cliente:o,metricas:j}){const[h,y]=i.useState([]),[w,C]=i.useState(!1),[p,A]=i.useState([]);i.useEffect(()=>{f&&D()},[f,j]);const D=async()=>{try{C(!0);let E=(o==null?void 0:o.pets)||[];if(E.length===0&&f)try{E=(await M.get(`/clientes/${f}`)).data.pets||[]}catch(T){console.error("Erro ao carregar pets:",T)}A(E);const l=(o==null?void 0:o.celular)&&o.celular.trim()!=="",_=La(o,j,E,l);y(_)}catch(E){console.error("Erro ao calcular insights:",E),y([])}finally{C(!1)}};return w?e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_e,{className:"text-yellow-500",size:24}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"âš¡ Insights & AÃ§Ãµes"})]}),e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm",children:"Analisando cliente..."})]})]}):!h||h.length===0?e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(_e,{className:"text-yellow-500",size:24}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"âš¡ Insights & AÃ§Ãµes"})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-700",children:[e.jsx(Oe,{size:20}),e.jsx("p",{className:"font-medium",children:"âœ… Cliente em dia!"})]}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Nenhuma aÃ§Ã£o prioritÃ¡ria no momento"})]})]}):e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-300 rounded-xl p-6 shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx(_e,{className:"text-yellow-600",size:24}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"âš¡ Insights & AÃ§Ãµes"}),e.jsxs("span",{className:"ml-auto text-xs text-gray-500 bg-white px-2 py-1 rounded-full",children:[h.length," ",h.length===1?"insight":"insights"]})]}),e.jsx("div",{className:"space-y-3",children:h.map((E,l)=>{const _=Ra[E.tipo],T=E.icone;return e.jsx("div",{className:`${_.bgClass} border ${_.borderClass} rounded-lg p-4 transition-all hover:shadow-md`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(T,{className:`text-${_.color}-600`,size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:E.titulo}),e.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded-full ${_.tagClass}`,children:_.label})]}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:E.descricao})]})]})},l)})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-yellow-200",children:e.jsxs("p",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(Oe,{size:12}),"Insights calculados automaticamente com base no histÃ³rico do cliente"]})})]})}const Wa=()=>{var Re,Le,Ie,De,Te;const f=wa(),[o,j]=i.useState([]),[h,y]=i.useState(!0),[w,C]=i.useState(""),[p,A]=i.useState(!1),[D,E]=i.useState(!1),[l,_]=i.useState(null),[T,v]=i.useState(""),[k,V]=i.useState("todos"),[m,d]=i.useState(1),[x,H]=i.useState(0),[g,J]=i.useState(20),[O,Q]=i.useState(!1),[S,U]=i.useState(1),[G,he]=i.useState([]),[Da,Xe]=i.useState(null),[Ce,ce]=i.useState(""),[$,W]=i.useState(null),[Ke,q]=i.useState(!1),[Ze,re]=i.useState(!1),[Ta,be]=i.useState([]),[de,ke]=i.useState({}),[Ye,fe]=i.useState(null),[je,me]=i.useState(null),[z,ve]=i.useState(null),[ea,Ee]=i.useState(!1),[s,c]=i.useState({tipo_cadastro:"cliente",tipo_pessoa:"PF",nome:"",cpf:"",email:"",telefone:"",celular:"",celular_whatsapp:!0,cnpj:"",inscricao_estadual:"",razao_social:"",nome_fantasia:"",responsavel:"",crmv:"",parceiro_ativo:!1,parceiro_desde:"",parceiro_observacoes:"",cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:"",endereco_entrega:"",endereco_entrega_2:"",is_entregador:!1,entregador_ativo:!0,entregador_padrao:!1,tipo_vinculo_entrega:"",controla_rh:!1,gera_conta_pagar_custo_entrega:!1,media_entregas_configurada:"",custo_rh_ajustado:"",modelo_custo_entrega:"",taxa_fixa_entrega:"",valor_por_km_entrega:"",moto_propria:!0,tipo_acerto_entrega:"",dia_semana_acerto:"",dia_mes_acerto:"",is_terceirizado:!1,recebe_repasse:!1,gera_conta_pagar:!1,observacoes:"",tags:""}),[X,xe]=i.useState([]),[b,B]=i.useState(null),[aa,Pe]=i.useState(!1),[Y,sa]=i.useState({nome:"",especie:"",raca:"",sexo:"",data_nascimento:"",cor:"",peso:"",observacoes:"",castrado:!1,porte:"",microchip:"",alergias:"",doencas_cronicas:"",medicamentos_continuos:"",historico_clinico:"",foto_url:"",idade_aproximada:""}),Se=[{number:1,title:"InformaÃ§Ãµes do cliente"},{number:2,title:"Contatos"},{number:3,title:"EndereÃ§o"},{number:4,title:"InformaÃ§Ãµes complementares"},{number:5,title:"Animais"},{number:6,title:"Financeiro"}];i.useEffect(()=>{K()},[k,m,g]),i.useEffect(()=>{const a=setTimeout(()=>{m!==1?d(1):K()},500);return()=>clearTimeout(a)},[w]),i.useEffect(()=>{Y&&Y.especie?ra(Y.especie):be([])},[Y==null?void 0:Y.especie]),i.useEffect(()=>{if(je&&G.length>0){const a=G.findIndex(r=>r.id===je);a!==-1&&(fa(a),me(null))}},[G,je]);const ra=async a=>{try{const r=await M.get(`/clientes/racas?especie=${a}`);be(r.data)}catch(r){console.error("Erro ao carregar raÃ§as:",r),be([])}},K=async()=>{try{y(!0);const a=(m-1)*g,r=new URLSearchParams({skip:a.toString(),limit:g.toString()});k!=="todos"&&r.append("tipo_cadastro",k),w&&w.trim()&&r.append("search",w.trim());const t=`/clientes/?${r.toString()}`,n=await M.get(t);n.data.items?(j(n.data.items),H(n.data.total)):(j(n.data),H(n.data.length))}catch(a){v("Erro ao carregar pessoas"),console.error(a)}finally{y(!1)}},$e=async a=>{const r=a.replace(/\D/g,"");if(r.length===8){Q(!0),ce(""),v("");try{const n=await(await fetch(`https://viacep.com.br/ws/${r}/json/`)).json();if(n.erro){ce("CEP nÃ£o encontrado");return}c(R=>({...R,endereco:n.logradouro||"",bairro:n.bairro||"",cidade:n.localidade||"",estado:n.uf||"",cep:a}))}catch(t){console.error("Erro ao buscar CEP:",t)}finally{Q(!1)}}},Fe=(a=null)=>{B(a!==null?{...X[a],index:a}:{tipo:"entrega",apelido:"",cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""}),Pe(!0)},ye=()=>{Pe(!1),B(null)},ta=async a=>{if(!(!a||a.length!==9)){Q(!0);try{const t=await(await fetch(`https://viacep.com.br/ws/${a.replace("-","")}/json/`)).json();if(t.erro){alert("CEP nÃ£o encontrado");return}B(n=>({...n,endereco:t.logradouro||"",bairro:t.bairro||"",cidade:t.localidade||"",estado:t.uf||""}))}catch(r){console.error("Erro ao buscar CEP:",r),alert("Erro ao buscar CEP")}finally{Q(!1)}}},oa=()=>{if(!b.cep||!b.endereco||!b.cidade){alert("Preencha pelo menos CEP, EndereÃ§o e Cidade");return}const a=[...X];b.index!==void 0?(a[b.index]={...b},delete a[b.index].index):a.push({...b}),xe(a),ye()},la=a=>{if(confirm("Deseja realmente remover este endereÃ§o?")){const r=X.filter((t,n)=>n!==a);xe(r)}},na=async()=>{var a,r,t,n,R;v("");try{const N=[];if((!s.nome||s.nome.trim()==="")&&N.push("Nome"),s.tipo_pessoa==="PJ"&&((!s.cnpj||s.cnpj.trim()==="")&&N.push("CNPJ"),(!s.razao_social||s.razao_social.trim()==="")&&N.push("RazÃ£o Social")),s.tipo_pessoa==="PF"&&s.tipo_cadastro==="cliente"&&(!s.cpf||s.cpf.trim()),N.length>0){const L=`âŒ Faltam os seguintes campos obrigatÃ³rios:

`+N.map(I=>`â€¢ ${I}`).join(`
`);alert(L),v(L);return}if(s.is_entregador){if(!s.tipo_acerto_entrega){alert("Informe o tipo de acerto do entregador (semanal, quinzenal ou mensal)");return}if(s.tipo_acerto_entrega==="semanal"&&!s.dia_semana_acerto){alert("Informe o dia da semana para o acerto semanal");return}if(s.tipo_acerto_entrega==="mensal"&&!s.dia_mes_acerto){alert("Informe o dia do mÃªs para o acerto mensal");return}if(s.tipo_acerto_entrega==="mensal"){const L=parseInt(s.dia_mes_acerto);if(L<1||L>28){alert("O dia do mÃªs deve estar entre 1 e 28");return}}}const{celular_whatsapp:u,tags:Be,...F}=s;F.is_entregador&&(F.tipo_cadastro==="funcionario"?(F.tipo_vinculo_entrega="funcionario",F.is_terceirizado=!1):F.tipo_cadastro==="fornecedor"&&(F.is_terceirizado=!0,F.tipo_vinculo_entrega="terceirizado")),F.enderecos_adicionais=X.length>0?X:null,Object.keys(F).forEach(L=>{F[L]===""&&(F[L]=null)}),F.tipo_cadastro==="todos"&&(F.tipo_cadastro="cliente");let oe;l?(await M.put(`/clientes/${l.id}`,F),oe=l.id):oe=(await M.post("/clientes/",F)).data.id;for(const L of G){const I=L.id,P={...L};delete P.id,delete P.created_at,delete P.updated_at,delete P.cliente_id,delete P.user_id,delete P.ativo,delete P.codigo,Object.keys(P).forEach(ee=>{P[ee]===""&&(P[ee]=null)}),P.peso!==null&&P.peso!==void 0&&(P.peso=parseFloat(P.peso)||null),I?(console.log(`Atualizando pet ${I}:`,P),await M.put(`/clientes/pets/${I}`,P)):(console.log("Criando novo pet:",P),await M.post(`/clientes/${oe}/pets`,P))}K(),Ne()}catch(N){const u=(r=(a=N.response)==null?void 0:a.data)==null?void 0:r.details;console.error("Erro completo:",(t=N.response)==null?void 0:t.data),console.error("Detalhes de validaÃ§Ã£o:",u);const Be={nome:"Nome",cpf:"CPF",cnpj:"CNPJ",razao_social:"RazÃ£o Social",nome_fantasia:"Nome Fantasia",inscricao_estadual:"InscriÃ§Ã£o Estadual",responsavel:"ResponsÃ¡vel",telefone:"Telefone",celular:"Celular",email:"E-mail",cep:"CEP",endereco:"EndereÃ§o",numero:"NÃºmero",bairro:"Bairro",cidade:"Cidade",estado:"Estado",tipo_pessoa:"Tipo de Pessoa",tipo_cadastro:"Tipo de Cadastro",crmv:"CRMV",tipo_acerto_entrega:"Tipo de Acerto",dia_semana_acerto:"Dia da Semana para Acerto",dia_mes_acerto:"Dia do MÃªs para Acerto",tipo_vinculo_entrega:"Tipo de VÃ­nculo"};let F="";if(u&&Array.isArray(u)){const L=[];u.forEach(I=>{const P=I.loc[I.loc.length-1],ee=Be[P]||P;I.type==="missing"||I.type==="value_error.missing"?L.push(ee):I.msg&&L.push(`${ee}: ${I.msg}`),console.error(`Campo: ${ee} | Tipo: ${I.type} | Mensagem: ${I.msg}`)}),L.length>0&&(F=`âŒ Faltam os seguintes campos obrigatÃ³rios:

`+L.map(I=>`â€¢ ${I}`).join(`
`))}const oe=F||((R=(n=N.response)==null?void 0:n.data)==null?void 0:R.message)||"Erro ao salvar cliente";v(oe),F&&alert(F)}},ia=async a=>{var r,t;if(confirm("Tem certeza que deseja excluir este cliente?"))try{console.log("Excluindo cliente ID:",a);const n=await M.delete(`/clientes/${a}`);console.log("Cliente excluÃ­do com sucesso:",n),await K()}catch(n){console.error("Erro ao excluir cliente:",n),console.error("Resposta do erro:",n.response),v(((t=(r=n.response)==null?void 0:r.data)==null?void 0:t.detail)||"Erro ao excluir cliente")}},ca=async a=>{var r,t;if(confirm("Tem certeza que deseja excluir este pet?"))try{console.log("Excluindo pet ID:",a),await M.delete(`/clientes/pets/${a}`),console.log("Pet excluÃ­do com sucesso"),ke({}),await K(),console.log("Lista de clientes atualizada")}catch(n){console.error("Erro ao excluir pet:",n),alert(((t=(r=n.response)==null?void 0:r.data)==null?void 0:t.detail)||"Erro ao excluir pet")}},da=async a=>{var r;if(a)try{Ee(!0);const t=await M.get(`/financeiro/cliente/${a}/resumo`);ve(t.data.resumo)}catch(t){((r=t.response)==null?void 0:r.status)!==404&&console.error("Erro ao carregar resumo financeiro:",t),ve(null)}finally{Ee(!1)}},te=(a=null,r=null,t=null)=>{if(a)_(a),console.log("ðŸ› Cliente carregado do backend:",{id:a.id,nome:a.nome,is_entregador:a.is_entregador,entregador_padrao:a.entregador_padrao,entregador_padrao_tipo:typeof a.entregador_padrao}),c({tipo_cadastro:a.tipo_cadastro||"cliente",tipo_pessoa:a.tipo_pessoa||"PF",nome:a.nome,cpf:a.cpf||"",email:a.email||"",telefone:a.telefone||"",celular:a.celular||"",celular_whatsapp:!0,cnpj:a.cnpj||"",inscricao_estadual:a.inscricao_estadual||"",razao_social:a.razao_social||"",nome_fantasia:a.nome_fantasia||"",responsavel:a.responsavel||"",crmv:a.crmv||"",parceiro_ativo:a.parceiro_ativo||!1,parceiro_desde:a.parceiro_desde||"",parceiro_observacoes:a.parceiro_observacoes||"",cep:a.cep||"",endereco:a.endereco||"",numero:a.numero||"",complemento:a.complemento||"",bairro:a.bairro||"",cidade:a.cidade||"",estado:a.estado||"",endereco_entrega:a.endereco_entrega||"",endereco_entrega_2:a.endereco_entrega_2||"",is_entregador:a.is_entregador||!1,entregador_ativo:a.entregador_ativo!==void 0?a.entregador_ativo:!0,entregador_padrao:a.entregador_padrao||!1,tipo_vinculo_entrega:a.tipo_vinculo_entrega||"",controla_rh:a.controla_rh||!1,gera_conta_pagar_custo_entrega:a.gera_conta_pagar_custo_entrega||!1,media_entregas_configurada:a.media_entregas_configurada||"",custo_rh_ajustado:a.custo_rh_ajustado||"",modelo_custo_entrega:a.modelo_custo_entrega||"",taxa_fixa_entrega:a.taxa_fixa_entrega||"",valor_por_km_entrega:a.valor_por_km_entrega||"",moto_propria:a.moto_propria!==void 0?a.moto_propria:!0,tipo_acerto_entrega:a.tipo_acerto_entrega||"",dia_semana_acerto:a.dia_semana_acerto||"",dia_mes_acerto:a.dia_mes_acerto||"",is_terceirizado:a.is_terceirizado||!1,recebe_repasse:a.recebe_repasse||!1,gera_conta_pagar:a.gera_conta_pagar||!1,observacoes:a.observacoes||"",tags:""}),he(a.pets||[]),xe(a.enderecos_adicionais||[]),da(a.id),t?(me(t),U(5)):(U(1),me(null));else{_(null);const n=r||(k==="todos"?"cliente":k);c({tipo_cadastro:n,tipo_pessoa:n==="fornecedor"?"PJ":"PF",nome:"",cpf:"",email:"",telefone:"",celular:"",celular_whatsapp:!0,cnpj:"",inscricao_estadual:"",razao_social:"",nome_fantasia:"",responsavel:"",crmv:"",parceiro_ativo:!1,parceiro_desde:"",parceiro_observacoes:"",cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:"",is_entregador:!1,entregador_ativo:!0,tipo_vinculo_entrega:"",controla_rh:!1,media_entregas_configurada:"",custo_rh_ajustado:"",modelo_custo_entrega:"",taxa_fixa_entrega:"",valor_por_km_entrega:"",moto_propria:!0,is_terceirizado:!1,recebe_repasse:!1,gera_conta_pagar:!1,observacoes:"",tags:""}),he([]),xe([]),U(1)}A(!0),v("")},Ne=()=>{A(!1),_(null),U(1),he([]),W(null),q(!1),re(!1),fe(null),me(null),ve(null)},ze=async()=>{try{const a=new URLSearchParams;if(s.cpf&&a.append("cpf",s.cpf),s.cnpj&&a.append("cnpj",s.cnpj),s.telefone&&a.append("telefone",s.telefone),s.celular&&a.append("celular",s.celular),s.crmv&&a.append("crmv",s.crmv),l&&a.append("cliente_id",l.id),a.toString()){const r=await M.get(`/clientes/verificar-duplicata/campo?${a.toString()}`);if(r.data.duplicado)return W(r.data),q(!0),!0}return!1}catch(a){return console.error("Erro ao verificar duplicata:",a),!1}},ma=async()=>{if(S<6){if(v(""),ce(""),S===1&&await ze()||S===2&&await ze())return;U(S+1)}},xa=a=>["cpf","cnpj","crmv"].includes(a),pa=()=>{re(!0)},ua=async()=>{var a,r;try{y(!0);const t=(l==null?void 0:l.codigo)||(o.length>0?Math.max(...o.map(n=>n.codigo))+1:1);await M.put(`/clientes/${$.cliente.id}/remover-campo`,null,{params:{campo:$.campo,novo_cliente_codigo:t}}),re(!1),q(!1),W(null),U(S+1)}catch(t){v(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.detail)||"Erro ao remover campo duplicado")}finally{y(!1)}},ga=()=>{re(!1)},Me=()=>{Ne();const a=document.getElementById(`cliente-${$.cliente.id}`);a&&(a.scrollIntoView({behavior:"smooth",block:"center"}),a.classList.add("ring-4","ring-yellow-400"),setTimeout(()=>{a.classList.remove("ring-4","ring-yellow-400")},3e3))},ha=()=>{const a=o.find(r=>r.id===$.cliente.id);a&&(q(!1),W(null),re(!1),te(a))},ba=()=>{S>1&&(v(""),ce(""),U(S-1))},fa=a=>{const r=G[a];sa({nome:r.nome||"",especie:r.especie||"",raca:r.raca||"",sexo:r.sexo||"",data_nascimento:r.data_nascimento||"",cor:r.cor||"",peso:r.peso||"",observacoes:r.observacoes||"",castrado:r.castrado||!1,porte:r.porte||"",microchip:r.microchip||"",alergias:r.alergias||"",doencas_cronicas:r.doencas_cronicas||"",medicamentos_continuos:r.medicamentos_continuos||"",historico_clinico:r.historico_clinico||"",foto_url:r.foto_url||"",idade_aproximada:r.idade_aproximada||""}),Xe(a),r!=null&&r.id&&fe(r.id)},Ae=o.filter(a=>{var r,t,n,R;return((r=a.codigo)==null?void 0:r.includes(w))||a.nome.toLowerCase().includes(w.toLowerCase())||((t=a.cpf)==null?void 0:t.includes(w))||((n=a.email)==null?void 0:n.toLowerCase().includes(w.toLowerCase()))||((R=a.celular)==null?void 0:R.includes(w))});function ja({clienteId:a}){const[r,t]=i.useState([]),[n,R]=i.useState(!0);i.useEffect(()=>{a&&N()},[a]);const N=async()=>{try{R(!0);const u=await M.get(`/whatsapp/clientes/${a}/whatsapp/ultimas?limit=5`);t(u.data)}catch(u){console.error("Erro ao carregar mensagens:",u),t([])}finally{R(!1)}};return n?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Carregando mensagens..."})]}):r.length===0?e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(ne,{size:32,className:"mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"Nenhuma mensagem registrada ainda"}),e.jsx("p",{className:"text-xs mt-1",children:"As mensagens enviadas e recebidas aparecerÃ£o aqui"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Ãšltimas 5 mensagens:"}),r.map(u=>e.jsxs("div",{className:`p-3 rounded-lg border ${u.direcao==="enviada"?"bg-green-50 border-green-200 ml-6":"bg-blue-50 border-blue-200 mr-6"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs font-semibold ${u.direcao==="enviada"?"text-green-700":"text-blue-700"}`,children:u.direcao==="enviada"?"â†’ Enviada":"â† Recebida"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${u.status==="lido"?"bg-green-200 text-green-800":u.status==="enviado"?"bg-yellow-200 text-yellow-800":u.status==="recebido"?"bg-blue-200 text-blue-800":"bg-red-200 text-red-800"}`,children:u.status})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(u.created_at).toLocaleString("pt-BR")})]}),e.jsx("p",{className:"text-sm text-gray-700",children:u.preview||u.conteudo})]},u.id))]})}return h?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando..."})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Cadastros"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerenciamento de clientes, fornecedores, veterinÃ¡rios, funcionÃ¡rios e pets"})]}),e.jsx("div",{className:"mb-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{V("todos"),d(1)},className:`px-4 py-2 font-medium border-b-2 transition-colors ${k==="todos"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Todos"}),e.jsx("button",{onClick:()=>{V("cliente"),d(1)},className:`px-4 py-2 font-medium border-b-2 transition-colors ${k==="cliente"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Clientes"}),e.jsx("button",{onClick:()=>{V("fornecedor"),d(1)},className:`px-4 py-2 font-medium border-b-2 transition-colors ${k==="fornecedor"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Fornecedores"}),e.jsx("button",{onClick:()=>{V("veterinario"),d(1)},className:`px-4 py-2 font-medium border-b-2 transition-colors ${k==="veterinario"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"VeterinÃ¡rios"}),e.jsx("button",{onClick:()=>{V("funcionario"),d(1)},className:`px-4 py-2 font-medium border-b-2 transition-colors ${k==="funcionario"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"FuncionÃ¡rios"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6 flex flex-col sm:flex-row gap-4 justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ca,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar por cÃ³digo, nome, CPF/CNPJ, email ou telefone...",value:w,onChange:a=>C(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(ka,{})," Importar Excel"]}),e.jsxs("button",{onClick:()=>te(null,k),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(We,{})," Novo ",k==="cliente"?"Cliente":k==="fornecedor"?"Fornecedor":k==="veterinario"?"VeterinÃ¡rio":k==="funcionario"?"FuncionÃ¡rio":"Cadastro"]})]})]}),T&&!p&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx(ie,{}),e.jsx("span",{children:T})]}),!h&&x>0&&e.jsxs("div",{className:"px-4 py-3 bg-gray-50 border border-gray-200 rounded-t-lg flex items-center justify-between mb-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Mostrando ",(m-1)*g+1," a ",Math.min(m*g,x)," de ",x," pessoas"]}),e.jsxs("select",{value:g,onChange:a=>{J(Number(a.target.value)),d(1)},className:"px-3 py-1 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:10,children:"10 por pÃ¡gina"}),e.jsx("option",{value:20,children:"20 por pÃ¡gina"}),e.jsx("option",{value:30,children:"30 por pÃ¡gina"}),e.jsx("option",{value:50,children:"50 por pÃ¡gina"}),e.jsx("option",{value:100,children:"100 por pÃ¡gina"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d(1),disabled:m===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Primeira"}),e.jsx("button",{onClick:()=>d(a=>Math.max(a-1,1)),disabled:m===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(Math.ceil(x/g),5)},(a,r)=>{const t=Math.ceil(x/g);let n;return t<=5||m<=3?n=r+1:m>=t-2?n=t-4+r:n=m-2+r,e.jsx("button",{onClick:()=>d(n),className:`px-3 py-1 text-sm font-medium rounded-lg transition-colors ${m===n?"bg-purple-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:n},n)})}),e.jsx("button",{onClick:()=>d(a=>Math.min(a+1,Math.ceil(x/g))),disabled:m===Math.ceil(x/g),className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"PrÃ³xima"}),e.jsx("button",{onClick:()=>d(Math.ceil(x/g)),disabled:m===Math.ceil(x/g),className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Ãšltima"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[Ae.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CPF/CNPJ"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Celular"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pets"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Segmento"}),e.jsx("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"AÃ§Ãµes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ae.map(a=>{var r;return e.jsxs(i.Fragment,{children:[e.jsxs("tr",{id:`cliente-${a.id}`,onClick:()=>te(a),className:"hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 font-medium",children:a.codigo}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.nome}),a.tipo_pessoa==="PJ"&&a.razao_social&&e.jsx("span",{className:"text-xs text-gray-500",children:a.razao_social}),a.parceiro_ativo&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs font-medium text-green-700 bg-green-100 px-2 py-0.5 rounded-full w-fit",children:[e.jsx(ae,{size:12}),"Parceiro"]})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:a.tipo_pessoa==="PF"?a.cpf||"-":a.cnpj||"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:a.celular||"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",onClick:t=>t.stopPropagation(),children:e.jsxs("button",{onClick:()=>ke({...de,[a.id]:!de[a.id]}),className:"flex items-center gap-2 text-sm text-gray-700 hover:text-gray-900 transition-colors",children:[e.jsx(le,{size:16,className:"text-gray-400"}),e.jsx("span",{children:((r=a.pets)==null?void 0:r.length)||0}),a.pets&&a.pets.length>0&&e.jsx(qe,{size:14,className:`transform transition-transform ${de[a.id]?"rotate-90":""}`})]})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.celular&&e.jsx("button",{onClick:()=>{const t=a.celular.replace(/\D/g,"");window.open(`https://wa.me/55${t}`,"_blank")},className:"text-green-600 hover:text-green-900 transition-colors",title:"Abrir WhatsApp",children:e.jsx(ne,{size:16})}),e.jsx("button",{onClick:()=>te(a),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Editar",children:e.jsx(He,{size:16})}),e.jsx("button",{onClick:()=>ia(a.id),className:"text-red-600 hover:text-red-900 transition-colors",title:"Excluir",children:e.jsx(Je,{size:16})})]})})]}),de[a.id]&&a.pets&&a.pets.length>0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-3 bg-gray-50",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:["Pets de ",a.nome,":"]}),a.pets.map(t=>e.jsxs("div",{className:`bg-white rounded-lg p-3 flex justify-between items-start border border-gray-200 ${Ye===t.id?"ring-2 ring-blue-400 shadow-lg bg-blue-50":""}`,children:[e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Nome"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.nome})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"EspÃ©cie/RaÃ§a"}),e.jsxs("p",{className:"text-sm text-gray-700",children:[t.especie," ",t.raca&&`- ${t.raca}`]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Sexo"}),e.jsx("p",{className:"text-sm text-gray-700",children:t.sexo||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Nascimento"}),e.jsx("p",{className:"text-sm text-gray-700",children:t.data_nascimento?new Date(t.data_nascimento).toLocaleDateString("pt-BR"):"-"})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>{fe(t.id),te(a,null,t.id)},className:"text-blue-600 hover:text-blue-900 p-1 transition-colors",title:"Editar pet",children:e.jsx(He,{size:14})}),e.jsx("button",{onClick:()=>ca(t.id),className:"text-red-600 hover:text-red-900 p-1 transition-colors",title:"Excluir pet",children:e.jsx(Je,{size:14})})]})]},t.id))]})})})]},a.id)})})]})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(we,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-600",children:"Nenhum cliente encontrado"})]}),!h&&x>0&&e.jsxs("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Mostrando ",(m-1)*g+1," a ",Math.min(m*g,x)," de ",x," pessoas"]}),e.jsxs("select",{value:g,onChange:a=>{J(Number(a.target.value)),d(1)},className:"px-3 py-1 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:10,children:"10 por pÃ¡gina"}),e.jsx("option",{value:20,children:"20 por pÃ¡gina"}),e.jsx("option",{value:30,children:"30 por pÃ¡gina"}),e.jsx("option",{value:50,children:"50 por pÃ¡gina"}),e.jsx("option",{value:100,children:"100 por pÃ¡gina"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d(1),disabled:m===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Primeira"}),e.jsx("button",{onClick:()=>d(a=>Math.max(a-1,1)),disabled:m===1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(Math.ceil(x/g),5)},(a,r)=>{const t=Math.ceil(x/g);let n;return t<=5||m<=3?n=r+1:m>=t-2?n=t-4+r:n=m-2+r,e.jsx("button",{onClick:()=>d(n),className:`px-3 py-1 text-sm font-medium rounded-lg transition-colors ${m===n?"bg-purple-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:n},n)})}),e.jsx("button",{onClick:()=>d(a=>Math.min(a+1,Math.ceil(x/g))),disabled:m===Math.ceil(x/g),className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"PrÃ³xima"}),e.jsx("button",{onClick:()=>d(Math.ceil(x/g)),disabled:m===Math.ceil(x/g),className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Ãšltima"})]})]})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:l?`Editar ${l.tipo_cadastro==="cliente"?"Cliente":l.tipo_cadastro==="fornecedor"?"Fornecedor":"VeterinÃ¡rio"}`:`Adicionar ${s.tipo_cadastro==="cliente"?"Cliente":s.tipo_cadastro==="fornecedor"?"Fornecedor":"VeterinÃ¡rio"}`}),e.jsx("button",{onClick:Ne,className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ea,{size:24})})]}),e.jsx("div",{className:"flex items-center justify-between mb-2",children:Se.map((a,r)=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("button",{onClick:()=>U(a.number),className:`w-8 h-8 rounded-full flex items-center justify-center font-semibold text-sm transition-all hover:scale-110 cursor-pointer ${S>a.number?"bg-green-500 text-white hover:bg-green-600":S===a.number?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-300 text-gray-600 hover:bg-gray-400"}`,type:"button",title:`Ir para: ${a.title}`,children:S>a.number?e.jsx(Ue,{}):a.number}),e.jsx("span",{className:"text-xs mt-1 text-center hidden md:block",children:a.title})]}),r<Se.length-1&&e.jsx("div",{className:`h-0.5 flex-1 ${S>a.number?"bg-green-500":"bg-gray-300"}`})]},a.number))}),e.jsxs("div",{className:"text-center text-sm text-gray-600",children:[S,"/6"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[T&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-700",children:[e.jsx(ie,{}),e.jsx("span",{children:T})]}),Ke&&$&&e.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border-2 border-yellow-400 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ie,{className:"text-yellow-600 mt-1",size:24}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-yellow-900 mb-2",children:"âš ï¸ Cliente jÃ¡ cadastrado!"}),e.jsxs("p",{className:"text-sm text-yellow-800 mb-3",children:["JÃ¡ existe um cliente com o mesmo ",e.jsx("strong",{children:$.campo})," cadastrado:"]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-yellow-300 mb-3",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:$.cliente.nome}),e.jsxs("p",{className:"text-sm text-gray-600",children:["CÃ³digo: ",$.cliente.codigo]}),$.cliente.cpf&&e.jsxs("p",{className:"text-sm text-gray-600",children:["CPF: ",$.cliente.cpf]}),$.cliente.celular&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Celular: ",$.cliente.celular]}),$.cliente.telefone&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Telefone: ",$.cliente.telefone]})]}),xa($.campo)?e.jsxs("div",{children:[e.jsxs("div",{className:"bg-red-50 border border-red-300 rounded-lg p-4 mb-3",children:[e.jsx("p",{className:"text-sm font-semibold text-red-900 mb-2",children:"ðŸš« NÃ£o Ã© possÃ­vel criar novo cadastro"}),e.jsxs("p",{className:"text-sm text-red-800 mb-2",children:[$.campo.toUpperCase()," Ã© um documento Ãºnico e jÃ¡ estÃ¡ cadastrado."]}),e.jsx("p",{className:"text-sm text-red-700",children:"VocÃª pode editar o cadastro existente ou visualizÃ¡-lo."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ha,className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:"âœï¸ Editar cadastro existente"}),e.jsx("button",{onClick:Me,className:"flex-1 px-3 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors",children:"ðŸ‘ï¸ Ver cadastro"})]})]}):Ze?e.jsxs("div",{className:"bg-red-50 border-2 border-red-300 rounded-lg p-4 mb-3",children:[e.jsx("p",{className:"text-sm font-semibold text-red-900 mb-2",children:"âš ï¸ AtenÃ§Ã£o!"}),e.jsxs("p",{className:"text-sm text-red-800 mb-3",children:["O ",e.jsx("strong",{children:$.campo})," serÃ¡ removido do cadastro do cliente ",e.jsx("strong",{children:$.cliente.nome})," (CÃ³digo ",$.cliente.codigo,") e uma observaÃ§Ã£o serÃ¡ adicionada informando a transferÃªncia."]}),e.jsxs("p",{className:"text-xs text-red-700 mb-3",children:['No cadastro antigo ficarÃ¡ registrado: "Sem nÃºmero por cadastro novo do cliente cÃ³digo ',(l==null?void 0:l.codigo)||(o.length>0?Math.max(...o.map(a=>a.codigo))+1:1),'"']}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ua,disabled:h,className:"flex-1 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:h?"Processando...":"Confirmar e continuar"}),e.jsx("button",{onClick:ga,disabled:h,className:"flex-1 px-3 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",children:"Cancelar"})]})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Me,className:"flex-1 px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Ver cadastro existente"}),e.jsxs("button",{onClick:pa,className:"flex-1 px-3 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg text-sm font-medium transition-colors",children:["Transferir ",$.campo]})]})]})]})}),S===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"InformaÃ§Ãµes do cadastro"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de cadastro *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",value:"cliente",checked:s.tipo_cadastro==="cliente",onChange:a=>{c({...s,tipo_cadastro:a.target.value,tipo_pessoa:"PF"})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"Cliente"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",value:"fornecedor",checked:s.tipo_cadastro==="fornecedor",onChange:a=>{c({...s,tipo_cadastro:a.target.value,tipo_pessoa:"PJ"})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"Fornecedor"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",value:"veterinario",checked:s.tipo_cadastro==="veterinario",onChange:a=>c({...s,tipo_cadastro:a.target.value}),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"VeterinÃ¡rio"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",value:"funcionario",checked:s.tipo_cadastro==="funcionario",onChange:a=>c({...s,tipo_cadastro:a.target.value,tipo_pessoa:"PF"}),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"FuncionÃ¡rio"})]})]})]}),(s.tipo_cadastro==="funcionario"||s.tipo_cadastro==="fornecedor")&&e.jsxs("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"})}),e.jsx("label",{className:"text-xs font-medium text-gray-700",children:"Ã‰ entregador"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-auto",children:[e.jsx("input",{type:"checkbox",checked:s.is_entregador||!1,onChange:a=>c({...s,is_entregador:a.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"})]})]}),s.is_entregador&&e.jsxs("div",{className:"ml-5 mt-2 space-y-2 border-l-2 border-blue-300 pl-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.entregador_padrao||!1,onChange:a=>c({...s,entregador_padrao:a.target.checked}),className:"w-3.5 h-3.5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"Entregador padrÃ£o"}),e.jsx("span",{className:"text-[10px] text-gray-500",children:"(prÃ©-selecionado nas rotas)"})]}),s.tipo_cadastro==="funcionario"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.controla_rh||!1,onChange:a=>{const r=a.target.checked;c({...s,controla_rh:r,modelo_custo_entrega:r?"":s.modelo_custo_entrega,taxa_fixa_entrega:r?"":s.taxa_fixa_entrega,valor_por_km_entrega:r?"":s.valor_por_km_entrega,gera_conta_pagar_custo_entrega:!1})},className:"w-3.5 h-3.5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"Controla RH"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5",children:"Custo rateado na folha (nÃ£o gera contas a pagar)"})]})]}),s.controla_rh&&e.jsx("div",{className:"ml-5 pl-3 border-l-2 border-blue-300",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"MÃ©dia de entregas por mÃªs"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 mb-1",children:"Define o rateio inicial do custo do funcionÃ¡rio por entrega. SerÃ¡ ajustado automaticamente no final do mÃªs."}),e.jsx("input",{type:"number",min:"1",step:"1",value:s.media_entregas_configurada||"",onChange:a=>c({...s,media_entregas_configurada:a.target.value}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Ex: 100 entregas/mÃªs"}),e.jsx("p",{className:"text-[10px] text-blue-600 mt-1",children:"ðŸ’¡ Exemplo: Se o custo mensal Ã© R$ 3.000 e mÃ©dia Ã© 100 entregas, cada entrega custarÃ¡ R$ 30,00 inicialmente"})]})}),!s.controla_rh&&e.jsxs("label",{className:"flex items-start gap-2 cursor-pointer ml-5 pl-2 border-l border-gray-300",children:[e.jsx("input",{type:"checkbox",checked:s.gera_conta_pagar_custo_entrega||!1,onChange:a=>c({...s,gera_conta_pagar_custo_entrega:a.target.checked}),className:"w-3.5 h-3.5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"Gerar contas a pagar por entrega"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5",children:"Marque se este funcionÃ¡rio recebe por KM ou taxa fixa a cada entrega"})]})]})]}),(s.tipo_cadastro==="fornecedor"||s.tipo_cadastro==="funcionario"&&!s.controla_rh)&&e.jsxs("div",{className:"space-y-2",children:[s.tipo_cadastro==="fornecedor"&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-1.5 text-[10px] text-yellow-800",children:["âš ï¸ ",e.jsx("strong",{children:"Terceirizado"})," - Sempre gera contas a pagar"]}),s.tipo_cadastro==="funcionario"&&!s.controla_rh&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-1.5 text-[10px] text-blue-800",children:["â„¹ï¸ ",e.jsx("strong",{children:"FuncionÃ¡rio sem RH"})," - ",s.gera_conta_pagar_custo_entrega?"Gera CP por entrega":"NÃ£o gera CP"]}),e.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.modelo_custo_entrega==="taxa_fixa",onChange:a=>c({...s,modelo_custo_entrega:a.target.checked?"taxa_fixa":"",valor_por_km_entrega:""}),className:"w-3.5 h-3.5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"Taxa Fixa"}),s.modelo_custo_entrega==="taxa_fixa"&&e.jsx("input",{type:"number",step:"0.01",min:"0",value:s.taxa_fixa_entrega||"",onChange:a=>c({...s,taxa_fixa_entrega:a.target.value}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded mt-1 focus:ring-1 focus:ring-blue-500",placeholder:"Ex: 15.00"})]})]}),e.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.modelo_custo_entrega==="por_km",onChange:a=>c({...s,modelo_custo_entrega:a.target.checked?"por_km":"",taxa_fixa_entrega:""}),className:"w-3.5 h-3.5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:"Valor por KM"}),s.modelo_custo_entrega==="por_km"&&e.jsx("input",{type:"number",step:"0.01",min:"0",value:s.valor_por_km_entrega||"",onChange:a=>c({...s,valor_por_km_entrega:a.target.value}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded mt-1 focus:ring-1 focus:ring-blue-500",placeholder:"Ex: 2.50"})]})]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.moto_propria||!1,onChange:a=>c({...s,moto_propria:a.target.checked}),className:"w-3.5 h-3.5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-700",children:s.moto_propria?"âœ… Moto prÃ³pria":"ðŸ¢ Moto da loja"})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"ðŸ“† Acerto Financeiro"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-gray-600 mb-0.5",children:"Periodicidade"}),e.jsxs("select",{value:s.tipo_acerto_entrega||"",onChange:a=>c({...s,tipo_acerto_entrega:a.target.value,dia_semana_acerto:"",dia_mes_acerto:""}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"semanal",children:"Semanal"}),e.jsx("option",{value:"quinzenal",children:"Quinzenal (dias 1 e 15)"}),e.jsx("option",{value:"mensal",children:"Mensal"})]})]}),s.tipo_acerto_entrega==="semanal"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-gray-600 mb-0.5",children:"Dia da semana"}),e.jsxs("select",{value:s.dia_semana_acerto||"",onChange:a=>c({...s,dia_semana_acerto:a.target.value}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"1",children:"Segunda"}),e.jsx("option",{value:"2",children:"TerÃ§a"}),e.jsx("option",{value:"3",children:"Quarta"}),e.jsx("option",{value:"4",children:"Quinta"}),e.jsx("option",{value:"5",children:"Sexta"}),e.jsx("option",{value:"6",children:"SÃ¡bado"}),e.jsx("option",{value:"7",children:"Domingo"})]})]}),s.tipo_acerto_entrega==="mensal"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-medium text-gray-600 mb-0.5",children:"Dia do mÃªs (1 a 28)"}),e.jsx("input",{type:"number",min:"1",max:"28",value:s.dia_mes_acerto||"",onChange:a=>c({...s,dia_mes_acerto:a.target.value}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Ex: 5"})]}),s.tipo_acerto_entrega==="quinzenal"&&e.jsxs("div",{className:"bg-blue-50 p-1.5 rounded text-[10px] text-blue-700",children:["â„¹ï¸ Acerto nos dias ",e.jsx("strong",{children:"1"})," e ",e.jsx("strong",{children:"15"})]})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"text-green-600",size:20}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Ativar como parceiro (comissÃµes)"}),s.parceiro_ativo&&e.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 bg-green-600 text-white rounded-full text-xs font-semibold animate-fade-in",children:[e.jsx(Ue,{size:14,className:"font-bold"}),e.jsx("span",{children:"Parceiro habilitado para comissÃ£o"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.parceiro_ativo,onChange:a=>c({...s,parceiro_ativo:a.target.checked,parceiro_desde:a.target.checked&&!s.parceiro_desde?new Date().toISOString().split("T")[0]:s.parceiro_desde||""}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-7",children:"Ao ativar, esta pessoa poderÃ¡ receber comissÃµes de vendas, independente do tipo de cadastro"}),s.parceiro_ativo&&e.jsxs("div",{className:"mt-3 ml-7",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"ObservaÃ§Ãµes do parceiro (opcional)"}),e.jsx("textarea",{value:s.parceiro_observacoes,onChange:a=>c({...s,parceiro_observacoes:a.target.value}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none",placeholder:"Ex: Especialista em produtos de higiene...",rows:"2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s.tipo_pessoa==="PJ"?"Tipo de pessoa jurÃ­dica *":"Tipo de pessoa *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",value:"PF",checked:s.tipo_pessoa==="PF",onChange:a=>c({...s,tipo_pessoa:a.target.value}),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"Pessoa FÃ­sica"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",value:"PJ",checked:s.tipo_pessoa==="PJ",onChange:a=>c({...s,tipo_pessoa:a.target.value}),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:"Pessoa JurÃ­dica"})]})]})]}),s.tipo_pessoa==="PF"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome completo *"}),e.jsx("input",{type:"text",value:s.nome,onChange:a=>c({...s,nome:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Digite o nome completo",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF"}),e.jsx("input",{type:"text",value:s.cpf,onChange:a=>{c({...s,cpf:a.target.value}),q(!1),W(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"000.000.000-00",maxLength:"14"})]}),s.tipo_cadastro==="veterinario"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CRMV"}),e.jsx("input",{type:"text",value:s.crmv,onChange:a=>{c({...s,crmv:a.target.value}),q(!1),W(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"CRMV XX 1234",maxLength:"20"})]})]}),s.tipo_pessoa==="PJ"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RazÃ£o Social *"}),e.jsx("input",{type:"text",value:s.razao_social,onChange:a=>c({...s,razao_social:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"RazÃ£o social da empresa"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Fantasia *"}),e.jsx("input",{type:"text",value:s.nome,onChange:a=>c({...s,nome:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Nome fantasia da empresa",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CNPJ *"}),e.jsx("input",{type:"text",value:s.cnpj,onChange:a=>{c({...s,cnpj:a.target.value}),q(!1),W(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"00.000.000/0000-00",maxLength:"18"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"InscriÃ§Ã£o Estadual"}),e.jsx("input",{type:"text",value:s.inscricao_estadual,onChange:a=>c({...s,inscricao_estadual:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"IE"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ResponsÃ¡vel / Contato"}),e.jsx("input",{type:"text",value:s.responsavel,onChange:a=>c({...s,responsavel:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Nome do responsÃ¡vel ou contato"})]})]})]}),S===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contatos"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Celular *"}),e.jsx("input",{type:"text",value:s.celular,onChange:a=>{c({...s,celular:a.target.value}),q(!1),W(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Este nÃºmero Ã© WhatsApp?"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:s.celular_whatsapp===!0,onChange:()=>c({...s,celular_whatsapp:!0}),className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Sim"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",checked:s.celular_whatsapp===!1,onChange:()=>c({...s,celular_whatsapp:!1}),className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"NÃ£o"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone fixo"}),e.jsx("input",{type:"text",value:s.telefone,onChange:a=>{c({...s,telefone:a.target.value}),q(!1),W(null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"(00) 0000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"E-mail"}),e.jsx("input",{type:"email",value:s.email,onChange:a=>c({...s,email:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"email@exemplo.com"})]})]}),S===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"EndereÃ§o"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEP"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:s.cep,onChange:a=>{const r=a.target.value;c({...s,cep:r}),r.replace(/\D/g,"").length===8&&$e(r)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"00000-000",maxLength:"9"}),e.jsx("button",{type:"button",onClick:()=>$e(s.cep),disabled:O,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50",children:O?"Buscando...":"Buscar"})]}),Ce&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:Ce}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Digite o CEP para preencher o endereÃ§o automaticamente"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EndereÃ§o"}),e.jsx("input",{type:"text",value:s.endereco,onChange:a=>c({...s,endereco:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Rua, Avenida..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NÃºmero"}),e.jsx("input",{type:"text",value:s.numero,onChange:a=>c({...s,numero:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"123"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complemento"}),e.jsx("input",{type:"text",value:s.complemento,onChange:a=>c({...s,complemento:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Apto, Bloco..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bairro"}),e.jsx("input",{type:"text",value:s.bairro,onChange:a=>c({...s,bairro:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cidade"}),e.jsx("input",{type:"text",value:s.cidade,onChange:a=>c({...s,cidade:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),e.jsx("input",{type:"text",value:s.estado,onChange:a=>c({...s,estado:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",maxLength:"2",placeholder:"SP"})]})]})]}),S===4&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"InformaÃ§Ãµes complementares"}),e.jsxs("div",{className:"border-b pb-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800",children:"EndereÃ§os Adicionais"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Cadastre mÃºltiplos endereÃ§os para entrega, cobranÃ§a, etc."})]}),e.jsxs("button",{type:"button",onClick:()=>Fe(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Adicionar EndereÃ§o"]})]}),X.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:X.map((a,r)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${a.tipo==="entrega"?"bg-blue-100 text-blue-800":a.tipo==="cobranca"?"bg-green-100 text-green-800":a.tipo==="comercial"?"bg-purple-100 text-purple-800":a.tipo==="residencial"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:a.tipo==="entrega"?"ðŸ“¦ Entrega":a.tipo==="cobranca"?"ðŸ’° CobranÃ§a":a.tipo==="comercial"?"ðŸ¢ Comercial":a.tipo==="residencial"?"ðŸ  Residencial":"ðŸ“ Trabalho"}),e.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["+",r+1]})]}),a.apelido&&e.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-1",children:a.apelido}),e.jsxs("p",{className:"text-sm text-gray-700",children:[a.endereco,", ",a.numero,a.complemento&&` - ${a.complemento}`]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[a.bairro,", ",a.cidade,"/",a.estado]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["CEP: ",a.cep]})]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx("button",{type:"button",onClick:()=>Fe(r),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Editar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{type:"button",onClick:()=>la(r),className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Excluir",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},r))}):e.jsxs("div",{className:"text-center py-8 text-gray-500 text-sm",children:[e.jsxs("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Nenhum endereÃ§o adicional cadastrado"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MarcaÃ§Ãµes / Tags"}),e.jsx("input",{type:"text",value:s.tags,onChange:a=>c({...s,tags:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Ex: Bom pagador, Cliente fiel, VIP"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Separe por vÃ­rgula para mÃºltiplas tags"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ObservaÃ§Ãµes"}),e.jsx("textarea",{value:s.observacoes,onChange:a=>c({...s,observacoes:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",rows:"4",placeholder:"InformaÃ§Ãµes adicionais sobre o cliente..."})]})]}),S===5&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(le,{className:"text-blue-600",size:24}),"Pets do Cliente"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Use o mÃ³dulo dedicado para gerenciar pets com informaÃ§Ãµes completas"})]})}),e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(le,{className:"text-blue-600 flex-shrink-0 mt-1",size:24}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"ðŸŽ¯ GestÃ£o Profissional de Pets"}),e.jsxs("p",{className:"text-sm text-blue-800 mb-3",children:["Agora os pets possuem um ",e.jsx("strong",{children:"mÃ³dulo dedicado"})," com funcionalidades completas: histÃ³rico mÃ©dico, vacinas, consultas, serviÃ§os e muito mais."]}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 mb-4",children:[e.jsx("li",{children:"âœ… Cadastro completo com campos veterinÃ¡rios"}),e.jsx("li",{children:"âœ… HistÃ³rico de saÃºde e medicaÃ§Ãµes"}),e.jsx("li",{children:"âœ… Controle de vacinas e consultas"}),e.jsx("li",{children:"âœ… Timeline de eventos"}),e.jsx("li",{children:"âœ… Preparado para uso clÃ­nico real"})]})]})]})}),G.length>0&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Pets cadastrados (",G.length,")"]}),e.jsx("div",{className:"space-y-2",children:G.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(le,{className:"text-blue-600",size:20}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.nome}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.especie," ",a.raca&&`â€¢ ${a.raca}`]})]})]}),a.id&&e.jsx("button",{onClick:()=>f(`/pets/${a.id}`),className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm font-medium transition-colors",children:"Ver Detalhes"})]},a.id||a.nome))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>{l!=null&&l.id?f(`/pets?cliente_id=${l.id}`):alert("âš ï¸ Salve o cliente primeiro para gerenciar pets")},className:"flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all font-semibold shadow-md",children:[e.jsx(le,{size:24}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{children:"ðŸ¾ Gerenciar Pets"}),e.jsx("div",{className:"text-xs font-normal opacity-90",children:"MÃ³dulo completo de gestÃ£o"})]})]}),e.jsxs("button",{type:"button",onClick:()=>{l!=null&&l.id?f("/pets/novo",{state:{clienteId:l.id}}):alert("âš ï¸ Salve o cliente primeiro para adicionar pets")},className:"flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-lg transition-all font-semibold shadow-md",children:[e.jsx(We,{size:24}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{children:"âž• Adicionar Pet"}),e.jsx("div",{className:"text-xs font-normal opacity-90",children:"Cadastro completo"})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"Dica:"})," Pets podem ser adicionados agora ou depois. Todas as informaÃ§Ãµes mÃ©dicas e histÃ³rico ficam no mÃ³dulo dedicado de pets."]})}),!l&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-orange-800",children:["âš ï¸ ",e.jsx("strong",{children:"AtenÃ§Ã£o:"})," Salve o cliente primeiro (etapa 6) para poder gerenciar seus pets."]})})]}),S===6&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ae,{className:"text-green-600"}),"InformaÃ§Ãµes Financeiras"]}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800 mb-1",children:"ðŸ’° Saldo de CrÃ©dito"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["R$ ",l!=null&&l.credito?parseFloat(l.credito).toFixed(2).replace(".",","):"0,00"]}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"DisponÃ­vel para uso em compras"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50",disabled:!l,onClick:async()=>{var n,R;if(!l){alert("Salve o cliente primeiro antes de adicionar crÃ©dito");return}const a=prompt("Digite o valor a adicionar ao crÃ©dito:");if(!a||isNaN(parseFloat(a)))return;const r=parseFloat(a);if(r<=0){alert("Valor deve ser maior que zero");return}const t=prompt("Motivo da adiÃ§Ã£o de crÃ©dito:","Ajuste manual");if(t)try{const N=await M.post(`/clientes/${l.id}/credito/adicionar`,{valor:r,motivo:t});alert(`âœ… ${N.data.message}

CrÃ©dito anterior: R$ ${N.data.credito_anterior.toFixed(2)}
Valor adicionado: R$ ${N.data.valor_adicionado.toFixed(2)}
Novo saldo: R$ ${N.data.credito_atual.toFixed(2)}`),_({...l,credito:N.data.credito_atual}),K()}catch(N){console.error("Erro ao adicionar crÃ©dito:",N),alert("âŒ Erro ao adicionar crÃ©dito: "+(((R=(n=N.response)==null?void 0:n.data)==null?void 0:R.detail)||N.message))}},children:[e.jsx(ge,{})," Adicionar CrÃ©dito"]}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50",disabled:!l,onClick:async()=>{var R,N;if(!l){alert("Salve o cliente primeiro antes de remover crÃ©dito");return}const a=parseFloat(l.credito||0);if(a<=0){alert("Cliente nÃ£o possui crÃ©dito para remover");return}const r=prompt(`Digite o valor a remover (mÃ¡x: R$ ${a.toFixed(2)}):`);if(!r||isNaN(parseFloat(r)))return;const t=parseFloat(r);if(t<=0){alert("Valor deve ser maior que zero");return}if(t>a){alert(`Valor excede o crÃ©dito disponÃ­vel (R$ ${a.toFixed(2)})`);return}const n=prompt("Motivo da remoÃ§Ã£o de crÃ©dito:","Ajuste manual");if(n)try{const u=await M.post(`/clientes/${l.id}/credito/remover`,{valor:t,motivo:n});alert(`âœ… ${u.data.message}

CrÃ©dito anterior: R$ ${u.data.credito_anterior.toFixed(2)}
Valor removido: R$ ${u.data.valor_removido.toFixed(2)}
Novo saldo: R$ ${u.data.credito_atual.toFixed(2)}`),_({...l,credito:u.data.credito_atual}),K()}catch(u){console.error("Erro ao remover crÃ©dito:",u),alert("âŒ Erro ao remover crÃ©dito: "+(((N=(R=u.response)==null?void 0:R.data)==null?void 0:N.detail)||u.message))}},children:[e.jsx(Qe,{})," Remover CrÃ©dito"]})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ge,{}),"Resumo Financeiro (Ãšltimos 90 dias)"]}),l?e.jsx("div",{className:"space-y-4",children:ea?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600 text-sm",children:"Carregando resumo..."})]}):e.jsxs(e.Fragment,{children:[z?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"ðŸ’° Total Comprado"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",((Re=z.total_vendas)==null?void 0:Re.toFixed(2).replace(".",","))||"0,00"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[z.quantidade_vendas||0," vendas"]})]}),e.jsxs("div",{className:`rounded-lg p-4 border ${z.tem_debitos_vencidos?"bg-red-50 border-red-300":z.tem_debitos?"bg-orange-50 border-orange-200":"bg-green-50 border-green-200"}`,children:[e.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:[z.tem_debitos_vencidos?"âš ï¸":"ðŸ“‹"," Em Aberto"]}),e.jsxs("p",{className:`text-2xl font-bold ${z.tem_debitos_vencidos?"text-red-600":z.tem_debitos?"text-orange-600":"text-green-600"}`,children:["R$ ",((Le=z.total_em_aberto)==null?void 0:Le.toFixed(2).replace(".",","))||"0,00"]}),z.tem_debitos_vencidos&&e.jsxs("p",{className:"text-xs text-red-600 font-semibold mt-1",children:["R$ ",((Ie=z.total_vencido)==null?void 0:Ie.toFixed(2).replace(".",","))||"0,00"," vencido"]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"ðŸ“Š Ticket MÃ©dio"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["R$ ",((De=z.ticket_medio)==null?void 0:De.toFixed(2).replace(".",","))||"0,00"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"por compra"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"ðŸ• Ãšltima Compra"}),z.ultima_compra?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["R$ ",((Te=z.ultima_compra.valor)==null?void 0:Te.toFixed(2).replace(".",","))||"0,00"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(z.ultima_compra.data).toLocaleDateString("pt-BR")," ","(hÃ¡ ",z.ultima_compra.dias_atras," dias)"]})]}):e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Nenhuma compra"})]})]})}):e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx("p",{className:"mb-2",children:"ðŸ“‹ Nenhuma informaÃ§Ã£o financeira"}),e.jsx("p",{className:"text-sm",children:"Dados aparecerÃ£o apÃ³s a primeira venda"})]}),e.jsxs("button",{type:"button",onClick:()=>f(`/clientes/${l.id}/financeiro`),className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-lg transition-all flex items-center justify-center gap-2 font-semibold shadow-md",children:[e.jsx(Ge,{}),"ðŸ“Š Ver HistÃ³rico Financeiro Completo",z&&e.jsxs("span",{className:"text-xs bg-white bg-opacity-20 px-2 py-1 rounded",children:[z.total_transacoes_historico||0," transaÃ§Ãµes"]})]})]})}):e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-center",children:e.jsx("p",{className:"text-blue-800 text-sm",children:"â„¹ï¸ Salve o cliente primeiro para visualizar o resumo financeiro"})})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["ðŸ’¡ ",e.jsx("strong",{children:"Dica:"})," O crÃ©dito pode ser gerado automaticamente nas devoluÃ§Ãµes de produtos e utilizado como forma de pagamento no PDV."]})}),l&&e.jsx(Aa,{clienteId:l.id}),l&&e.jsx(Ia,{clienteId:l.id,cliente:l,metricas:z}),l&&l.celular&&e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"text-green-600",size:24}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"ðŸ’¬ WhatsApp"})]}),e.jsxs("button",{type:"button",onClick:()=>{const a=l.celular.replace(/\D/g,"");window.open(`https://wa.me/55${a}`,"_blank")},className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium",children:[e.jsx(ne,{}),"Abrir conversa"]})]}),e.jsx(ja,{clienteId:l.id})]}),l&&e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:e.jsx($a,{clienteId:l.tipo_cadastro==="cliente"?l.id:null,fornecedorId:l.tipo_cadastro==="fornecedor"?l.id:null,tipo:l.tipo_cadastro==="fornecedor"?"fornecedor":"cliente",limit:5,showHeader:!0,onVerMais:()=>f(`/clientes/${l.id}/timeline`)})})]})]}),e.jsxs("div",{className:"border-t border-gray-200 p-4 bg-gray-50 flex justify-between",children:[e.jsxs("button",{onClick:ba,disabled:S===1,className:"flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Pa,{})," Voltar"]}),S<6?e.jsxs("button",{onClick:ma,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:["AvanÃ§ar ",e.jsx(qe,{})]}):e.jsxs("button",{onClick:na,className:"flex items-center gap-2 px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors",children:[e.jsx(Sa,{})," Salvar Cliente"]})]})]})}),aa&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between z-10",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:b.index!==void 0?"Editar EndereÃ§o":"Adicionar Novo EndereÃ§o"}),e.jsx("button",{onClick:ye,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de EndereÃ§o *"}),e.jsxs("select",{value:b.tipo,onChange:a=>B({...b,tipo:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",children:[e.jsx("option",{value:"entrega",children:"ðŸ“¦ Entrega"}),e.jsx("option",{value:"cobranca",children:"ðŸ’° CobranÃ§a"}),e.jsx("option",{value:"comercial",children:"ðŸ¢ Comercial"}),e.jsx("option",{value:"residencial",children:"ðŸ  Residencial"}),e.jsx("option",{value:"trabalho",children:"ðŸ“ Trabalho"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apelido (opcional)"}),e.jsx("input",{type:"text",value:b.apelido,onChange:a=>B({...b,apelido:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Ex: Casa da mÃ£e, EscritÃ³rio, Loja"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEP *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:b.cep,onChange:a=>{const r=a.target.value.replace(/\D/g,""),t=r.length>5?`${r.slice(0,5)}-${r.slice(5,8)}`:r;B({...b,cep:t})},onBlur:a=>ta(a.target.value),maxLength:"9",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"00000-000"}),O&&e.jsx("div",{className:"absolute right-2 top-2",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EndereÃ§o *"}),e.jsx("input",{type:"text",value:b.endereco,onChange:a=>B({...b,endereco:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Rua, Avenida, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NÃºmero"}),e.jsx("input",{type:"text",value:b.numero,onChange:a=>B({...b,numero:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"123"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complemento"}),e.jsx("input",{type:"text",value:b.complemento,onChange:a=>B({...b,complemento:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Apto, Bloco, Sala..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bairro"}),e.jsx("input",{type:"text",value:b.bairro,onChange:a=>B({...b,bairro:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Centro, Jardim..."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cidade *"}),e.jsx("input",{type:"text",value:b.cidade,onChange:a=>B({...b,cidade:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"SÃ£o Paulo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),e.jsx("input",{type:"text",value:b.estado,onChange:a=>B({...b,estado:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",maxLength:"2",placeholder:"SP"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"* Campos obrigatÃ³rios"})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end gap-3",children:[e.jsx("button",{onClick:ye,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:oa,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Salvar EndereÃ§o"})]})]})}),e.jsx(Fa,{isOpen:D,onClose:()=>{E(!1),fetchClientes()}}),e.jsx("style",{children:`
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: scale(0.95);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }
        
        .animate-fade-in {
          animation: fadeIn 0.3s ease-out;
        }
      `})]})};export{Wa as default};
