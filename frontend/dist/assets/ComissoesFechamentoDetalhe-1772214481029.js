import{S as v,ai as w,r as l,j as e}from"./vendor-react-1772214481029.js";import{a as k}from"./index-1772214481029.js";const L=()=>{const f=v(),[m]=w(),d=m.get("funcionario_id"),i=m.get("data_pagamento"),[h,b]=l.useState(null),[y,c]=l.useState(!0),[p,n]=l.useState(null);l.useEffect(()=>{if(!d||!i){n("Parâmetros inválidos: funcionario_id e data_pagamento são obrigatórios"),c(!1);return}u()},[d,i]);const u=async()=>{var t,a;try{c(!0),n(null);const r=await k.get("/comissoes/fechamentos/detalhe",{params:{funcionario_id:d,data_pagamento:i}});r.data.success?b(r.data):n("Erro ao carregar detalhes do fechamento")}catch(r){console.error("Erro ao carregar detalhes:",r),n(((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.detail)||"Erro ao carregar detalhes do fechamento")}finally{c(!1)}},o=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),g=t=>t?new Date(t+"T00:00:00").toLocaleDateString("pt-BR"):"-",N=t=>t?new Date(t).toLocaleString("pt-BR"):"-",j=()=>{f("/comissoes/fechamentos")};if(y)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"bg-white shadow-md rounded-lg p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Carregando detalhes..."})]})})});if(p||!h)return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-6 w-6 text-red-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-red-800 font-medium",children:"Erro ao carregar dados"}),e.jsx("p",{className:"text-red-600 text-sm mt-1",children:p||"Fechamento não encontrado"})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-md transition-colors",children:"Tentar Novamente"}),e.jsx("button",{onClick:j,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-md transition-colors",children:"Voltar"})]})]})});const{fechamento:s,comissoes:x}=h;return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-8",children:[e.jsxs("div",{className:"mb-6 border-b border-gray-200 pb-4",children:[e.jsxs("button",{onClick:j,className:"mb-4 inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors",children:[e.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Voltar"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Detalhes do Fechamento"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Visualização completa das comissões incluídas neste fechamento"}),e.jsxs("div",{className:"mt-3 inline-flex items-center px-3 py-1 rounded-full bg-yellow-100 border border-yellow-300",children:[e.jsx("svg",{className:"h-4 w-4 text-yellow-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"Somente Leitura - Registro de Auditoria"})]})]}),e.jsxs("div",{className:"mb-6 bg-purple-50 border border-purple-200 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-purple-800 mb-4",children:"Informações do Fechamento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Funcionário"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-purple-200 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-purple-700 font-semibold text-sm",children:s.nome_funcionario.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.nome_funcionario}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",s.funcionario_id]})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Data do Fechamento"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:N(s.data_fechamento)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Data de Pagamento"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:g(s.data_pagamento)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Quantidade de Comissões"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:s.quantidade_comissoes})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Total"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o(s.valor_total)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Período das Vendas"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:s.periodo_vendas})]})]}),s.observacao_pagamento&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-purple-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Observações"}),e.jsx("p",{className:"text-sm text-gray-800 italic",children:s.observacao_pagamento})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Comissões Incluídas"}),x&&x.length>0?e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Venda"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qtde"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Venda"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"% Comissão"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comissão"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map((t,a)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:t.nome_cliente||"Cliente não identificado"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:t.nome_produto||"Produto não identificado"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-gray-600",children:g(t.data_venda)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-gray-600",children:t.quantidade}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm text-gray-900",children:o(t.valor_venda_snapshot)}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-gray-600",children:[t.percentual_snapshot,"%"]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-semibold text-green-600",children:o(t.valor_comissao)})]},t.id||a))}),e.jsx("tfoot",{className:"bg-gray-50 border-t-2 border-gray-300",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"6",className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"TOTAL:"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-base font-bold text-green-700",children:o(s.valor_total)})]})})]})}):e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:e.jsx("p",{className:"text-yellow-800",children:"Nenhuma comissão encontrada para este fechamento."})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"h-5 w-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-1",children:"Informações Importantes"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Este é um registro imutável de auditoria"}),e.jsx("li",{children:"Não é possível editar ou reverter fechamentos realizados"}),e.jsx("li",{children:"Os valores foram capturados no momento do fechamento (snapshot)"}),e.jsx("li",{children:"Para questões sobre este fechamento, entre em contato com a administração"})]})]})]})})]})})};export{L as default};
