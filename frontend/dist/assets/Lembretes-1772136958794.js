import{r as o,z as c,j as e,i as u,ap as g,_ as f,ac as C}from"./vendor-react-1772136958794.js";import{a as d}from"./index-1772136958794.js";function L(){const[a,m]=o.useState([]),[h,i]=o.useState(!1),[n,b]=o.useState("pendente");o.useEffect(()=>{r();const s=setInterval(r,6e4);return()=>clearInterval(s)},[]);const r=async()=>{i(!0);try{const s=await d.get("/api/lembretes/pendentes");m(s.data.lembretes||[])}catch(s){console.error("Erro ao carregar lembretes:",s),c.error("Erro ao carregar lembretes")}finally{i(!1)}},t=async s=>{try{await d.post(`/api/lembretes/${s}/completar`,{}),c.success("Lembrete marcado como completado"),r()}catch{c.error("Erro ao completar lembrete")}},l=async s=>{try{await d.post(`/api/lembretes/${s}/renovar`,{}),c.success("Lembrete renovado com sucesso"),r()}catch{c.error("Erro ao renovar lembrete")}},x=async s=>{if(window.confirm("Tem certeza que deseja cancelar este lembrete?"))try{await d.delete(`/api/lembretes/${s}`),c.success("Lembrete cancelado"),r()}catch{c.error("Erro ao cancelar lembrete")}},p=a.filter(s=>s.dias_restantes<=7),j=a.filter(s=>s.dias_restantes<0);return e.jsxs("div",{className:"lembretes-container",children:[e.jsxs("div",{className:"lembretes-header",children:[e.jsx("h1",{children:"ðŸ“Œ Lembretes de RecorrÃªncia"}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-number",children:a.length}),e.jsx("span",{className:"stat-label",children:"Total de Lembretes"})]}),e.jsxs("div",{className:"stat-card warning",children:[e.jsx("span",{className:"stat-number",children:p.length}),e.jsx("span",{className:"stat-label",children:"PrÃ³ximos em 7 dias"})]}),e.jsxs("div",{className:"stat-card danger",children:[e.jsx("span",{className:"stat-number",children:j.length}),e.jsx("span",{className:"stat-label",children:"Vencidos"})]})]})]}),h&&e.jsx("div",{className:"loading",children:"Carregando lembretes..."}),a.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx(u,{size:48}),e.jsx("h2",{children:"Nenhum lembrete pendente"}),e.jsx("p",{children:"Lembretes serÃ£o criados automaticamente para produtos recorrentes."})]}):e.jsxs("div",{className:"lembretes-list",children:[j.length>0&&e.jsxs("div",{className:"section",children:[e.jsx("h3",{className:"section-title danger",children:"âš ï¸ Vencidos"}),j.map(s=>e.jsx(N,{lembrete:s,onCompletar:t,onRenovar:l,onCancelar:x},s.id))]}),p.length>0&&e.jsxs("div",{className:"section",children:[e.jsx("h3",{className:"section-title warning",children:"ðŸ”” PrÃ³ximos em atÃ© 7 dias"}),p.map(s=>e.jsx(N,{lembrete:s,onCompletar:t,onRenovar:l,onCancelar:x},s.id))]}),a.filter(s=>s.dias_restantes>7).length>0&&e.jsxs("div",{className:"section",children:[e.jsx("h3",{className:"section-title",children:"ðŸ“… PrÃ³ximos (mais de 7 dias)"}),a.filter(s=>s.dias_restantes>7).map(s=>e.jsx(N,{lembrete:s,onCompletar:t,onRenovar:l,onCancelar:x},s.id))]})]})]})}function N({lembrete:a,onCompletar:m,onRenovar:h,onCancelar:i}){const n=a.dias_restantes,b=new Date(a.data_proxima_dose),r=n<0?"vencido":n<=7?"proximo":"futuro",t=a.dose_total&&a.dose_total>0,l=t?a.dose_atual/a.dose_total*100:0;return e.jsxs("div",{className:`lembrete-card ${r}`,children:[e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h4",{children:a.produto_nome}),e.jsxs("div",{className:"badges",children:[t&&e.jsxs("span",{className:"dose-badge",children:["Dose ",a.dose_atual,"/",a.dose_total]}),e.jsx("span",{className:`status-badge ${r}`,children:n<0?"VENCIDO":`${Math.abs(n)}d`})]})]}),t&&e.jsx("div",{className:"progress-bar-container",children:e.jsx("div",{className:"progress-bar",style:{width:`${l}%`}})}),e.jsxs("div",{className:"card-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"Pet:"}),e.jsx("span",{className:"value",children:a.pet_nome})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"Data:"}),e.jsx("span",{className:"value",children:b.toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"Quantidade:"}),e.jsx("span",{className:"value",children:a.quantidade})]}),a.preco_estimado&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"PreÃ§o Est.:"}),e.jsxs("span",{className:"value",children:["R$ ",a.preco_estimado.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"card-actions",children:[e.jsxs("button",{className:"btn btn-success",onClick:()=>m(a.id),title:"Marcar como completado",children:[e.jsx(g,{})," Comprado"]}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>h(a.id),title:"Renovar lembrete",children:[e.jsx(f,{})," Renovar"]}),e.jsx("button",{className:"btn btn-danger",onClick:()=>i(a.id),title:"Cancelar lembrete",children:e.jsx(C,{})})]})]})}export{L as default};
