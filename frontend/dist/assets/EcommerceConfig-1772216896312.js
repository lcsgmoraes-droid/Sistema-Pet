import{r as t,j as e}from"./vendor-react-1772216896312.js";import{a as x}from"./api-1772216896312.js";import"./index-1772216896312.js";const P=[{key:"seg",label:"Segunda"},{key:"ter",label:"TerÃ§a"},{key:"qua",label:"Quarta"},{key:"qui",label:"Quinta"},{key:"sex",label:"Sexta"},{key:"sab",label:"SÃ¡bado"},{key:"dom",label:"Domingo"}];function $(o){return o?o.split(",").map(i=>i.trim()).filter(Boolean):[]}function F(o){return o.join(",")}function T(){const[o,i]=t.useState(!0),[g,h]=t.useState(!1),[f,l]=t.useState(""),[b,c]=t.useState(""),[n,p]=t.useState(!0),[d,y]=t.useState(""),[j,v]=t.useState(""),[N,w]=t.useState(""),[m,_]=t.useState([]),[u,k]=t.useState([]),[A,C]=t.useState(!0);t.useEffect(()=>{D(),E()},[]);async function D(){try{const a=(await x.get("/ecommerce-config")).data;p(a.ecommerce_ativo??!0),y(a.ecommerce_descricao||""),v(a.ecommerce_horario_abertura||""),w(a.ecommerce_horario_fechamento||""),_($(a.ecommerce_dias_funcionamento))}catch{c("NÃ£o foi possÃ­vel carregar as configuraÃ§Ãµes.")}finally{i(!1)}}async function E(){try{const s=await x.get("/ecommerce-notify/pendentes");k(s.data||[])}catch{}finally{C(!1)}}async function q(s){s.preventDefault(),h(!0),c(""),l("");try{await x.put("/ecommerce-config",{ecommerce_ativo:n,ecommerce_descricao:d||null,ecommerce_horario_abertura:j||null,ecommerce_horario_fechamento:N||null,ecommerce_dias_funcionamento:m.length>0?F(m):null}),l("ConfiguraÃ§Ãµes salvas com sucesso!"),setTimeout(()=>l(""),4e3)}catch{c("Erro ao salvar. Tente novamente.")}finally{h(!1)}}function L(s){_(a=>a.includes(s)?a.filter(r=>r!==s):[...a,s])}if(o)return e.jsx("div",{className:"flex items-center justify-center min-h-[300px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})});const S=u.reduce((s,a)=>{const r=`${a.product_id}__${a.product_name||"Produto"}`;return s[r]||(s[r]={product_id:a.product_id,product_name:a.product_name||"Produto",emails:[]}),s[r].emails.push(a.email),s},{});return e.jsxs("div",{className:"max-w-2xl mx-auto p-6 space-y-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"âš™ï¸ ConfiguraÃ§Ãµes da Loja Virtual"}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg px-4 py-3 text-sm",children:b}),f&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 rounded-lg px-4 py-3 text-sm",children:f}),e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm space-y-4",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"Status da Loja"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Loja online"}),e.jsx("p",{className:"text-sm text-gray-500",children:n?"Sua loja estÃ¡ visÃ­vel e aceitando pedidos.":"Sua loja estÃ¡ offline. Clientes nÃ£o conseguem fazer pedidos."})]}),e.jsx("button",{type:"button",onClick:()=>p(s=>!s),className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors focus:outline-none ${n?"bg-indigo-500":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow transition-transform ${n?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm space-y-3",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"DescriÃ§Ã£o da Loja"}),e.jsx("textarea",{value:d,onChange:s=>y(s.target.value),rows:3,maxLength:500,placeholder:"Ex.: Petshop especializado em cÃ£es e gatos. Atendemos com carinho! ðŸ¾",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 resize-none"}),e.jsxs("p",{className:"text-xs text-gray-400 text-right",children:[d.length,"/500"]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm space-y-4",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"HorÃ¡rio de Funcionamento"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Exibido como informaÃ§Ã£o na loja. NÃ£o bloqueia pedidos fora do horÃ¡rio."}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Abertura"}),e.jsx("input",{type:"time",value:j,onChange:s=>v(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400"})]}),e.jsx("span",{className:"text-gray-400 mt-5",children:"atÃ©"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Fechamento"}),e.jsx("input",{type:"time",value:N,onChange:s=>w(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"Dias de funcionamento"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(s=>e.jsx("button",{type:"button",onClick:()=>L(s.key),className:`px-3 py-1 rounded-full text-sm font-medium border transition-colors ${m.includes(s.key)?"bg-indigo-500 text-white border-indigo-500":"bg-white text-gray-600 border-gray-300 hover:border-indigo-400"}`,children:s.label},s.key))})]})]}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 text-white font-semibold py-2.5 rounded-xl transition-colors",children:g?"Salvandoâ€¦":"Salvar ConfiguraÃ§Ãµes"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-800",children:"ðŸ”” Avisos de Estoque Pendentes"}),u.length>0&&e.jsx("span",{className:"bg-red-100 text-red-600 text-xs font-bold px-2 py-0.5 rounded-full",children:u.length})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Clientes que pediram para ser avisados quando um produto voltar ao estoque. Os emails sÃ£o enviados automaticamente quando vocÃª aumenta o estoque do produto."}),A?e.jsx("div",{className:"animate-pulse h-10 bg-gray-100 rounded"}):Object.keys(S).length===0?e.jsx("p",{className:"text-sm text-gray-400 italic",children:"Nenhum aviso pendente no momento."}):e.jsx("div",{className:"space-y-3",children:Object.values(S).map(s=>e.jsxs("div",{className:"border border-gray-100 rounded-lg p-3 space-y-1",children:[e.jsx("p",{className:"font-medium text-sm text-gray-800",children:s.product_name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.emails.length," cliente",s.emails.length!==1?"s":""," aguardando:"," ",e.jsx("span",{className:"text-gray-400",children:s.emails.join(", ")})]})]},s.product_id))})]})]})}export{T as default};
