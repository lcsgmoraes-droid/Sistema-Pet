"""create_all_tables

Revision ID: b2761c83a5dd
Revises: 3ae989fa5fa3
Create Date: 2026-01-26 00:12:04.797058

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision: str = 'b2761c83a5dd'
down_revision: Union[str, Sequence[str], None] = '3ae989fa5fa3'
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('caixas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('numero_caixa', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('usuario_nome', sa.String(length=200), nullable=False),
    sa.Column('data_abertura', sa.DateTime(), nullable=False),
    sa.Column('data_fechamento', sa.DateTime(), nullable=True),
    sa.Column('valor_abertura', sa.Float(), nullable=False),
    sa.Column('valor_esperado', sa.Float(), nullable=True),
    sa.Column('valor_informado', sa.Float(), nullable=True),
    sa.Column('diferenca', sa.Float(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('conta_origem_id', sa.Integer(), nullable=True),
    sa.Column('conta_origem_nome', sa.String(length=200), nullable=True),
    sa.Column('observacoes_abertura', sa.Text(), nullable=True),
    sa.Column('observacoes_fechamento', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_caixas_id'), 'caixas', ['id'], unique=False)
    op.create_table('configuracao_impostos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('percentual', sa.Numeric(precision=5, scale=2), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('padrao', sa.Boolean(), nullable=True),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_configuracao_impostos_id'), 'configuracao_impostos', ['id'], unique=False)
    op.create_table('contexto_financeiro_chat',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('tipo_contexto', sa.String(length=50), nullable=False),
    sa.Column('dados', sa.JSON(), nullable=False),
    sa.Column('criado_em', sa.DateTime(), nullable=False),
    sa.Column('valido_ate', sa.DateTime(), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_contexto_financeiro_chat_id'), 'contexto_financeiro_chat', ['id'], unique=False)
    op.create_index(op.f('ix_contexto_financeiro_chat_usuario_id'), 'contexto_financeiro_chat', ['usuario_id'], unique=False)
    op.create_table('conversas_ia',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('titulo', sa.String(length=200), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=False),
    sa.Column('atualizado_em', sa.DateTime(), nullable=True),
    sa.Column('finalizada', sa.Boolean(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_conversas_ia_id'), 'conversas_ia', ['id'], unique=False)
    op.create_index(op.f('ix_conversas_ia_usuario_id'), 'conversas_ia', ['usuario_id'], unique=False)
    op.create_table('dre_periodos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=True),
    sa.Column('data_inicio', sa.Date(), nullable=False),
    sa.Column('data_fim', sa.Date(), nullable=False),
    sa.Column('mes', sa.Integer(), nullable=True),
    sa.Column('ano', sa.Integer(), nullable=True),
    sa.Column('canal', sa.String(length=50), nullable=True),
    sa.Column('canais_incluidos', sa.Text(), nullable=True),
    sa.Column('receita_bruta', sa.Float(), nullable=True),
    sa.Column('deducoes_receita', sa.Float(), nullable=True),
    sa.Column('receita_liquida', sa.Float(), nullable=True),
    sa.Column('custo_produtos_vendidos', sa.Float(), nullable=True),
    sa.Column('lucro_bruto', sa.Float(), nullable=True),
    sa.Column('margem_bruta_percent', sa.Float(), nullable=True),
    sa.Column('despesas_vendas', sa.Float(), nullable=True),
    sa.Column('despesas_administrativas', sa.Float(), nullable=True),
    sa.Column('despesas_financeiras', sa.Float(), nullable=True),
    sa.Column('outras_despesas', sa.Float(), nullable=True),
    sa.Column('total_despesas_operacionais', sa.Float(), nullable=True),
    sa.Column('lucro_operacional', sa.Float(), nullable=True),
    sa.Column('margem_operacional_percent', sa.Float(), nullable=True),
    sa.Column('impostos', sa.Float(), nullable=True),
    sa.Column('impostos_detalhamento', sa.Text(), nullable=True),
    sa.Column('aliquota_efetiva_percent', sa.Float(), nullable=True),
    sa.Column('regime_tributario', sa.String(length=50), nullable=True),
    sa.Column('lucro_liquido', sa.Float(), nullable=True),
    sa.Column('margem_liquida_percent', sa.Float(), nullable=True),
    sa.Column('status', sa.String(length=50), nullable=True),
    sa.Column('tendencia', sa.String(length=50), nullable=True),
    sa.Column('score_saude', sa.Integer(), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.Column('atualizado_em', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_dre_periodos_id'), 'dre_periodos', ['id'], unique=False)
    op.create_index(op.f('ix_dre_periodos_usuario_id'), 'dre_periodos', ['usuario_id'], unique=False)
    op.create_table('idempotency_keys',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('endpoint', sa.String(length=255), nullable=False),
    sa.Column('chave_idempotencia', sa.String(length=255), nullable=False),
    sa.Column('request_hash', sa.String(length=64), nullable=False),
    sa.Column('status', sa.String(length=50), nullable=False),
    sa.Column('response_status_code', sa.Integer(), nullable=True),
    sa.Column('response_body', sa.Text(), nullable=True),
    sa.Column('error_message', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('completed_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_created_at', 'idempotency_keys', ['created_at'], unique=False)
    op.create_index('idx_user_key', 'idempotency_keys', ['user_id', 'chave_idempotencia'], unique=False)
    op.create_index(op.f('ix_idempotency_keys_chave_idempotencia'), 'idempotency_keys', ['chave_idempotencia'], unique=False)
    op.create_index(op.f('ix_idempotency_keys_id'), 'idempotency_keys', ['id'], unique=False)
    op.create_index(op.f('ix_idempotency_keys_user_id'), 'idempotency_keys', ['user_id'], unique=False)
    op.create_table('indices_mercado',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('setor', sa.String(length=100), nullable=False),
    sa.Column('descricao', sa.String(length=255), nullable=True),
    sa.Column('cmv_ideal_min', sa.Float(), nullable=True),
    sa.Column('cmv_ideal_max', sa.Float(), nullable=True),
    sa.Column('margem_bruta_ideal_min', sa.Float(), nullable=True),
    sa.Column('margem_bruta_ideal_max', sa.Float(), nullable=True),
    sa.Column('margem_liquida_ideal_min', sa.Float(), nullable=True),
    sa.Column('margem_liquida_ideal_max', sa.Float(), nullable=True),
    sa.Column('despesas_admin_ideal_max', sa.Float(), nullable=True),
    sa.Column('despesas_vendas_ideal_max', sa.Float(), nullable=True),
    sa.Column('despesas_financeiras_ideal_max', sa.Float(), nullable=True),
    sa.Column('despesas_totais_ideal_max', sa.Float(), nullable=True),
    sa.Column('impostos_ideal_min', sa.Float(), nullable=True),
    sa.Column('impostos_ideal_max', sa.Float(), nullable=True),
    sa.Column('ticket_medio_ideal_min', sa.Float(), nullable=True),
    sa.Column('ticket_medio_ideal_max', sa.Float(), nullable=True),
    sa.Column('giro_estoque_ideal_dias', sa.Integer(), nullable=True),
    sa.Column('prazo_recebimento_ideal_dias', sa.Integer(), nullable=True),
    sa.Column('prazo_pagamento_ideal_dias', sa.Integer(), nullable=True),
    sa.Column('fonte', sa.String(length=255), nullable=True),
    sa.Column('referencia_ano', sa.Integer(), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('atualizado_em', sa.DateTime(), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_indices_mercado_id'), 'indices_mercado', ['id'], unique=False)
    op.create_index(op.f('ix_indices_mercado_setor'), 'indices_mercado', ['setor'], unique=False)
    op.create_table('racas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('especie', sa.String(length=50), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_racas_especie'), 'racas', ['especie'], unique=False)
    op.create_index(op.f('ix_racas_id'), 'racas', ['id'], unique=False)
    op.create_index(op.f('ix_racas_nome'), 'racas', ['nome'], unique=False)
    op.create_table('users',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('email', sa.String(length=255), nullable=False),
    sa.Column('hashed_password', sa.String(length=255), nullable=True),
    sa.Column('is_active', sa.Boolean(), nullable=True),
    sa.Column('is_admin', sa.Boolean(), nullable=True),
    sa.Column('nome', sa.String(length=255), nullable=True),
    sa.Column('telefone', sa.String(length=50), nullable=True),
    sa.Column('cpf_cnpj', sa.String(length=20), nullable=True),
    sa.Column('foto_url', sa.String(length=500), nullable=True),
    sa.Column('consent_date', sa.DateTime(timezone=True), nullable=True),
    sa.Column('two_factor_enabled', sa.Boolean(), nullable=True),
    sa.Column('two_factor_secret', sa.String(length=32), nullable=True),
    sa.Column('backup_codes', sa.Text(), nullable=True),
    sa.Column('reset_token', sa.String(length=255), nullable=True),
    sa.Column('reset_token_expires', sa.DateTime(timezone=True), nullable=True),
    sa.Column('oauth_provider', sa.String(length=50), nullable=True),
    sa.Column('oauth_id', sa.String(length=255), nullable=True),
    sa.Column('nome_loja', sa.String(length=255), nullable=True),
    sa.Column('endereco_loja', sa.Text(), nullable=True),
    sa.Column('telefone_loja', sa.String(length=50), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_users_email'), 'users', ['email'], unique=True)
    op.create_index(op.f('ix_users_id'), 'users', ['id'], unique=False)
    op.create_index(op.f('ix_users_reset_token'), 'users', ['reset_token'], unique=False)
    op.create_table('arquivos_extrato_importados',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('nome_arquivo', sa.String(length=500), nullable=False),
    sa.Column('tipo_arquivo', sa.String(length=20), nullable=True),
    sa.Column('tamanho_bytes', sa.Integer(), nullable=True),
    sa.Column('hash_arquivo', sa.String(length=64), nullable=True),
    sa.Column('data_upload', sa.DateTime(), nullable=True),
    sa.Column('data_processamento_inicio', sa.DateTime(), nullable=True),
    sa.Column('data_processamento_fim', sa.DateTime(), nullable=True),
    sa.Column('tempo_processamento_segundos', sa.Float(), nullable=True),
    sa.Column('banco_detectado', sa.String(length=100), nullable=True),
    sa.Column('formato_detectado', sa.String(length=50), nullable=True),
    sa.Column('total_transacoes', sa.Integer(), nullable=True),
    sa.Column('total_categorizado_automatico', sa.Integer(), nullable=True),
    sa.Column('total_precisa_revisao', sa.Integer(), nullable=True),
    sa.Column('total_processado', sa.Integer(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('mensagem_erro', sa.Text(), nullable=True),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_arquivos_extrato_importados_hash_arquivo'), 'arquivos_extrato_importados', ['hash_arquivo'], unique=False)
    op.create_index(op.f('ix_arquivos_extrato_importados_id'), 'arquivos_extrato_importados', ['id'], unique=False)
    op.create_table('audit_logs',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=True),
    sa.Column('action', sa.String(length=100), nullable=False),
    sa.Column('entity_type', sa.String(length=50), nullable=True),
    sa.Column('entity_id', sa.Integer(), nullable=True),
    sa.Column('old_value', sa.Text(), nullable=True),
    sa.Column('new_value', sa.Text(), nullable=True),
    sa.Column('details', sa.Text(), nullable=True),
    sa.Column('ip_address', sa.String(length=50), nullable=True),
    sa.Column('user_agent', sa.Text(), nullable=True),
    sa.Column('timestamp', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_audit_logs_action'), 'audit_logs', ['action'], unique=False)
    op.create_index(op.f('ix_audit_logs_entity_type'), 'audit_logs', ['entity_type'], unique=False)
    op.create_index(op.f('ix_audit_logs_id'), 'audit_logs', ['id'], unique=False)
    op.create_index(op.f('ix_audit_logs_timestamp'), 'audit_logs', ['timestamp'], unique=False)
    op.create_index(op.f('ix_audit_logs_user_id'), 'audit_logs', ['user_id'], unique=False)
    op.create_table('categorias',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('categoria_pai_id', sa.Integer(), nullable=True),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('icone', sa.String(length=50), nullable=True),
    sa.Column('cor', sa.String(length=7), nullable=True),
    sa.Column('ordem', sa.Integer(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_pai_id'], ['categorias.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('categorias_financeiras',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('cor', sa.String(length=7), nullable=True),
    sa.Column('icone', sa.String(length=50), nullable=True),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('categoria_pai_id', sa.Integer(), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_pai_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_categorias_financeiras_id'), 'categorias_financeiras', ['id'], unique=False)
    op.create_table('clientes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('codigo', sa.String(length=20), nullable=True),
    sa.Column('tipo_cadastro', sa.String(length=50), nullable=False),
    sa.Column('tipo_pessoa', sa.String(length=2), nullable=False),
    sa.Column('nome', sa.String(length=255), nullable=False),
    sa.Column('cpf', sa.String(length=14), nullable=True),
    sa.Column('telefone', sa.String(length=50), nullable=True),
    sa.Column('celular', sa.String(length=50), nullable=True),
    sa.Column('email', sa.String(length=255), nullable=True),
    sa.Column('cnpj', sa.String(length=18), nullable=True),
    sa.Column('inscricao_estadual', sa.String(length=20), nullable=True),
    sa.Column('razao_social', sa.String(length=255), nullable=True),
    sa.Column('nome_fantasia', sa.String(length=255), nullable=True),
    sa.Column('responsavel', sa.String(length=255), nullable=True),
    sa.Column('crmv', sa.String(length=20), nullable=True),
    sa.Column('parceiro_ativo', sa.Boolean(), server_default='0', nullable=False),
    sa.Column('parceiro_desde', sa.DateTime(timezone=True), nullable=True),
    sa.Column('parceiro_observacoes', sa.Text(), nullable=True),
    sa.Column('parceiro_tipo_acerto', sa.String(length=20), server_default='mensal', nullable=False),
    sa.Column('parceiro_dia_acerto', sa.Integer(), server_default='1', nullable=False),
    sa.Column('parceiro_notificar', sa.Boolean(), server_default='1', nullable=False),
    sa.Column('parceiro_email_principal', sa.String(length=255), nullable=True),
    sa.Column('parceiro_emails_copia', sa.Text(), nullable=True),
    sa.Column('cep', sa.String(length=10), nullable=True),
    sa.Column('endereco', sa.Text(), nullable=True),
    sa.Column('numero', sa.String(length=20), nullable=True),
    sa.Column('complemento', sa.String(length=100), nullable=True),
    sa.Column('bairro', sa.String(length=100), nullable=True),
    sa.Column('cidade', sa.String(length=100), nullable=True),
    sa.Column('estado', sa.String(length=2), nullable=True),
    sa.Column('endereco_entrega', sa.Text(), nullable=True),
    sa.Column('endereco_entrega_2', sa.Text(), nullable=True),
    sa.Column('enderecos_adicionais', sa.JSON(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('credito', sa.DECIMAL(precision=10, scale=2), server_default='0.0', nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_clientes_cnpj'), 'clientes', ['cnpj'], unique=False)
    op.create_index(op.f('ix_clientes_codigo'), 'clientes', ['codigo'], unique=False)
    op.create_index(op.f('ix_clientes_cpf'), 'clientes', ['cpf'], unique=False)
    op.create_index(op.f('ix_clientes_crmv'), 'clientes', ['crmv'], unique=False)
    op.create_index(op.f('ix_clientes_id'), 'clientes', ['id'], unique=False)
    op.create_index(op.f('ix_clientes_nome'), 'clientes', ['nome'], unique=False)
    op.create_index(op.f('ix_clientes_tipo_cadastro'), 'clientes', ['tipo_cadastro'], unique=False)
    op.create_index(op.f('ix_clientes_tipo_pessoa'), 'clientes', ['tipo_pessoa'], unique=False)
    op.create_index(op.f('ix_clientes_user_id'), 'clientes', ['user_id'], unique=False)
    op.create_table('configuracao_tributaria',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('regime', sa.String(length=50), nullable=False),
    sa.Column('anexo_simples', sa.String(length=20), nullable=True),
    sa.Column('faixa_simples', sa.String(length=50), nullable=True),
    sa.Column('aliquota_efetiva_simples', sa.Float(), nullable=True),
    sa.Column('presuncao_lucro_percentual', sa.Float(), nullable=True),
    sa.Column('aliquota_irpj', sa.Float(), nullable=True),
    sa.Column('aliquota_adicional_irpj', sa.Float(), nullable=True),
    sa.Column('aliquota_csll', sa.Float(), nullable=True),
    sa.Column('aliquota_pis', sa.Float(), nullable=True),
    sa.Column('aliquota_cofins', sa.Float(), nullable=True),
    sa.Column('estado', sa.String(length=2), nullable=True),
    sa.Column('aliquota_icms', sa.Float(), nullable=True),
    sa.Column('incluir_icms_dre', sa.Boolean(), nullable=True),
    sa.Column('aliquota_iss', sa.Float(), nullable=True),
    sa.Column('incluir_iss_dre', sa.Boolean(), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.Column('atualizado_em', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('usuario_id')
    )
    op.create_index(op.f('ix_configuracao_tributaria_id'), 'configuracao_tributaria', ['id'], unique=False)
    op.create_table('configuracoes_entrega',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('valor_por_km', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('taxa_minima', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('raio_maximo_km', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('lojas', sa.Text(), nullable=True),
    sa.Column('google_maps_api_key', sa.String(length=255), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('user_id')
    )
    op.create_index(op.f('ix_configuracoes_entrega_id'), 'configuracoes_entrega', ['id'], unique=False)
    op.create_table('contas_bancarias',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('banco', sa.String(length=50), nullable=True),
    sa.Column('agencia', sa.String(length=10), nullable=True),
    sa.Column('conta', sa.String(length=20), nullable=True),
    sa.Column('saldo_inicial', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('saldo_atual', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('cor', sa.String(length=7), nullable=True),
    sa.Column('icone', sa.String(length=50), nullable=True),
    sa.Column('ativa', sa.Boolean(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_contas_bancarias_ativa'), 'contas_bancarias', ['ativa'], unique=False)
    op.create_index(op.f('ix_contas_bancarias_id'), 'contas_bancarias', ['id'], unique=False)
    op.create_index(op.f('ix_contas_bancarias_tipo'), 'contas_bancarias', ['tipo'], unique=False)
    op.create_index(op.f('ix_contas_bancarias_user_id'), 'contas_bancarias', ['user_id'], unique=False)
    op.create_table('departamentos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('dre_categorias',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('dre_periodo_id', sa.Integer(), nullable=True),
    sa.Column('usuario_id', sa.Integer(), nullable=True),
    sa.Column('categoria_nome', sa.String(length=100), nullable=True),
    sa.Column('quantidade_vendida', sa.Integer(), nullable=True),
    sa.Column('receita_total', sa.Float(), nullable=True),
    sa.Column('custo_total', sa.Float(), nullable=True),
    sa.Column('lucro_total', sa.Float(), nullable=True),
    sa.Column('margem_percent', sa.Float(), nullable=True),
    sa.Column('participacao_receita_percent', sa.Float(), nullable=True),
    sa.Column('eh_categoria_principal', sa.Boolean(), nullable=True),
    sa.Column('tendencia', sa.String(length=50), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['dre_periodo_id'], ['dre_periodos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_dre_categorias_id'), 'dre_categorias', ['id'], unique=False)
    op.create_index(op.f('ix_dre_categorias_usuario_id'), 'dre_categorias', ['usuario_id'], unique=False)
    op.create_table('dre_comparacoes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=True),
    sa.Column('periodo1_id', sa.Integer(), nullable=True),
    sa.Column('periodo2_id', sa.Integer(), nullable=True),
    sa.Column('var_receita_percent', sa.Float(), nullable=True),
    sa.Column('var_custo_percent', sa.Float(), nullable=True),
    sa.Column('var_lucro_bruto_percent', sa.Float(), nullable=True),
    sa.Column('var_despesas_percent', sa.Float(), nullable=True),
    sa.Column('var_lucro_liquido_percent', sa.Float(), nullable=True),
    sa.Column('resumo', sa.Text(), nullable=True),
    sa.Column('principais_mudancas', sa.Text(), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['periodo1_id'], ['dre_periodos.id'], ),
    sa.ForeignKeyConstraint(['periodo2_id'], ['dre_periodos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_dre_comparacoes_id'), 'dre_comparacoes', ['id'], unique=False)
    op.create_index(op.f('ix_dre_comparacoes_usuario_id'), 'dre_comparacoes', ['usuario_id'], unique=False)
    op.create_table('dre_insights',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('dre_periodo_id', sa.Integer(), nullable=True),
    sa.Column('usuario_id', sa.Integer(), nullable=True),
    sa.Column('tipo', sa.String(length=50), nullable=True),
    sa.Column('categoria', sa.String(length=50), nullable=True),
    sa.Column('titulo', sa.String(length=255), nullable=True),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('impacto', sa.String(length=20), nullable=True),
    sa.Column('acao_sugerida', sa.Text(), nullable=True),
    sa.Column('impacto_estimado', sa.Float(), nullable=True),
    sa.Column('foi_lido', sa.Boolean(), nullable=True),
    sa.Column('foi_aplicado', sa.Boolean(), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['dre_periodo_id'], ['dre_periodos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_dre_insights_id'), 'dre_insights', ['id'], unique=False)
    op.create_index(op.f('ix_dre_insights_usuario_id'), 'dre_insights', ['usuario_id'], unique=False)
    op.create_table('dre_produtos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('dre_periodo_id', sa.Integer(), nullable=True),
    sa.Column('usuario_id', sa.Integer(), nullable=True),
    sa.Column('produto_id', sa.Integer(), nullable=True),
    sa.Column('produto_nome', sa.String(length=255), nullable=True),
    sa.Column('categoria', sa.String(length=100), nullable=True),
    sa.Column('quantidade_vendida', sa.Integer(), nullable=True),
    sa.Column('receita_total', sa.Float(), nullable=True),
    sa.Column('custo_total', sa.Float(), nullable=True),
    sa.Column('lucro_total', sa.Float(), nullable=True),
    sa.Column('margem_percent', sa.Float(), nullable=True),
    sa.Column('ranking_rentabilidade', sa.Integer(), nullable=True),
    sa.Column('eh_lucrativo', sa.Boolean(), nullable=True),
    sa.Column('recomendacao', sa.Text(), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['dre_periodo_id'], ['dre_periodos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_dre_produtos_id'), 'dre_produtos', ['id'], unique=False)
    op.create_index(op.f('ix_dre_produtos_produto_id'), 'dre_produtos', ['produto_id'], unique=False)
    op.create_index(op.f('ix_dre_produtos_usuario_id'), 'dre_produtos', ['usuario_id'], unique=False)
    op.create_table('emails_templates',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('codigo', sa.String(length=50), nullable=False),
    sa.Column('nome', sa.String(length=255), nullable=False),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('assunto', sa.String(length=255), nullable=False),
    sa.Column('corpo_html', sa.Text(), nullable=False),
    sa.Column('corpo_texto', sa.Text(), nullable=True),
    sa.Column('placeholders', sa.JSON(), nullable=True),
    sa.Column('categoria', sa.String(length=50), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_emails_templates_codigo'), 'emails_templates', ['codigo'], unique=True)
    op.create_index(op.f('ix_emails_templates_id'), 'emails_templates', ['id'], unique=False)
    op.create_index(op.f('ix_emails_templates_user_id'), 'emails_templates', ['user_id'], unique=False)
    op.create_table('fluxo_caixa',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('tipo', sa.String(), nullable=False),
    sa.Column('categoria', sa.String(), nullable=False),
    sa.Column('descricao', sa.String(length=500), nullable=True),
    sa.Column('valor', sa.Float(), nullable=False),
    sa.Column('data_movimentacao', sa.DateTime(), nullable=True),
    sa.Column('data_prevista', sa.DateTime(), nullable=True),
    sa.Column('status', sa.String(), nullable=False),
    sa.Column('origem_tipo', sa.String(), nullable=True),
    sa.Column('origem_id', sa.Integer(), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.Column('atualizado_em', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_fluxo_usuario_data', 'fluxo_caixa', ['usuario_id', 'data_movimentacao'], unique=False)
    op.create_index('idx_fluxo_usuario_status', 'fluxo_caixa', ['usuario_id', 'status'], unique=False)
    op.create_index('idx_fluxo_usuario_tipo', 'fluxo_caixa', ['usuario_id', 'tipo'], unique=False)
    op.create_table('historico_atualizacao_dre',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('dre_periodo_id', sa.Integer(), nullable=False),
    sa.Column('tipo_alteracao', sa.String(length=50), nullable=True),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('valores_anteriores', sa.JSON(), nullable=True),
    sa.Column('valores_novos', sa.JSON(), nullable=True),
    sa.Column('diferencas', sa.JSON(), nullable=True),
    sa.Column('usuario_alteracao_id', sa.Integer(), nullable=True),
    sa.Column('data_alteracao', sa.DateTime(), nullable=True),
    sa.Column('motivo', sa.Text(), nullable=True),
    sa.Column('aprovado_por', sa.Integer(), nullable=True),
    sa.ForeignKeyConstraint(['aprovado_por'], ['users.id'], ),
    sa.ForeignKeyConstraint(['dre_periodo_id'], ['dre_periodos.id'], ),
    sa.ForeignKeyConstraint(['usuario_alteracao_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_historico_atualizacao_dre_id'), 'historico_atualizacao_dre', ['id'], unique=False)
    op.create_table('indices_saude_caixa',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('saldo_atual', sa.Float(), nullable=False),
    sa.Column('despesa_media_diaria', sa.Float(), nullable=False),
    sa.Column('dias_de_caixa', sa.Float(), nullable=False),
    sa.Column('dias_para_receber', sa.Float(), nullable=True),
    sa.Column('dias_para_pagar', sa.Float(), nullable=True),
    sa.Column('ciclo_operacional', sa.Float(), nullable=True),
    sa.Column('receita_mensal_estimada', sa.Float(), nullable=True),
    sa.Column('despesa_mensal_estimada', sa.Float(), nullable=True),
    sa.Column('saldo_mensal_estimado', sa.Float(), nullable=True),
    sa.Column('status', sa.String(), nullable=True),
    sa.Column('tendencia', sa.String(), nullable=True),
    sa.Column('percentual_variacao_7d', sa.Float(), nullable=True),
    sa.Column('score_saude', sa.Float(), nullable=True),
    sa.Column('calculado_em', sa.DateTime(), nullable=True),
    sa.Column('proxima_atualizacao', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('listas_preco',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('marcas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('logo', sa.String(length=255), nullable=True),
    sa.Column('site', sa.String(length=255), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('mensagens_chat',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('conversa_id', sa.Integer(), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('conteudo', sa.Text(), nullable=False),
    sa.Column('tokens_usados', sa.Integer(), nullable=True),
    sa.Column('modelo_usado', sa.String(length=50), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=False),
    sa.Column('contexto_usado', sa.JSON(), nullable=True),
    sa.ForeignKeyConstraint(['conversa_id'], ['conversas_ia.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_mensagens_chat_conversa_id'), 'mensagens_chat', ['conversa_id'], unique=False)
    op.create_index(op.f('ix_mensagens_chat_id'), 'mensagens_chat', ['id'], unique=False)
    op.create_table('notas_entrada',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('numero_nota', sa.String(length=20), nullable=False),
    sa.Column('serie', sa.String(length=5), nullable=False),
    sa.Column('chave_acesso', sa.String(length=44), nullable=False),
    sa.Column('fornecedor_cnpj', sa.String(length=18), nullable=False),
    sa.Column('fornecedor_nome', sa.String(length=255), nullable=False),
    sa.Column('fornecedor_id', sa.Integer(), nullable=True),
    sa.Column('data_emissao', sa.DateTime(), nullable=False),
    sa.Column('data_entrada', sa.DateTime(), nullable=False),
    sa.Column('valor_produtos', sa.Float(), nullable=False),
    sa.Column('valor_frete', sa.Float(), nullable=True),
    sa.Column('valor_desconto', sa.Float(), nullable=True),
    sa.Column('valor_total', sa.Float(), nullable=False),
    sa.Column('xml_content', sa.Text(), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('erro_mensagem', sa.Text(), nullable=True),
    sa.Column('processada_em', sa.DateTime(), nullable=True),
    sa.Column('produtos_vinculados', sa.Integer(), nullable=True),
    sa.Column('produtos_nao_vinculados', sa.Integer(), nullable=True),
    sa.Column('entrada_estoque_realizada', sa.Boolean(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_notas_entrada_chave_acesso'), 'notas_entrada', ['chave_acesso'], unique=True)
    op.create_index(op.f('ix_notas_entrada_fornecedor_id'), 'notas_entrada', ['fornecedor_id'], unique=False)
    op.create_index(op.f('ix_notas_entrada_id'), 'notas_entrada', ['id'], unique=False)
    op.create_index(op.f('ix_notas_entrada_numero_nota'), 'notas_entrada', ['numero_nota'], unique=False)
    op.create_index(op.f('ix_notas_entrada_status'), 'notas_entrada', ['status'], unique=False)
    op.create_index(op.f('ix_notas_entrada_user_id'), 'notas_entrada', ['user_id'], unique=False)
    op.create_table('pedidos_compra',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('numero_pedido', sa.String(length=50), nullable=False),
    sa.Column('fornecedor_id', sa.Integer(), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('valor_total', sa.Float(), nullable=False),
    sa.Column('valor_frete', sa.Float(), nullable=True),
    sa.Column('valor_desconto', sa.Float(), nullable=True),
    sa.Column('valor_final', sa.Float(), nullable=False),
    sa.Column('data_pedido', sa.DateTime(), nullable=False),
    sa.Column('data_prevista_entrega', sa.DateTime(), nullable=True),
    sa.Column('data_recebimento', sa.DateTime(), nullable=True),
    sa.Column('data_envio', sa.DateTime(), nullable=True),
    sa.Column('data_confirmacao', sa.DateTime(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('foi_alterado_apos_envio', sa.Boolean(), nullable=True),
    sa.Column('sugestao_ia', sa.Boolean(), nullable=True),
    sa.Column('confianca_ia', sa.Float(), nullable=True),
    sa.Column('dados_ia', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_pedidos_compra_fornecedor_id'), 'pedidos_compra', ['fornecedor_id'], unique=False)
    op.create_index(op.f('ix_pedidos_compra_id'), 'pedidos_compra', ['id'], unique=False)
    op.create_index(op.f('ix_pedidos_compra_numero_pedido'), 'pedidos_compra', ['numero_pedido'], unique=True)
    op.create_index(op.f('ix_pedidos_compra_status'), 'pedidos_compra', ['status'], unique=False)
    op.create_index(op.f('ix_pedidos_compra_user_id'), 'pedidos_compra', ['user_id'], unique=False)
    op.create_table('projecao_fluxo_caixa',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('data_projetada', sa.DateTime(), nullable=False),
    sa.Column('dias_futuros', sa.Integer(), nullable=True),
    sa.Column('valor_entrada_estimada', sa.Float(), nullable=True),
    sa.Column('valor_saida_estimada', sa.Float(), nullable=True),
    sa.Column('saldo_estimado', sa.Float(), nullable=True),
    sa.Column('limite_inferior', sa.Float(), nullable=True),
    sa.Column('limite_superior', sa.Float(), nullable=True),
    sa.Column('vai_faltar_caixa', sa.Boolean(), nullable=True),
    sa.Column('alerta_nivel', sa.String(), nullable=True),
    sa.Column('mensagem_alerta', sa.String(length=500), nullable=True),
    sa.Column('gerado_em', sa.DateTime(), nullable=True),
    sa.Column('versao_modelo', sa.String(), nullable=True),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('user_sessions',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('token_jti', sa.String(length=36), nullable=False),
    sa.Column('ip_address', sa.String(length=50), nullable=True),
    sa.Column('user_agent', sa.Text(), nullable=True),
    sa.Column('device_info', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('last_activity_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('expires_at', sa.DateTime(timezone=True), nullable=False),
    sa.Column('revoked', sa.Boolean(), nullable=True),
    sa.Column('revoked_at', sa.DateTime(timezone=True), nullable=True),
    sa.Column('revoke_reason', sa.String(length=255), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_user_sessions_id'), 'user_sessions', ['id'], unique=False)
    op.create_index(op.f('ix_user_sessions_token_jti'), 'user_sessions', ['token_jti'], unique=True)
    op.create_index(op.f('ix_user_sessions_user_id'), 'user_sessions', ['user_id'], unique=False)
    op.create_table('acertos_parceiro',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('parceiro_id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('data_acerto', sa.DateTime(timezone=True), nullable=False),
    sa.Column('periodo_inicio', sa.DateTime(timezone=True), nullable=False),
    sa.Column('periodo_fim', sa.DateTime(timezone=True), nullable=False),
    sa.Column('tipo_acerto', sa.String(length=20), nullable=False),
    sa.Column('comissoes_fechadas', sa.Integer(), nullable=False),
    sa.Column('valor_bruto', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('valor_compensado', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('valor_liquido', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('email_enviado', sa.Boolean(), nullable=False),
    sa.Column('email_destinatarios', sa.Text(), nullable=True),
    sa.Column('email_erro', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['parceiro_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_acertos_parceiro_data_acerto'), 'acertos_parceiro', ['data_acerto'], unique=False)
    op.create_index(op.f('ix_acertos_parceiro_id'), 'acertos_parceiro', ['id'], unique=False)
    op.create_index(op.f('ix_acertos_parceiro_parceiro_id'), 'acertos_parceiro', ['parceiro_id'], unique=False)
    op.create_index(op.f('ix_acertos_parceiro_status'), 'acertos_parceiro', ['status'], unique=False)
    op.create_index(op.f('ix_acertos_parceiro_user_id'), 'acertos_parceiro', ['user_id'], unique=False)
    op.create_table('contas_pagar',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('descricao', sa.String(length=255), nullable=False),
    sa.Column('fornecedor_id', sa.Integer(), nullable=True),
    sa.Column('categoria_id', sa.Integer(), nullable=True),
    sa.Column('valor_original', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('valor_pago', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_desconto', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_juros', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_multa', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_final', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('data_emissao', sa.Date(), nullable=False),
    sa.Column('data_vencimento', sa.Date(), nullable=False),
    sa.Column('data_pagamento', sa.Date(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('eh_parcelado', sa.Boolean(), nullable=True),
    sa.Column('numero_parcela', sa.Integer(), nullable=True),
    sa.Column('total_parcelas', sa.Integer(), nullable=True),
    sa.Column('conta_principal_id', sa.Integer(), nullable=True),
    sa.Column('eh_recorrente', sa.Boolean(), nullable=True),
    sa.Column('tipo_recorrencia', sa.String(length=20), nullable=True),
    sa.Column('proxima_recorrencia', sa.Date(), nullable=True),
    sa.Column('nota_entrada_id', sa.Integer(), nullable=True),
    sa.Column('nfe_numero', sa.String(length=50), nullable=True),
    sa.Column('documento', sa.String(length=100), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['conta_principal_id'], ['contas_pagar.id'], ),
    sa.ForeignKeyConstraint(['fornecedor_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['nota_entrada_id'], ['notas_entrada.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_contas_pagar_data_vencimento'), 'contas_pagar', ['data_vencimento'], unique=False)
    op.create_index(op.f('ix_contas_pagar_id'), 'contas_pagar', ['id'], unique=False)
    op.create_index(op.f('ix_contas_pagar_nota_entrada_id'), 'contas_pagar', ['nota_entrada_id'], unique=False)
    op.create_index(op.f('ix_contas_pagar_status'), 'contas_pagar', ['status'], unique=False)
    op.create_table('formas_pagamento',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('taxa_percentual', sa.Numeric(precision=5, scale=2), nullable=True),
    sa.Column('taxa_fixa', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('prazo_dias', sa.Integer(), nullable=True),
    sa.Column('prazo_recebimento', sa.Integer(), nullable=True),
    sa.Column('operadora', sa.String(length=50), nullable=True),
    sa.Column('gera_contas_receber', sa.Boolean(), nullable=True),
    sa.Column('split_parcelas', sa.Boolean(), nullable=True),
    sa.Column('conta_bancaria_destino_id', sa.Integer(), nullable=True),
    sa.Column('requer_nsu', sa.Boolean(), nullable=True),
    sa.Column('tipo_cartao', sa.String(length=20), nullable=True),
    sa.Column('bandeira', sa.String(length=20), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('permite_parcelamento', sa.Boolean(), nullable=True),
    sa.Column('max_parcelas', sa.Integer(), nullable=True),
    sa.Column('parcelas_maximas', sa.Integer(), nullable=True),
    sa.Column('taxas_por_parcela', sa.Text(), nullable=True),
    sa.Column('permite_antecipacao', sa.Boolean(), nullable=True),
    sa.Column('dias_recebimento_antecipado', sa.Integer(), nullable=True),
    sa.Column('taxa_antecipacao_percentual', sa.Numeric(precision=5, scale=2), nullable=True),
    sa.Column('icone', sa.String(length=50), nullable=True),
    sa.Column('cor', sa.String(length=7), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['conta_bancaria_destino_id'], ['contas_bancarias.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_formas_pagamento_id'), 'formas_pagamento', ['id'], unique=False)
    op.create_table('lancamentos_recorrentes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('valor_medio', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('descricao', sa.String(length=255), nullable=False),
    sa.Column('frequencia', sa.String(length=20), nullable=False),
    sa.Column('dia_vencimento', sa.Integer(), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('data_inicio', sa.Date(), nullable=False),
    sa.Column('data_fim', sa.Date(), nullable=True),
    sa.Column('categoria_id', sa.Integer(), nullable=False),
    sa.Column('conta_bancaria_id', sa.Integer(), nullable=True),
    sa.Column('fornecedor_cliente', sa.String(length=255), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('ultimo_mes_gerado', sa.String(length=7), nullable=True),
    sa.Column('gerar_com_antecedencia_dias', sa.Integer(), nullable=True),
    sa.Column('permite_ajuste_ia', sa.Boolean(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['conta_bancaria_id'], ['contas_bancarias.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_lancamentos_recorrentes_ativo'), 'lancamentos_recorrentes', ['ativo'], unique=False)
    op.create_index(op.f('ix_lancamentos_recorrentes_id'), 'lancamentos_recorrentes', ['id'], unique=False)
    op.create_index(op.f('ix_lancamentos_recorrentes_tipo'), 'lancamentos_recorrentes', ['tipo'], unique=False)
    op.create_table('padroes_categorizacao_ia',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('tipo_transacao', sa.String(length=50), nullable=True),
    sa.Column('beneficiario_pattern', sa.String(length=500), nullable=True),
    sa.Column('cnpj_cpf', sa.String(length=20), nullable=True),
    sa.Column('valor_minimo', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_maximo', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_medio', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('tolerancia_percentual', sa.Float(), nullable=True),
    sa.Column('frequencia', sa.String(length=50), nullable=True),
    sa.Column('dia_mes_tipico', sa.Integer(), nullable=True),
    sa.Column('categoria_financeira_id', sa.Integer(), nullable=True),
    sa.Column('categoria_nome', sa.String(length=100), nullable=True),
    sa.Column('tipo_lancamento', sa.String(length=20), nullable=True),
    sa.Column('total_aplicacoes', sa.Integer(), nullable=True),
    sa.Column('total_acertos', sa.Integer(), nullable=True),
    sa.Column('total_erros', sa.Integer(), nullable=True),
    sa.Column('total_editos', sa.Integer(), nullable=True),
    sa.Column('confianca_atual', sa.Float(), nullable=True),
    sa.Column('primeira_confirmacao', sa.DateTime(), nullable=True),
    sa.Column('ultima_confirmacao', sa.DateTime(), nullable=True),
    sa.Column('ultima_atualizacao', sa.DateTime(), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('criado_manualmente', sa.Boolean(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_financeira_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_padroes_categorizacao_ia_id'), 'padroes_categorizacao_ia', ['id'], unique=False)
    op.create_table('pets',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('cliente_id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('codigo', sa.String(length=50), nullable=False),
    sa.Column('nome', sa.String(length=255), nullable=False),
    sa.Column('especie', sa.String(length=50), nullable=False),
    sa.Column('raca', sa.String(length=100), nullable=True),
    sa.Column('sexo', sa.String(length=10), nullable=True),
    sa.Column('castrado', sa.Boolean(), nullable=True),
    sa.Column('data_nascimento', sa.DateTime(), nullable=True),
    sa.Column('idade_aproximada', sa.Integer(), nullable=True),
    sa.Column('peso', sa.Float(), nullable=True),
    sa.Column('cor', sa.String(length=100), nullable=True),
    sa.Column('cor_pelagem', sa.String(length=100), nullable=True),
    sa.Column('porte', sa.String(length=20), nullable=True),
    sa.Column('microchip', sa.String(length=50), nullable=True),
    sa.Column('alergias', sa.Text(), nullable=True),
    sa.Column('doencas_cronicas', sa.Text(), nullable=True),
    sa.Column('medicamentos_continuos', sa.Text(), nullable=True),
    sa.Column('historico_clinico', sa.Text(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('foto_url', sa.String(length=500), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.ForeignKeyConstraint(['cliente_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_pets_cliente_id'), 'pets', ['cliente_id'], unique=False)
    op.create_index(op.f('ix_pets_codigo'), 'pets', ['codigo'], unique=True)
    op.create_index(op.f('ix_pets_id'), 'pets', ['id'], unique=False)
    op.create_index(op.f('ix_pets_nome'), 'pets', ['nome'], unique=False)
    op.create_index(op.f('ix_pets_user_id'), 'pets', ['user_id'], unique=False)
    op.create_table('produtos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('codigo', sa.String(length=50), nullable=False),
    sa.Column('nome', sa.String(length=200), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=True),
    sa.Column('situacao', sa.Boolean(), nullable=True),
    sa.Column('tipo_produto', sa.String(length=20), nullable=False),
    sa.Column('produto_pai_id', sa.Integer(), nullable=True),
    sa.Column('tipo_kit', sa.String(length=20), nullable=True),
    sa.Column('descricao_curta', sa.Text(), nullable=True),
    sa.Column('descricao_completa', sa.Text(), nullable=True),
    sa.Column('tags', sa.Text(), nullable=True),
    sa.Column('codigo_barras', sa.String(length=13), nullable=True),
    sa.Column('codigos_barras_alternativos', sa.Text(), nullable=True),
    sa.Column('categoria_id', sa.Integer(), nullable=True),
    sa.Column('subcategoria', sa.String(length=100), nullable=True),
    sa.Column('marca_id', sa.Integer(), nullable=True),
    sa.Column('fornecedor_id', sa.Integer(), nullable=True),
    sa.Column('departamento_id', sa.Integer(), nullable=True),
    sa.Column('preco_custo', sa.Float(), nullable=True),
    sa.Column('preco_venda', sa.Float(), nullable=True),
    sa.Column('preco_promocional', sa.Float(), nullable=True),
    sa.Column('promocao_inicio', sa.DateTime(), nullable=True),
    sa.Column('promocao_fim', sa.DateTime(), nullable=True),
    sa.Column('promocao_ativa', sa.Boolean(), nullable=True),
    sa.Column('estoque_atual', sa.Float(), nullable=True),
    sa.Column('estoque_minimo', sa.Float(), nullable=True),
    sa.Column('estoque_maximo', sa.Float(), nullable=True),
    sa.Column('estoque_fisico', sa.Float(), nullable=True),
    sa.Column('estoque_ecommerce', sa.Float(), nullable=True),
    sa.Column('localizacao', sa.String(length=50), nullable=True),
    sa.Column('crossdocking_dias', sa.Integer(), nullable=True),
    sa.Column('controle_lote', sa.Boolean(), nullable=True),
    sa.Column('unidade', sa.String(length=10), nullable=True),
    sa.Column('condicao', sa.String(length=20), nullable=True),
    sa.Column('peso_liquido', sa.Float(), nullable=True),
    sa.Column('peso_bruto', sa.Float(), nullable=True),
    sa.Column('largura', sa.Float(), nullable=True),
    sa.Column('altura', sa.Float(), nullable=True),
    sa.Column('profundidade', sa.Float(), nullable=True),
    sa.Column('volume', sa.Float(), nullable=True),
    sa.Column('itens_por_caixa', sa.Integer(), nullable=True),
    sa.Column('frete_gratis', sa.Boolean(), nullable=True),
    sa.Column('producao', sa.String(length=20), nullable=True),
    sa.Column('ncm', sa.String(length=8), nullable=True),
    sa.Column('cest', sa.String(length=7), nullable=True),
    sa.Column('gtin_ean', sa.String(length=13), nullable=True),
    sa.Column('gtin_ean_tributario', sa.String(length=13), nullable=True),
    sa.Column('origem', sa.String(length=1), nullable=True),
    sa.Column('perfil_tributario', sa.String(length=50), nullable=True),
    sa.Column('forma_aquisicao', sa.String(length=50), nullable=True),
    sa.Column('tipo_item', sa.String(length=50), nullable=True),
    sa.Column('percentual_tributos', sa.Float(), nullable=True),
    sa.Column('icms_base_retencao', sa.Float(), nullable=True),
    sa.Column('icms_valor_retencao', sa.Float(), nullable=True),
    sa.Column('icms_valor_proprio', sa.Float(), nullable=True),
    sa.Column('ipi_codigo_excecao', sa.String(length=20), nullable=True),
    sa.Column('pis_valor_fixo', sa.Float(), nullable=True),
    sa.Column('cofins_valor_fixo', sa.Float(), nullable=True),
    sa.Column('cfop', sa.String(length=10), nullable=True),
    sa.Column('aliquota_icms', sa.Float(), nullable=True),
    sa.Column('aliquota_pis', sa.Float(), nullable=True),
    sa.Column('aliquota_cofins', sa.Float(), nullable=True),
    sa.Column('informacoes_adicionais_nf', sa.Text(), nullable=True),
    sa.Column('comissao_padrao', sa.Float(), nullable=True),
    sa.Column('limite_desconto', sa.Float(), nullable=True),
    sa.Column('data_validade', sa.DateTime(), nullable=True),
    sa.Column('tem_recorrencia', sa.Boolean(), nullable=True),
    sa.Column('tipo_recorrencia', sa.String(length=20), nullable=True),
    sa.Column('intervalo_dias', sa.Integer(), nullable=True),
    sa.Column('numero_doses', sa.Integer(), nullable=True),
    sa.Column('observacoes_recorrencia', sa.Text(), nullable=True),
    sa.Column('especie_compativel', sa.String(length=50), nullable=True),
    sa.Column('classificacao_racao', sa.String(length=50), nullable=True),
    sa.Column('peso_embalagem', sa.Float(), nullable=True),
    sa.Column('tabela_nutricional', sa.Text(), nullable=True),
    sa.Column('categoria_racao', sa.String(length=50), nullable=True),
    sa.Column('especies_indicadas', sa.String(length=100), nullable=True),
    sa.Column('tabela_consumo', sa.Text(), nullable=True),
    sa.Column('imagem_principal', sa.String(length=255), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.Column('deleted_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_id'], ['categorias.id'], ),
    sa.ForeignKeyConstraint(['departamento_id'], ['departamentos.id'], ),
    sa.ForeignKeyConstraint(['fornecedor_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['marca_id'], ['marcas.id'], ),
    sa.ForeignKeyConstraint(['produto_pai_id'], ['produtos.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('codigo')
    )
    op.create_index('idx_produtos_categoria', 'produtos', ['categoria_id'], unique=False)
    op.create_index('idx_produtos_marca', 'produtos', ['marca_id'], unique=False)
    op.create_index('idx_produtos_user', 'produtos', ['user_id'], unique=False)
    op.create_table('vendas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('numero_venda', sa.String(length=20), nullable=False),
    sa.Column('cliente_id', sa.Integer(), nullable=True),
    sa.Column('vendedor_id', sa.Integer(), nullable=False),
    sa.Column('funcionario_id', sa.Integer(), nullable=True),
    sa.Column('subtotal', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('desconto_valor', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('desconto_percentual', sa.DECIMAL(precision=5, scale=2), nullable=True),
    sa.Column('total', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('tem_entrega', sa.Boolean(), nullable=True),
    sa.Column('taxa_entrega', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('entregador_id', sa.Integer(), nullable=True),
    sa.Column('loja_origem', sa.String(length=100), nullable=True),
    sa.Column('endereco_entrega', sa.Text(), nullable=True),
    sa.Column('distancia_km', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('valor_por_km', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('observacoes_entrega', sa.Text(), nullable=True),
    sa.Column('status_entrega', sa.String(length=20), nullable=True),
    sa.Column('data_entrega', sa.DateTime(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('caixa_id', sa.Integer(), nullable=True),
    sa.Column('canal', sa.String(length=50), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('data_venda', sa.DateTime(), nullable=False),
    sa.Column('data_finalizacao', sa.DateTime(), nullable=True),
    sa.Column('cancelada_por', sa.Integer(), nullable=True),
    sa.Column('motivo_cancelamento', sa.Text(), nullable=True),
    sa.Column('data_cancelamento', sa.DateTime(), nullable=True),
    sa.Column('nfe_tipo', sa.String(length=10), nullable=True),
    sa.Column('nfe_modelo', sa.String(length=5), nullable=True),
    sa.Column('nfe_numero', sa.Integer(), nullable=True),
    sa.Column('nfe_serie', sa.Integer(), nullable=True),
    sa.Column('nfe_chave', sa.String(length=44), nullable=True),
    sa.Column('nfe_status', sa.String(length=20), nullable=True),
    sa.Column('nfe_xml', sa.Text(), nullable=True),
    sa.Column('nfe_data_emissao', sa.DateTime(), nullable=True),
    sa.Column('nfe_data_autorizacao', sa.DateTime(), nullable=True),
    sa.Column('nfe_motivo_rejeicao', sa.Text(), nullable=True),
    sa.Column('nfe_bling_id', sa.Integer(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['caixa_id'], ['caixas.id'], ),
    sa.ForeignKeyConstraint(['cancelada_por'], ['users.id'], ),
    sa.ForeignKeyConstraint(['cliente_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['entregador_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['funcionario_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['vendedor_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_vendas_caixa_id'), 'vendas', ['caixa_id'], unique=False)
    op.create_index(op.f('ix_vendas_canal'), 'vendas', ['canal'], unique=False)
    op.create_index(op.f('ix_vendas_id'), 'vendas', ['id'], unique=False)
    op.create_index(op.f('ix_vendas_nfe_chave'), 'vendas', ['nfe_chave'], unique=False)
    op.create_index(op.f('ix_vendas_nfe_numero'), 'vendas', ['nfe_numero'], unique=False)
    op.create_index(op.f('ix_vendas_numero_venda'), 'vendas', ['numero_venda'], unique=True)
    op.create_table('contas_receber',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('descricao', sa.String(length=255), nullable=False),
    sa.Column('cliente_id', sa.Integer(), nullable=True),
    sa.Column('categoria_id', sa.Integer(), nullable=True),
    sa.Column('forma_pagamento_id', sa.Integer(), nullable=True),
    sa.Column('valor_original', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('valor_recebido', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_desconto', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_juros', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_multa', sa.Numeric(precision=10, scale=2), nullable=True),
    sa.Column('valor_final', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('data_emissao', sa.Date(), nullable=False),
    sa.Column('data_vencimento', sa.Date(), nullable=False),
    sa.Column('data_recebimento', sa.Date(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('eh_parcelado', sa.Boolean(), nullable=True),
    sa.Column('numero_parcela', sa.Integer(), nullable=True),
    sa.Column('total_parcelas', sa.Integer(), nullable=True),
    sa.Column('conta_principal_id', sa.Integer(), nullable=True),
    sa.Column('venda_id', sa.Integer(), nullable=True),
    sa.Column('nfe_numero', sa.String(length=50), nullable=True),
    sa.Column('documento', sa.String(length=100), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['cliente_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['conta_principal_id'], ['contas_receber.id'], ),
    sa.ForeignKeyConstraint(['forma_pagamento_id'], ['formas_pagamento.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['venda_id'], ['vendas.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_contas_receber_data_vencimento'), 'contas_receber', ['data_vencimento'], unique=False)
    op.create_index(op.f('ix_contas_receber_id'), 'contas_receber', ['id'], unique=False)
    op.create_index(op.f('ix_contas_receber_status'), 'contas_receber', ['status'], unique=False)
    op.create_index(op.f('ix_contas_receber_venda_id'), 'contas_receber', ['venda_id'], unique=False)
    op.create_table('email_envios',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('parceiro_id', sa.Integer(), nullable=False),
    sa.Column('acerto_id', sa.Integer(), nullable=True),
    sa.Column('template_id', sa.Integer(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('destinatarios', sa.Text(), nullable=False),
    sa.Column('assunto', sa.Text(), nullable=False),
    sa.Column('corpo_html', sa.Text(), nullable=False),
    sa.Column('corpo_texto', sa.Text(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('tentativas', sa.Integer(), nullable=False),
    sa.Column('max_tentativas', sa.Integer(), nullable=False),
    sa.Column('data_enfileiramento', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('data_envio', sa.DateTime(timezone=True), nullable=True),
    sa.Column('proxima_tentativa', sa.DateTime(timezone=True), nullable=True),
    sa.Column('ultimo_erro', sa.Text(), nullable=True),
    sa.Column('historico_erros', sa.Text(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=True),
    sa.Column('updated_at', sa.DateTime(timezone=True), nullable=True),
    sa.ForeignKeyConstraint(['acerto_id'], ['acertos_parceiro.id'], ),
    sa.ForeignKeyConstraint(['parceiro_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['template_id'], ['emails_templates.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_email_envios_data_envio'), 'email_envios', ['data_envio'], unique=False)
    op.create_index(op.f('ix_email_envios_id'), 'email_envios', ['id'], unique=False)
    op.create_index(op.f('ix_email_envios_parceiro_id'), 'email_envios', ['parceiro_id'], unique=False)
    op.create_index(op.f('ix_email_envios_proxima_tentativa'), 'email_envios', ['proxima_tentativa'], unique=False)
    op.create_index(op.f('ix_email_envios_status'), 'email_envios', ['status'], unique=False)
    op.create_index(op.f('ix_email_envios_user_id'), 'email_envios', ['user_id'], unique=False)
    op.create_table('formas_pagamento_taxas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('forma_pagamento_id', sa.Integer(), nullable=False),
    sa.Column('parcelas', sa.Integer(), nullable=False),
    sa.Column('taxa_percentual', sa.Numeric(precision=5, scale=2), nullable=False),
    sa.Column('descricao', sa.String(length=100), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['forma_pagamento_id'], ['formas_pagamento.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_formas_pagamento_taxas_id'), 'formas_pagamento_taxas', ['id'], unique=False)
    op.create_table('lancamentos_manuais',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('valor', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('descricao', sa.String(length=255), nullable=False),
    sa.Column('data_lancamento', sa.Date(), nullable=False),
    sa.Column('data_competencia', sa.Date(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('realizado_em', sa.DateTime(), nullable=True),
    sa.Column('categoria_id', sa.Integer(), nullable=True),
    sa.Column('conta_bancaria_id', sa.Integer(), nullable=True),
    sa.Column('documento', sa.String(length=100), nullable=True),
    sa.Column('fornecedor_cliente', sa.String(length=255), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('lancamento_recorrente_id', sa.Integer(), nullable=True),
    sa.Column('gerado_automaticamente', sa.Boolean(), nullable=True),
    sa.Column('confianca_ia', sa.Numeric(precision=5, scale=2), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['conta_bancaria_id'], ['contas_bancarias.id'], ),
    sa.ForeignKeyConstraint(['lancamento_recorrente_id'], ['lancamentos_recorrentes.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_lancamentos_manuais_data_lancamento'), 'lancamentos_manuais', ['data_lancamento'], unique=False)
    op.create_index(op.f('ix_lancamentos_manuais_id'), 'lancamentos_manuais', ['id'], unique=False)
    op.create_index(op.f('ix_lancamentos_manuais_status'), 'lancamentos_manuais', ['status'], unique=False)
    op.create_index(op.f('ix_lancamentos_manuais_tipo'), 'lancamentos_manuais', ['tipo'], unique=False)
    op.create_table('lembretes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('cliente_id', sa.Integer(), nullable=False),
    sa.Column('pet_id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('venda_id', sa.Integer(), nullable=True),
    sa.Column('data_compra', sa.DateTime(), nullable=True),
    sa.Column('data_proxima_dose', sa.DateTime(), nullable=False),
    sa.Column('data_notificacao_7_dias', sa.DateTime(), nullable=True),
    sa.Column('data_notificacao_enviada', sa.DateTime(), nullable=True),
    sa.Column('data_completado', sa.DateTime(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('metodo_notificacao', sa.String(length=50), nullable=True),
    sa.Column('notificacao_enviada', sa.Boolean(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('quantidade_recomendada', sa.Float(), nullable=True),
    sa.Column('preco_estimado', sa.Float(), nullable=True),
    sa.Column('dose_atual', sa.Integer(), nullable=True),
    sa.Column('dose_total', sa.Integer(), nullable=True),
    sa.Column('historico_doses', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['cliente_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['pet_id'], ['pets.id'], ),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['venda_id'], ['vendas.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_lembretes_cliente_id'), 'lembretes', ['cliente_id'], unique=False)
    op.create_index(op.f('ix_lembretes_data_proxima_dose'), 'lembretes', ['data_proxima_dose'], unique=False)
    op.create_index(op.f('ix_lembretes_pet_id'), 'lembretes', ['pet_id'], unique=False)
    op.create_index(op.f('ix_lembretes_produto_id'), 'lembretes', ['produto_id'], unique=False)
    op.create_index(op.f('ix_lembretes_user_id'), 'lembretes', ['user_id'], unique=False)
    op.create_index(op.f('ix_lembretes_venda_id'), 'lembretes', ['venda_id'], unique=False)
    op.create_table('movimentacoes_caixa',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('caixa_id', sa.Integer(), nullable=False),
    sa.Column('tipo', sa.String(length=50), nullable=False),
    sa.Column('valor', sa.Float(), nullable=False),
    sa.Column('forma_pagamento', sa.String(length=50), nullable=True),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('categoria', sa.String(length=100), nullable=True),
    sa.Column('conta_origem_id', sa.Integer(), nullable=True),
    sa.Column('conta_origem_nome', sa.String(length=200), nullable=True),
    sa.Column('conta_destino_id', sa.Integer(), nullable=True),
    sa.Column('conta_destino_nome', sa.String(length=200), nullable=True),
    sa.Column('fornecedor_id', sa.Integer(), nullable=True),
    sa.Column('fornecedor_nome', sa.String(length=200), nullable=True),
    sa.Column('documento', sa.String(length=100), nullable=True),
    sa.Column('venda_id', sa.Integer(), nullable=True),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('usuario_nome', sa.String(length=200), nullable=False),
    sa.Column('data_movimento', sa.DateTime(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['caixa_id'], ['caixas.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['venda_id'], ['vendas.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_movimentacoes_caixa_id'), 'movimentacoes_caixa', ['id'], unique=False)
    op.create_table('movimentacoes_financeiras',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('data_movimento', sa.DateTime(), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('valor', sa.Numeric(precision=15, scale=2), nullable=False),
    sa.Column('conta_bancaria_id', sa.Integer(), nullable=False),
    sa.Column('categoria_id', sa.Integer(), nullable=True),
    sa.Column('forma_pagamento_id', sa.Integer(), nullable=True),
    sa.Column('origem_tipo', sa.String(length=30), nullable=True),
    sa.Column('origem_id', sa.Integer(), nullable=True),
    sa.Column('origem_venda', sa.String(length=20), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('documento', sa.String(length=100), nullable=True),
    sa.Column('descricao', sa.Text(), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['conta_bancaria_id'], ['contas_bancarias.id'], ),
    sa.ForeignKeyConstraint(['forma_pagamento_id'], ['formas_pagamento.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_movimentacoes_financeiras_conta_bancaria_id'), 'movimentacoes_financeiras', ['conta_bancaria_id'], unique=False)
    op.create_index(op.f('ix_movimentacoes_financeiras_data_movimento'), 'movimentacoes_financeiras', ['data_movimento'], unique=False)
    op.create_index(op.f('ix_movimentacoes_financeiras_id'), 'movimentacoes_financeiras', ['id'], unique=False)
    op.create_index(op.f('ix_movimentacoes_financeiras_status'), 'movimentacoes_financeiras', ['status'], unique=False)
    op.create_index(op.f('ix_movimentacoes_financeiras_tipo'), 'movimentacoes_financeiras', ['tipo'], unique=False)
    op.create_index(op.f('ix_movimentacoes_financeiras_user_id'), 'movimentacoes_financeiras', ['user_id'], unique=False)
    op.create_table('notas_entrada_itens',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('nota_entrada_id', sa.Integer(), nullable=False),
    sa.Column('numero_item', sa.Integer(), nullable=False),
    sa.Column('codigo_produto', sa.String(length=100), nullable=True),
    sa.Column('descricao', sa.String(length=500), nullable=False),
    sa.Column('ncm', sa.String(length=8), nullable=True),
    sa.Column('cest', sa.String(length=7), nullable=True),
    sa.Column('cfop', sa.String(length=4), nullable=True),
    sa.Column('origem', sa.String(length=1), nullable=True),
    sa.Column('aliquota_icms', sa.Float(), nullable=True),
    sa.Column('aliquota_pis', sa.Float(), nullable=True),
    sa.Column('aliquota_cofins', sa.Float(), nullable=True),
    sa.Column('unidade', sa.String(length=10), nullable=True),
    sa.Column('quantidade', sa.Float(), nullable=False),
    sa.Column('valor_unitario', sa.Float(), nullable=False),
    sa.Column('valor_total', sa.Float(), nullable=False),
    sa.Column('ean', sa.String(length=14), nullable=True),
    sa.Column('lote', sa.String(length=50), nullable=True),
    sa.Column('data_validade', sa.Date(), nullable=True),
    sa.Column('produto_id', sa.Integer(), nullable=True),
    sa.Column('vinculado', sa.Boolean(), nullable=True),
    sa.Column('confianca_vinculo', sa.Float(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['nota_entrada_id'], ['notas_entrada.id'], ),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_notas_entrada_itens_id'), 'notas_entrada_itens', ['id'], unique=False)
    op.create_index(op.f('ix_notas_entrada_itens_nota_entrada_id'), 'notas_entrada_itens', ['nota_entrada_id'], unique=False)
    op.create_index(op.f('ix_notas_entrada_itens_produto_id'), 'notas_entrada_itens', ['produto_id'], unique=False)
    op.create_table('pagamentos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('conta_pagar_id', sa.Integer(), nullable=False),
    sa.Column('forma_pagamento_id', sa.Integer(), nullable=True),
    sa.Column('valor_pago', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('data_pagamento', sa.Date(), nullable=False),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('comprovante', sa.String(length=255), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['conta_pagar_id'], ['contas_pagar.id'], ),
    sa.ForeignKeyConstraint(['forma_pagamento_id'], ['formas_pagamento.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_pagamentos_conta_pagar_id'), 'pagamentos', ['conta_pagar_id'], unique=False)
    op.create_index(op.f('ix_pagamentos_data_pagamento'), 'pagamentos', ['data_pagamento'], unique=False)
    op.create_index(op.f('ix_pagamentos_id'), 'pagamentos', ['id'], unique=False)
    op.create_table('pedidos_compra_itens',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('pedido_compra_id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('quantidade_pedida', sa.Float(), nullable=False),
    sa.Column('quantidade_recebida', sa.Float(), nullable=True),
    sa.Column('preco_unitario', sa.Float(), nullable=False),
    sa.Column('desconto_item', sa.Float(), nullable=True),
    sa.Column('valor_total', sa.Float(), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('sugestao_ia', sa.Boolean(), nullable=True),
    sa.Column('motivo_ia', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['pedido_compra_id'], ['pedidos_compra.id'], ),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_pedidos_compra_itens_id'), 'pedidos_compra_itens', ['id'], unique=False)
    op.create_index(op.f('ix_pedidos_compra_itens_pedido_compra_id'), 'pedidos_compra_itens', ['pedido_compra_id'], unique=False)
    op.create_index(op.f('ix_pedidos_compra_itens_produto_id'), 'pedidos_compra_itens', ['produto_id'], unique=False)
    op.create_table('produto_bling_sync',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('bling_produto_id', sa.String(length=50), nullable=True),
    sa.Column('sincronizar', sa.Boolean(), nullable=True),
    sa.Column('estoque_compartilhado', sa.Boolean(), nullable=True),
    sa.Column('ultima_sincronizacao', sa.DateTime(), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('erro_mensagem', sa.Text(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('produto_id')
    )
    op.create_table('produto_fornecedores',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('fornecedor_id', sa.Integer(), nullable=False),
    sa.Column('codigo_fornecedor', sa.String(length=50), nullable=True),
    sa.Column('preco_custo', sa.Float(), nullable=True),
    sa.Column('prazo_entrega', sa.Integer(), nullable=True),
    sa.Column('estoque_fornecedor', sa.Float(), nullable=True),
    sa.Column('e_principal', sa.Boolean(), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['fornecedor_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('produto_imagens',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('url', sa.String(length=255), nullable=False),
    sa.Column('ordem', sa.Integer(), nullable=True),
    sa.Column('e_principal', sa.Boolean(), nullable=True),
    sa.Column('tamanho', sa.Integer(), nullable=True),
    sa.Column('largura', sa.Integer(), nullable=True),
    sa.Column('altura', sa.Integer(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('produto_kit_componentes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('kit_id', sa.Integer(), nullable=False),
    sa.Column('produto_componente_id', sa.Integer(), nullable=False),
    sa.Column('quantidade', sa.Float(), nullable=False),
    sa.Column('opcional', sa.Boolean(), nullable=True),
    sa.Column('ordem', sa.Integer(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['kit_id'], ['produtos.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['produto_componente_id'], ['produtos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_kit_componentes_kit', 'produto_kit_componentes', ['kit_id'], unique=False)
    op.create_index('idx_kit_componentes_produto', 'produto_kit_componentes', ['produto_componente_id'], unique=False)
    op.create_index('idx_kit_componentes_unique', 'produto_kit_componentes', ['kit_id', 'produto_componente_id'], unique=True)
    op.create_table('produto_listas_preco',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('lista_preco_id', sa.Integer(), nullable=False),
    sa.Column('preco', sa.Float(), nullable=False),
    sa.Column('desconto_percentual', sa.Float(), nullable=True),
    sa.Column('desconto_valor', sa.Float(), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.ForeignKeyConstraint(['lista_preco_id'], ['listas_preco.id'], ondelete='CASCADE'),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('produto_lotes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('nome_lote', sa.String(length=50), nullable=False),
    sa.Column('data_fabricacao', sa.DateTime(), nullable=True),
    sa.Column('data_validade', sa.DateTime(), nullable=False),
    sa.Column('deposito', sa.String(length=50), nullable=True),
    sa.Column('quantidade_inicial', sa.Float(), nullable=False),
    sa.Column('quantidade_disponivel', sa.Float(), nullable=False),
    sa.Column('quantidade_reservada', sa.Float(), nullable=True),
    sa.Column('limite_dias', sa.Integer(), nullable=True),
    sa.Column('codigo_agregacao', sa.String(length=50), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('ordem_entrada', sa.Integer(), nullable=False),
    sa.Column('custo_unitario', sa.Float(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('produtos_atributos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_pai_id', sa.Integer(), nullable=False),
    sa.Column('nome', sa.String(length=100), nullable=False),
    sa.Column('ordem', sa.Integer(), nullable=True),
    sa.Column('obrigatorio', sa.Boolean(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['produto_pai_id'], ['produtos.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_atributos_produto_pai', 'produtos_atributos', ['produto_pai_id'], unique=False)
    op.create_index('idx_atributos_user', 'produtos_atributos', ['user_id'], unique=False)
    op.create_table('produtos_historico_precos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('preco_custo_anterior', sa.Float(), nullable=True),
    sa.Column('preco_custo_novo', sa.Float(), nullable=True),
    sa.Column('preco_venda_anterior', sa.Float(), nullable=True),
    sa.Column('preco_venda_novo', sa.Float(), nullable=True),
    sa.Column('margem_anterior', sa.Float(), nullable=True),
    sa.Column('margem_nova', sa.Float(), nullable=True),
    sa.Column('variacao_custo_percentual', sa.Float(), nullable=True),
    sa.Column('variacao_venda_percentual', sa.Float(), nullable=True),
    sa.Column('motivo', sa.String(length=100), nullable=True),
    sa.Column('nota_entrada_id', sa.Integer(), nullable=True),
    sa.Column('referencia', sa.String(length=100), nullable=True),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['nota_entrada_id'], ['notas_entrada.id'], ),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_produtos_historico_precos_created_at'), 'produtos_historico_precos', ['created_at'], unique=False)
    op.create_index(op.f('ix_produtos_historico_precos_id'), 'produtos_historico_precos', ['id'], unique=False)
    op.create_index(op.f('ix_produtos_historico_precos_nota_entrada_id'), 'produtos_historico_precos', ['nota_entrada_id'], unique=False)
    op.create_index(op.f('ix_produtos_historico_precos_produto_id'), 'produtos_historico_precos', ['produto_id'], unique=False)
    op.create_table('venda_baixas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('venda_id', sa.Integer(), nullable=False),
    sa.Column('valor_baixa', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('valor_anterior', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('valor_restante', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('forma_pagamento', sa.String(length=50), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('data_baixa', sa.DateTime(), nullable=True),
    sa.Column('editado', sa.Boolean(), nullable=True),
    sa.Column('editado_por', sa.Integer(), nullable=True),
    sa.Column('data_edicao', sa.DateTime(), nullable=True),
    sa.Column('excluido', sa.Boolean(), nullable=True),
    sa.Column('excluido_por', sa.Integer(), nullable=True),
    sa.Column('data_exclusao', sa.DateTime(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['editado_por'], ['users.id'], ),
    sa.ForeignKeyConstraint(['excluido_por'], ['users.id'], ),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.ForeignKeyConstraint(['venda_id'], ['vendas.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_venda_baixas_id'), 'venda_baixas', ['id'], unique=False)
    op.create_table('venda_pagamentos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('venda_id', sa.Integer(), nullable=False),
    sa.Column('forma_pagamento', sa.String(length=50), nullable=False),
    sa.Column('valor', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('bandeira', sa.String(length=30), nullable=True),
    sa.Column('numero_parcelas', sa.Integer(), nullable=True),
    sa.Column('numero_transacao', sa.String(length=100), nullable=True),
    sa.Column('numero_autorizacao', sa.String(length=100), nullable=True),
    sa.Column('valor_recebido', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('troco', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('status', sa.String(length=20), nullable=True),
    sa.Column('data_pagamento', sa.DateTime(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['venda_id'], ['vendas.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_venda_pagamentos_id'), 'venda_pagamentos', ['id'], unique=False)
    op.create_table('whatsapp_messages',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('cliente_id', sa.Integer(), nullable=False),
    sa.Column('pet_id', sa.Integer(), nullable=True),
    sa.Column('telefone', sa.String(length=20), nullable=False),
    sa.Column('direcao', sa.String(length=20), nullable=False),
    sa.Column('conteudo', sa.Text(), nullable=False),
    sa.Column('status', sa.String(length=20), nullable=False),
    sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.ForeignKeyConstraint(['cliente_id'], ['clientes.id'], ),
    sa.ForeignKeyConstraint(['pet_id'], ['pets.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_whatsapp_messages_created_at'), 'whatsapp_messages', ['created_at'], unique=False)
    op.create_index(op.f('ix_whatsapp_messages_id'), 'whatsapp_messages', ['id'], unique=False)
    op.create_index(op.f('ix_whatsapp_messages_telefone'), 'whatsapp_messages', ['telefone'], unique=False)
    op.create_table('estoque_movimentacoes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('motivo', sa.String(length=50), nullable=True),
    sa.Column('quantidade', sa.Float(), nullable=False),
    sa.Column('quantidade_anterior', sa.Float(), nullable=True),
    sa.Column('quantidade_nova', sa.Float(), nullable=True),
    sa.Column('custo_unitario', sa.Float(), nullable=True),
    sa.Column('valor_total', sa.Float(), nullable=True),
    sa.Column('lote_id', sa.Integer(), nullable=True),
    sa.Column('lotes_consumidos', sa.Text(), nullable=True),
    sa.Column('estoque_origem', sa.String(length=20), nullable=True),
    sa.Column('estoque_destino', sa.String(length=20), nullable=True),
    sa.Column('documento', sa.String(length=50), nullable=True),
    sa.Column('referencia_id', sa.Integer(), nullable=True),
    sa.Column('referencia_tipo', sa.String(length=20), nullable=True),
    sa.Column('observacao', sa.Text(), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['lote_id'], ['produto_lotes.id'], ),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('lancamentos_importados',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('usuario_id', sa.Integer(), nullable=False),
    sa.Column('data_transacao', sa.DateTime(), nullable=False),
    sa.Column('descricao_original', sa.Text(), nullable=True),
    sa.Column('valor', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=True),
    sa.Column('tipo_transacao', sa.String(length=50), nullable=True),
    sa.Column('cnpj_cpf_extraido', sa.String(length=20), nullable=True),
    sa.Column('beneficiario_extraido', sa.String(length=200), nullable=True),
    sa.Column('codigo_barras', sa.String(length=100), nullable=True),
    sa.Column('categoria_financeira_id', sa.Integer(), nullable=True),
    sa.Column('padrao_sugerido_id', sa.Integer(), nullable=True),
    sa.Column('confianca_ia', sa.Float(), nullable=True),
    sa.Column('categorias_alternativas', sa.JSON(), nullable=True),
    sa.Column('status_validacao', sa.String(length=20), nullable=True),
    sa.Column('confirmado_usuario', sa.Boolean(), nullable=True),
    sa.Column('categoria_usuario_id', sa.Integer(), nullable=True),
    sa.Column('data_validacao', sa.DateTime(), nullable=True),
    sa.Column('conta_pagar_id', sa.Integer(), nullable=True),
    sa.Column('conta_receber_id', sa.Integer(), nullable=True),
    sa.Column('linkagem_automatica', sa.Boolean(), nullable=True),
    sa.Column('confianca_linkagem', sa.Float(), nullable=True),
    sa.Column('lancamento_manual_id', sa.Integer(), nullable=True),
    sa.Column('processado', sa.Boolean(), nullable=True),
    sa.Column('data_processamento', sa.DateTime(), nullable=True),
    sa.Column('arquivo_origem', sa.String(length=500), nullable=True),
    sa.Column('linha_arquivo', sa.Integer(), nullable=True),
    sa.Column('hash_transacao', sa.String(length=64), nullable=True),
    sa.Column('criado_em', sa.DateTime(), nullable=True),
    sa.Column('atualizado_em', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['categoria_financeira_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['categoria_usuario_id'], ['categorias_financeiras.id'], ),
    sa.ForeignKeyConstraint(['conta_pagar_id'], ['contas_pagar.id'], ),
    sa.ForeignKeyConstraint(['conta_receber_id'], ['contas_receber.id'], ),
    sa.ForeignKeyConstraint(['lancamento_manual_id'], ['lancamentos_manuais.id'], ),
    sa.ForeignKeyConstraint(['padrao_sugerido_id'], ['padroes_categorizacao_ia.id'], ),
    sa.ForeignKeyConstraint(['usuario_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_lancamentos_importados_hash_transacao'), 'lancamentos_importados', ['hash_transacao'], unique=False)
    op.create_index(op.f('ix_lancamentos_importados_id'), 'lancamentos_importados', ['id'], unique=False)
    op.create_table('produtos_atributos_opcoes',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('atributo_id', sa.Integer(), nullable=False),
    sa.Column('valor', sa.String(length=100), nullable=False),
    sa.Column('ordem', sa.Integer(), nullable=True),
    sa.Column('ajuste_preco', sa.Float(), nullable=True),
    sa.Column('ajuste_preco_tipo', sa.String(length=20), nullable=True),
    sa.Column('codigo_extra', sa.String(length=50), nullable=True),
    sa.Column('ativo', sa.Boolean(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['atributo_id'], ['produtos_atributos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_opcoes_atributo', 'produtos_atributos_opcoes', ['atributo_id'], unique=False)
    op.create_table('recebimentos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('conta_receber_id', sa.Integer(), nullable=False),
    sa.Column('forma_pagamento_id', sa.Integer(), nullable=True),
    sa.Column('valor_recebido', sa.Numeric(precision=10, scale=2), nullable=False),
    sa.Column('data_recebimento', sa.Date(), nullable=False),
    sa.Column('observacoes', sa.Text(), nullable=True),
    sa.Column('comprovante', sa.String(length=255), nullable=True),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['conta_receber_id'], ['contas_receber.id'], ),
    sa.ForeignKeyConstraint(['forma_pagamento_id'], ['formas_pagamento.id'], ),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_recebimentos_conta_receber_id'), 'recebimentos', ['conta_receber_id'], unique=False)
    op.create_index(op.f('ix_recebimentos_data_recebimento'), 'recebimentos', ['data_recebimento'], unique=False)
    op.create_index(op.f('ix_recebimentos_id'), 'recebimentos', ['id'], unique=False)
    op.create_table('venda_itens',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('venda_id', sa.Integer(), nullable=False),
    sa.Column('tipo', sa.String(length=20), nullable=False),
    sa.Column('produto_id', sa.Integer(), nullable=True),
    sa.Column('servico_descricao', sa.String(length=255), nullable=True),
    sa.Column('quantidade', sa.DECIMAL(precision=10, scale=3), nullable=False),
    sa.Column('preco_unitario', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('desconto_item', sa.DECIMAL(precision=10, scale=2), nullable=True),
    sa.Column('subtotal', sa.DECIMAL(precision=10, scale=2), nullable=False),
    sa.Column('lote_id', sa.Integer(), nullable=True),
    sa.Column('pet_id', sa.Integer(), nullable=True),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['lote_id'], ['produto_lotes.id'], ),
    sa.ForeignKeyConstraint(['pet_id'], ['pets.id'], ),
    sa.ForeignKeyConstraint(['produto_id'], ['produtos.id'], ),
    sa.ForeignKeyConstraint(['venda_id'], ['vendas.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_venda_itens_id'), 'venda_itens', ['id'], unique=False)
    op.create_table('produtos_variacoes_atributos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('variacao_id', sa.Integer(), nullable=False),
    sa.Column('atributo_id', sa.Integer(), nullable=False),
    sa.Column('opcao_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['atributo_id'], ['produtos_atributos.id'], ),
    sa.ForeignKeyConstraint(['opcao_id'], ['produtos_atributos_opcoes.id'], ),
    sa.ForeignKeyConstraint(['variacao_id'], ['produtos.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index('idx_var_atributos_atributo', 'produtos_variacoes_atributos', ['atributo_id'], unique=False)
    op.create_index('idx_var_atributos_opcao', 'produtos_variacoes_atributos', ['opcao_id'], unique=False)
    op.create_index('idx_var_atributos_unique', 'produtos_variacoes_atributos', ['variacao_id', 'atributo_id'], unique=True)
    op.create_index('idx_var_atributos_variacao', 'produtos_variacoes_atributos', ['variacao_id'], unique=False)
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index('idx_var_atributos_variacao', table_name='produtos_variacoes_atributos')
    op.drop_index('idx_var_atributos_unique', table_name='produtos_variacoes_atributos')
    op.drop_index('idx_var_atributos_opcao', table_name='produtos_variacoes_atributos')
    op.drop_index('idx_var_atributos_atributo', table_name='produtos_variacoes_atributos')
    op.drop_table('produtos_variacoes_atributos')
    op.drop_index(op.f('ix_venda_itens_id'), table_name='venda_itens')
    op.drop_table('venda_itens')
    op.drop_index(op.f('ix_recebimentos_id'), table_name='recebimentos')
    op.drop_index(op.f('ix_recebimentos_data_recebimento'), table_name='recebimentos')
    op.drop_index(op.f('ix_recebimentos_conta_receber_id'), table_name='recebimentos')
    op.drop_table('recebimentos')
    op.drop_index('idx_opcoes_atributo', table_name='produtos_atributos_opcoes')
    op.drop_table('produtos_atributos_opcoes')
    op.drop_index(op.f('ix_lancamentos_importados_id'), table_name='lancamentos_importados')
    op.drop_index(op.f('ix_lancamentos_importados_hash_transacao'), table_name='lancamentos_importados')
    op.drop_table('lancamentos_importados')
    op.drop_table('estoque_movimentacoes')
    op.drop_index(op.f('ix_whatsapp_messages_telefone'), table_name='whatsapp_messages')
    op.drop_index(op.f('ix_whatsapp_messages_id'), table_name='whatsapp_messages')
    op.drop_index(op.f('ix_whatsapp_messages_created_at'), table_name='whatsapp_messages')
    op.drop_table('whatsapp_messages')
    op.drop_index(op.f('ix_venda_pagamentos_id'), table_name='venda_pagamentos')
    op.drop_table('venda_pagamentos')
    op.drop_index(op.f('ix_venda_baixas_id'), table_name='venda_baixas')
    op.drop_table('venda_baixas')
    op.drop_index(op.f('ix_produtos_historico_precos_produto_id'), table_name='produtos_historico_precos')
    op.drop_index(op.f('ix_produtos_historico_precos_nota_entrada_id'), table_name='produtos_historico_precos')
    op.drop_index(op.f('ix_produtos_historico_precos_id'), table_name='produtos_historico_precos')
    op.drop_index(op.f('ix_produtos_historico_precos_created_at'), table_name='produtos_historico_precos')
    op.drop_table('produtos_historico_precos')
    op.drop_index('idx_atributos_user', table_name='produtos_atributos')
    op.drop_index('idx_atributos_produto_pai', table_name='produtos_atributos')
    op.drop_table('produtos_atributos')
    op.drop_table('produto_lotes')
    op.drop_table('produto_listas_preco')
    op.drop_index('idx_kit_componentes_unique', table_name='produto_kit_componentes')
    op.drop_index('idx_kit_componentes_produto', table_name='produto_kit_componentes')
    op.drop_index('idx_kit_componentes_kit', table_name='produto_kit_componentes')
    op.drop_table('produto_kit_componentes')
    op.drop_table('produto_imagens')
    op.drop_table('produto_fornecedores')
    op.drop_table('produto_bling_sync')
    op.drop_index(op.f('ix_pedidos_compra_itens_produto_id'), table_name='pedidos_compra_itens')
    op.drop_index(op.f('ix_pedidos_compra_itens_pedido_compra_id'), table_name='pedidos_compra_itens')
    op.drop_index(op.f('ix_pedidos_compra_itens_id'), table_name='pedidos_compra_itens')
    op.drop_table('pedidos_compra_itens')
    op.drop_index(op.f('ix_pagamentos_id'), table_name='pagamentos')
    op.drop_index(op.f('ix_pagamentos_data_pagamento'), table_name='pagamentos')
    op.drop_index(op.f('ix_pagamentos_conta_pagar_id'), table_name='pagamentos')
    op.drop_table('pagamentos')
    op.drop_index(op.f('ix_notas_entrada_itens_produto_id'), table_name='notas_entrada_itens')
    op.drop_index(op.f('ix_notas_entrada_itens_nota_entrada_id'), table_name='notas_entrada_itens')
    op.drop_index(op.f('ix_notas_entrada_itens_id'), table_name='notas_entrada_itens')
    op.drop_table('notas_entrada_itens')
    op.drop_index(op.f('ix_movimentacoes_financeiras_user_id'), table_name='movimentacoes_financeiras')
    op.drop_index(op.f('ix_movimentacoes_financeiras_tipo'), table_name='movimentacoes_financeiras')
    op.drop_index(op.f('ix_movimentacoes_financeiras_status'), table_name='movimentacoes_financeiras')
    op.drop_index(op.f('ix_movimentacoes_financeiras_id'), table_name='movimentacoes_financeiras')
    op.drop_index(op.f('ix_movimentacoes_financeiras_data_movimento'), table_name='movimentacoes_financeiras')
    op.drop_index(op.f('ix_movimentacoes_financeiras_conta_bancaria_id'), table_name='movimentacoes_financeiras')
    op.drop_table('movimentacoes_financeiras')
    op.drop_index(op.f('ix_movimentacoes_caixa_id'), table_name='movimentacoes_caixa')
    op.drop_table('movimentacoes_caixa')
    op.drop_index(op.f('ix_lembretes_venda_id'), table_name='lembretes')
    op.drop_index(op.f('ix_lembretes_user_id'), table_name='lembretes')
    op.drop_index(op.f('ix_lembretes_produto_id'), table_name='lembretes')
    op.drop_index(op.f('ix_lembretes_pet_id'), table_name='lembretes')
    op.drop_index(op.f('ix_lembretes_data_proxima_dose'), table_name='lembretes')
    op.drop_index(op.f('ix_lembretes_cliente_id'), table_name='lembretes')
    op.drop_table('lembretes')
    op.drop_index(op.f('ix_lancamentos_manuais_tipo'), table_name='lancamentos_manuais')
    op.drop_index(op.f('ix_lancamentos_manuais_status'), table_name='lancamentos_manuais')
    op.drop_index(op.f('ix_lancamentos_manuais_id'), table_name='lancamentos_manuais')
    op.drop_index(op.f('ix_lancamentos_manuais_data_lancamento'), table_name='lancamentos_manuais')
    op.drop_table('lancamentos_manuais')
    op.drop_index(op.f('ix_formas_pagamento_taxas_id'), table_name='formas_pagamento_taxas')
    op.drop_table('formas_pagamento_taxas')
    op.drop_index(op.f('ix_email_envios_user_id'), table_name='email_envios')
    op.drop_index(op.f('ix_email_envios_status'), table_name='email_envios')
    op.drop_index(op.f('ix_email_envios_proxima_tentativa'), table_name='email_envios')
    op.drop_index(op.f('ix_email_envios_parceiro_id'), table_name='email_envios')
    op.drop_index(op.f('ix_email_envios_id'), table_name='email_envios')
    op.drop_index(op.f('ix_email_envios_data_envio'), table_name='email_envios')
    op.drop_table('email_envios')
    op.drop_index(op.f('ix_contas_receber_venda_id'), table_name='contas_receber')
    op.drop_index(op.f('ix_contas_receber_status'), table_name='contas_receber')
    op.drop_index(op.f('ix_contas_receber_id'), table_name='contas_receber')
    op.drop_index(op.f('ix_contas_receber_data_vencimento'), table_name='contas_receber')
    op.drop_table('contas_receber')
    op.drop_index(op.f('ix_vendas_numero_venda'), table_name='vendas')
    op.drop_index(op.f('ix_vendas_nfe_numero'), table_name='vendas')
    op.drop_index(op.f('ix_vendas_nfe_chave'), table_name='vendas')
    op.drop_index(op.f('ix_vendas_id'), table_name='vendas')
    op.drop_index(op.f('ix_vendas_canal'), table_name='vendas')
    op.drop_index(op.f('ix_vendas_caixa_id'), table_name='vendas')
    op.drop_table('vendas')
    op.drop_index('idx_produtos_user', table_name='produtos')
    op.drop_index('idx_produtos_marca', table_name='produtos')
    op.drop_index('idx_produtos_categoria', table_name='produtos')
    op.drop_table('produtos')
    op.drop_index(op.f('ix_pets_user_id'), table_name='pets')
    op.drop_index(op.f('ix_pets_nome'), table_name='pets')
    op.drop_index(op.f('ix_pets_id'), table_name='pets')
    op.drop_index(op.f('ix_pets_codigo'), table_name='pets')
    op.drop_index(op.f('ix_pets_cliente_id'), table_name='pets')
    op.drop_table('pets')
    op.drop_index(op.f('ix_padroes_categorizacao_ia_id'), table_name='padroes_categorizacao_ia')
    op.drop_table('padroes_categorizacao_ia')
    op.drop_index(op.f('ix_lancamentos_recorrentes_tipo'), table_name='lancamentos_recorrentes')
    op.drop_index(op.f('ix_lancamentos_recorrentes_id'), table_name='lancamentos_recorrentes')
    op.drop_index(op.f('ix_lancamentos_recorrentes_ativo'), table_name='lancamentos_recorrentes')
    op.drop_table('lancamentos_recorrentes')
    op.drop_index(op.f('ix_formas_pagamento_id'), table_name='formas_pagamento')
    op.drop_table('formas_pagamento')
    op.drop_index(op.f('ix_contas_pagar_status'), table_name='contas_pagar')
    op.drop_index(op.f('ix_contas_pagar_nota_entrada_id'), table_name='contas_pagar')
    op.drop_index(op.f('ix_contas_pagar_id'), table_name='contas_pagar')
    op.drop_index(op.f('ix_contas_pagar_data_vencimento'), table_name='contas_pagar')
    op.drop_table('contas_pagar')
    op.drop_index(op.f('ix_acertos_parceiro_user_id'), table_name='acertos_parceiro')
    op.drop_index(op.f('ix_acertos_parceiro_status'), table_name='acertos_parceiro')
    op.drop_index(op.f('ix_acertos_parceiro_parceiro_id'), table_name='acertos_parceiro')
    op.drop_index(op.f('ix_acertos_parceiro_id'), table_name='acertos_parceiro')
    op.drop_index(op.f('ix_acertos_parceiro_data_acerto'), table_name='acertos_parceiro')
    op.drop_table('acertos_parceiro')
    op.drop_index(op.f('ix_user_sessions_user_id'), table_name='user_sessions')
    op.drop_index(op.f('ix_user_sessions_token_jti'), table_name='user_sessions')
    op.drop_index(op.f('ix_user_sessions_id'), table_name='user_sessions')
    op.drop_table('user_sessions')
    op.drop_table('projecao_fluxo_caixa')
    op.drop_index(op.f('ix_pedidos_compra_user_id'), table_name='pedidos_compra')
    op.drop_index(op.f('ix_pedidos_compra_status'), table_name='pedidos_compra')
    op.drop_index(op.f('ix_pedidos_compra_numero_pedido'), table_name='pedidos_compra')
    op.drop_index(op.f('ix_pedidos_compra_id'), table_name='pedidos_compra')
    op.drop_index(op.f('ix_pedidos_compra_fornecedor_id'), table_name='pedidos_compra')
    op.drop_table('pedidos_compra')
    op.drop_index(op.f('ix_notas_entrada_user_id'), table_name='notas_entrada')
    op.drop_index(op.f('ix_notas_entrada_status'), table_name='notas_entrada')
    op.drop_index(op.f('ix_notas_entrada_numero_nota'), table_name='notas_entrada')
    op.drop_index(op.f('ix_notas_entrada_id'), table_name='notas_entrada')
    op.drop_index(op.f('ix_notas_entrada_fornecedor_id'), table_name='notas_entrada')
    op.drop_index(op.f('ix_notas_entrada_chave_acesso'), table_name='notas_entrada')
    op.drop_table('notas_entrada')
    op.drop_index(op.f('ix_mensagens_chat_id'), table_name='mensagens_chat')
    op.drop_index(op.f('ix_mensagens_chat_conversa_id'), table_name='mensagens_chat')
    op.drop_table('mensagens_chat')
    op.drop_table('marcas')
    op.drop_table('listas_preco')
    op.drop_table('indices_saude_caixa')
    op.drop_index(op.f('ix_historico_atualizacao_dre_id'), table_name='historico_atualizacao_dre')
    op.drop_table('historico_atualizacao_dre')
    op.drop_index('idx_fluxo_usuario_tipo', table_name='fluxo_caixa')
    op.drop_index('idx_fluxo_usuario_status', table_name='fluxo_caixa')
    op.drop_index('idx_fluxo_usuario_data', table_name='fluxo_caixa')
    op.drop_table('fluxo_caixa')
    op.drop_index(op.f('ix_emails_templates_user_id'), table_name='emails_templates')
    op.drop_index(op.f('ix_emails_templates_id'), table_name='emails_templates')
    op.drop_index(op.f('ix_emails_templates_codigo'), table_name='emails_templates')
    op.drop_table('emails_templates')
    op.drop_index(op.f('ix_dre_produtos_usuario_id'), table_name='dre_produtos')
    op.drop_index(op.f('ix_dre_produtos_produto_id'), table_name='dre_produtos')
    op.drop_index(op.f('ix_dre_produtos_id'), table_name='dre_produtos')
    op.drop_table('dre_produtos')
    op.drop_index(op.f('ix_dre_insights_usuario_id'), table_name='dre_insights')
    op.drop_index(op.f('ix_dre_insights_id'), table_name='dre_insights')
    op.drop_table('dre_insights')
    op.drop_index(op.f('ix_dre_comparacoes_usuario_id'), table_name='dre_comparacoes')
    op.drop_index(op.f('ix_dre_comparacoes_id'), table_name='dre_comparacoes')
    op.drop_table('dre_comparacoes')
    op.drop_index(op.f('ix_dre_categorias_usuario_id'), table_name='dre_categorias')
    op.drop_index(op.f('ix_dre_categorias_id'), table_name='dre_categorias')
    op.drop_table('dre_categorias')
    op.drop_table('departamentos')
    op.drop_index(op.f('ix_contas_bancarias_user_id'), table_name='contas_bancarias')
    op.drop_index(op.f('ix_contas_bancarias_tipo'), table_name='contas_bancarias')
    op.drop_index(op.f('ix_contas_bancarias_id'), table_name='contas_bancarias')
    op.drop_index(op.f('ix_contas_bancarias_ativa'), table_name='contas_bancarias')
    op.drop_table('contas_bancarias')
    op.drop_index(op.f('ix_configuracoes_entrega_id'), table_name='configuracoes_entrega')
    op.drop_table('configuracoes_entrega')
    op.drop_index(op.f('ix_configuracao_tributaria_id'), table_name='configuracao_tributaria')
    op.drop_table('configuracao_tributaria')
    op.drop_index(op.f('ix_clientes_user_id'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_tipo_pessoa'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_tipo_cadastro'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_nome'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_id'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_crmv'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_cpf'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_codigo'), table_name='clientes')
    op.drop_index(op.f('ix_clientes_cnpj'), table_name='clientes')
    op.drop_table('clientes')
    op.drop_index(op.f('ix_categorias_financeiras_id'), table_name='categorias_financeiras')
    op.drop_table('categorias_financeiras')
    op.drop_table('categorias')
    op.drop_index(op.f('ix_audit_logs_user_id'), table_name='audit_logs')
    op.drop_index(op.f('ix_audit_logs_timestamp'), table_name='audit_logs')
    op.drop_index(op.f('ix_audit_logs_id'), table_name='audit_logs')
    op.drop_index(op.f('ix_audit_logs_entity_type'), table_name='audit_logs')
    op.drop_index(op.f('ix_audit_logs_action'), table_name='audit_logs')
    op.drop_table('audit_logs')
    op.drop_index(op.f('ix_arquivos_extrato_importados_id'), table_name='arquivos_extrato_importados')
    op.drop_index(op.f('ix_arquivos_extrato_importados_hash_arquivo'), table_name='arquivos_extrato_importados')
    op.drop_table('arquivos_extrato_importados')
    op.drop_index(op.f('ix_users_reset_token'), table_name='users')
    op.drop_index(op.f('ix_users_id'), table_name='users')
    op.drop_index(op.f('ix_users_email'), table_name='users')
    op.drop_table('users')
    op.drop_index(op.f('ix_racas_nome'), table_name='racas')
    op.drop_index(op.f('ix_racas_id'), table_name='racas')
    op.drop_index(op.f('ix_racas_especie'), table_name='racas')
    op.drop_table('racas')
    op.drop_index(op.f('ix_indices_mercado_setor'), table_name='indices_mercado')
    op.drop_index(op.f('ix_indices_mercado_id'), table_name='indices_mercado')
    op.drop_table('indices_mercado')
    op.drop_index(op.f('ix_idempotency_keys_user_id'), table_name='idempotency_keys')
    op.drop_index(op.f('ix_idempotency_keys_id'), table_name='idempotency_keys')
    op.drop_index(op.f('ix_idempotency_keys_chave_idempotencia'), table_name='idempotency_keys')
    op.drop_index('idx_user_key', table_name='idempotency_keys')
    op.drop_index('idx_created_at', table_name='idempotency_keys')
    op.drop_table('idempotency_keys')
    op.drop_index(op.f('ix_dre_periodos_usuario_id'), table_name='dre_periodos')
    op.drop_index(op.f('ix_dre_periodos_id'), table_name='dre_periodos')
    op.drop_table('dre_periodos')
    op.drop_index(op.f('ix_conversas_ia_usuario_id'), table_name='conversas_ia')
    op.drop_index(op.f('ix_conversas_ia_id'), table_name='conversas_ia')
    op.drop_table('conversas_ia')
    op.drop_index(op.f('ix_contexto_financeiro_chat_usuario_id'), table_name='contexto_financeiro_chat')
    op.drop_index(op.f('ix_contexto_financeiro_chat_id'), table_name='contexto_financeiro_chat')
    op.drop_table('contexto_financeiro_chat')
    op.drop_index(op.f('ix_configuracao_impostos_id'), table_name='configuracao_impostos')
    op.drop_table('configuracao_impostos')
    op.drop_index(op.f('ix_caixas_id'), table_name='caixas')
    op.drop_table('caixas')
    # ### end Alembic commands ###
